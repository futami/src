<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pFKey</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/185.html#L11086'>pFKey</a>            11086 libdb/sqlite3.c   FKey *pFKey;         /* Linked list of all foreign keys in this table */</span>
<span class='curline'><a href='../S/185.html#L75700'>pFKey</a>            75700 libdb/sqlite3.c         FKey *pFKey;</span>
<span class='curline'><a href='../S/185.html#L75701'>pFKey</a>            75701 libdb/sqlite3.c         for(pFKey=pTab-&gt;pFKey; pFKey; pFKey=pFKey-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L75703'>pFKey</a>            75703 libdb/sqlite3.c           for(j=0; j&lt;pFKey-&gt;nCol; j++){</span>
<span class='curline'><a href='../S/185.html#L75704'>pFKey</a>            75704 libdb/sqlite3.c             if( pFKey-&gt;aCol[j].iFrom==iCol ){</span>
<span class='curline'><a href='../S/185.html#L85624'>pFKey</a>            85624 libdb/sqlite3.c   if( (db-&gt;flags&amp;SQLITE_ForeignKeys) &amp;&amp; pNew-&gt;pFKey &amp;&amp; pDflt ){</span>
<span class='curline'><a href='../S/185.html#L91056'>pFKey</a>            91056 libdb/sqlite3.c   FKey *pFKey = 0;</span>
<span class='curline'><a href='../S/185.html#L91084'>pFKey</a>            91084 libdb/sqlite3.c   nByte = sizeof(*pFKey) + (nCol-1)*sizeof(pFKey-&gt;aCol[0]) + pTo-&gt;n + 1;</span>
<span class='curline'><a href='../S/185.html#L91090'>pFKey</a>            91090 libdb/sqlite3.c   pFKey = sqlite3DbMallocZero(db, nByte );</span>
<span class='curline'><a href='../S/185.html#L91091'>pFKey</a>            91091 libdb/sqlite3.c   if( pFKey==0 ){</span>
<span class='curline'><a href='../S/185.html#L91094'>pFKey</a>            91094 libdb/sqlite3.c   pFKey-&gt;pFrom = p;</span>
<span class='curline'><a href='../S/185.html#L91095'>pFKey</a>            91095 libdb/sqlite3.c   pFKey-&gt;pNextFrom = p-&gt;pFKey;</span>
<span class='curline'><a href='../S/185.html#L91096'>pFKey</a>            91096 libdb/sqlite3.c   z = (char*)&amp;pFKey-&gt;aCol[nCol];</span>
<span class='curline'><a href='../S/185.html#L91097'>pFKey</a>            91097 libdb/sqlite3.c   pFKey-&gt;zTo = z;</span>
<span class='curline'><a href='../S/185.html#L91102'>pFKey</a>            91102 libdb/sqlite3.c   pFKey-&gt;nCol = nCol;</span>
<span class='curline'><a href='../S/185.html#L91104'>pFKey</a>            91104 libdb/sqlite3.c     pFKey-&gt;aCol[0].iFrom = p-&gt;nCol-1;</span>
<span class='curline'><a href='../S/185.html#L91110'>pFKey</a>            91110 libdb/sqlite3.c           pFKey-&gt;aCol[i].iFrom = j;</span>
<span class='curline'><a href='../S/185.html#L91125'>pFKey</a>            91125 libdb/sqlite3.c       pFKey-&gt;aCol[i].zCol = z;</span>
<span class='curline'><a href='../S/185.html#L91131'>pFKey</a>            91131 libdb/sqlite3.c   pFKey-&gt;isDeferred = 0;</span>
<span class='curline'><a href='../S/185.html#L91132'>pFKey</a>            91132 libdb/sqlite3.c   pFKey-&gt;aAction[0] = (u8)(flags &amp; 0xff);            /* ON DELETE action */</span>
<span class='curline'><a href='../S/185.html#L91133'>pFKey</a>            91133 libdb/sqlite3.c   pFKey-&gt;aAction[1] = (u8)((flags &gt;&gt; 8 ) &amp; 0xff);    /* ON UPDATE action */</span>
<span class='curline'><a href='../S/185.html#L91137'>pFKey</a>            91137 libdb/sqlite3.c       pFKey-&gt;zTo, (void *)pFKey</span>
<span class='curline'><a href='../S/185.html#L91139'>pFKey</a>            91139 libdb/sqlite3.c   if( pNextTo==pFKey ){</span>
<span class='curline'><a href='../S/185.html#L91145'>pFKey</a>            91145 libdb/sqlite3.c     pFKey-&gt;pNextTo = pNextTo;</span>
<span class='curline'><a href='../S/185.html#L91146'>pFKey</a>            91146 libdb/sqlite3.c     pNextTo-&gt;pPrevTo = pFKey;</span>
<span class='curline'><a href='../S/185.html#L91151'>pFKey</a>            91151 libdb/sqlite3.c   p-&gt;pFKey = pFKey;</span>
<span class='curline'><a href='../S/185.html#L91152'>pFKey</a>            91152 libdb/sqlite3.c   pFKey = 0;</span>
<span class='curline'><a href='../S/185.html#L91155'>pFKey</a>            91155 libdb/sqlite3.c   sqlite3DbFree(db, pFKey);</span>
<span class='curline'><a href='../S/185.html#L91171'>pFKey</a>            91171 libdb/sqlite3.c   FKey *pFKey;</span>
<span class='curline'><a href='../S/185.html#L91172'>pFKey</a>            91172 libdb/sqlite3.c   if( (pTab = pParse-&gt;pNewTable)==0 || (pFKey = pTab-&gt;pFKey)==0 ) return;</span>
<span class='curline'><a href='../S/185.html#L91174'>pFKey</a>            91174 libdb/sqlite3.c   pFKey-&gt;isDeferred = (u8)isDeferred;</span>
<span class='curline'><a href='../S/185.html#L96095'>pFKey</a>            96095 libdb/sqlite3.c   FKey *pFKey,                    /* Foreign key to find index for */</span>
<span class='curline'><a href='../S/185.html#L96101'>pFKey</a>            96101 libdb/sqlite3.c   int nCol = pFKey-&gt;nCol;             /* Number of columns in parent key */</span>
<span class='curline'><a href='../S/185.html#L96102'>pFKey</a>            96102 libdb/sqlite3.c   char *zKey = pFKey-&gt;aCol[0].zCol;   /* Name of left-most parent key column */</span>
<span class='curline'><a href='../S/185.html#L96149'>pFKey</a>            96149 libdb/sqlite3.c             for(i=0; i&lt;nCol; i++) aiCol[i] = pFKey-&gt;aCol[i].iFrom;</span>
<span class='curline'><a href='../S/185.html#L96175'>pFKey</a>            96175 libdb/sqlite3.c             if( sqlite3StrICmp(pFKey-&gt;aCol[j].zCol, zIdxCol)==0 ){</span>
<span class='curline'><a href='../S/185.html#L96176'>pFKey</a>            96176 libdb/sqlite3.c               if( aiCol ) aiCol[i] = pFKey-&gt;aCol[j].iFrom;</span>
<span class='curline'><a href='../S/185.html#L96191'>pFKey</a>            96191 libdb/sqlite3.c            pFKey-&gt;pFrom-&gt;zName, pFKey-&gt;zTo);</span>
<span class='curline'><a href='../S/185.html#L96232'>pFKey</a>            96232 libdb/sqlite3.c   FKey *pFKey,          /* Foreign key constraint */</span>
<span class='curline'><a href='../S/185.html#L96251'>pFKey</a>            96251 libdb/sqlite3.c     sqlite3VdbeAddOp2(v, OP_FkIfZero, pFKey-&gt;isDeferred, iOk);</span>
<span class='curline'><a href='../S/185.html#L96254'>pFKey</a>            96254 libdb/sqlite3.c   for(i=0; i&lt;pFKey-&gt;nCol; i++){</span>
<span class='curline'><a href='../S/185.html#L96279'>pFKey</a>            96279 libdb/sqlite3.c       if( pTab==pFKey-&gt;pFrom &amp;&amp; nIncr==1 ){</span>
<span class='curline'><a href='../S/185.html#L96291'>pFKey</a>            96291 libdb/sqlite3.c       int nCol = pFKey-&gt;nCol;</span>
<span class='curline'><a href='../S/185.html#L96311'>pFKey</a>            96311 libdb/sqlite3.c       if( pTab==pFKey-&gt;pFrom &amp;&amp; nIncr==1 ){</span>
<span class='curline'><a href='../S/185.html#L96336'>pFKey</a>            96336 libdb/sqlite3.c   if( !pFKey-&gt;isDeferred &amp;&amp; !(pParse-&gt;db-&gt;flags &amp; SQLITE_DeferFKs)</span>
<span class='curline'><a href='../S/185.html#L96348'>pFKey</a>            96348 libdb/sqlite3.c     if( nIncr&gt;0 &amp;&amp; pFKey-&gt;isDeferred==0 ){</span>
<span class='curline'><a href='../S/185.html#L96351'>pFKey</a>            96351 libdb/sqlite3.c     sqlite3VdbeAddOp2(v, OP_FkCounter, pFKey-&gt;isDeferred, nIncr);</span>
<span class='curline'><a href='../S/185.html#L96447'>pFKey</a>            96447 libdb/sqlite3.c   FKey *pFKey,                    /* The foreign key linking pSrc to pTab */</span>
<span class='curline'><a href='../S/185.html#L96461'>pFKey</a>            96461 libdb/sqlite3.c   assert( pIdx==0 || pIdx-&gt;nKeyCol==pFKey-&gt;nCol );</span>
<span class='curline'><a href='../S/185.html#L96462'>pFKey</a>            96462 libdb/sqlite3.c   assert( pIdx!=0 || pFKey-&gt;nCol==1 );</span>
<span class='curline'><a href='../S/185.html#L96466'>pFKey</a>            96466 libdb/sqlite3.c     iFkIfZero = sqlite3VdbeAddOp2(v, OP_FkIfZero, pFKey-&gt;isDeferred, 0);</span>
<span class='curline'><a href='../S/185.html#L96478'>pFKey</a>            96478 libdb/sqlite3.c   for(i=0; i&lt;pFKey-&gt;nCol; i++){</span>
<span class='curline'><a href='../S/185.html#L96487'>pFKey</a>            96487 libdb/sqlite3.c     iCol = aiCol ? aiCol[i] : pFKey-&gt;aCol[0].iFrom;</span>
<span class='curline'><a href='../S/185.html#L96489'>pFKey</a>            96489 libdb/sqlite3.c     zCol = pFKey-&gt;pFrom-&gt;aCol[iCol].zName;</span>
<span class='curline'><a href='../S/185.html#L96506'>pFKey</a>            96506 libdb/sqlite3.c   if( pTab==pFKey-&gt;pFrom &amp;&amp; nIncr&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L96541'>pFKey</a>            96541 libdb/sqlite3.c   if( nIncr&gt;0 &amp;&amp; pFKey-&gt;isDeferred==0 ){</span>
<span class='curline'><a href='../S/185.html#L96544'>pFKey</a>            96544 libdb/sqlite3.c   sqlite3VdbeAddOp2(v, OP_FkCounter, pFKey-&gt;isDeferred, nIncr);</span>
<span class='curline'><a href='../S/185.html#L96624'>pFKey</a>            96624 libdb/sqlite3.c       for(p=pTab-&gt;pFKey; p; p=p-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L96751'>pFKey</a>            96751 libdb/sqlite3.c   FKey *pFKey;                    /* Used to iterate through FKs */</span>
<span class='curline'><a href='../S/185.html#L96767'>pFKey</a>            96767 libdb/sqlite3.c   for(pFKey=pTab-&gt;pFKey; pFKey; pFKey=pFKey-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L96777'>pFKey</a>            96777 libdb/sqlite3.c      &amp;&amp; sqlite3_stricmp(pTab-&gt;zName, pFKey-&gt;zTo)!=0</span>
<span class='curline'><a href='../S/185.html#L96778'>pFKey</a>            96778 libdb/sqlite3.c      &amp;&amp; fkChildIsModified(pTab, pFKey, aChange, bChngRowid)==0 </span>
<span class='curline'><a href='../S/185.html#L96788'>pFKey</a>            96788 libdb/sqlite3.c       pTo = sqlite3FindTable(db, pFKey-&gt;zTo, zDb);</span>
<span class='curline'><a href='../S/185.html#L96790'>pFKey</a>            96790 libdb/sqlite3.c       pTo = sqlite3LocateTable(pParse, 0, pFKey-&gt;zTo, zDb);</span>
<span class='curline'><a href='../S/185.html#L96792'>pFKey</a>            96792 libdb/sqlite3.c     if( !pTo || sqlite3FkLocateIndex(pParse, pTo, pFKey, &amp;pIdx, &amp;aiFree) ){</span>
<span class='curline'><a href='../S/185.html#L96804'>pFKey</a>            96804 libdb/sqlite3.c         int iJump = sqlite3VdbeCurrentAddr(v) + pFKey-&gt;nCol + 1;</span>
<span class='curline'><a href='../S/185.html#L96805'>pFKey</a>            96805 libdb/sqlite3.c         for(i=0; i&lt;pFKey-&gt;nCol; i++){</span>
<span class='curline'><a href='../S/185.html#L96806'>pFKey</a>            96806 libdb/sqlite3.c           int iReg = pFKey-&gt;aCol[i].iFrom + regOld + 1;</span>
<span class='curline'><a href='../S/185.html#L96809'>pFKey</a>            96809 libdb/sqlite3.c         sqlite3VdbeAddOp2(v, OP_FkCounter, pFKey-&gt;isDeferred, -1);</span>
<span class='curline'><a href='../S/185.html#L96813'>pFKey</a>            96813 libdb/sqlite3.c     assert( pFKey-&gt;nCol==1 || (aiFree &amp;&amp; pIdx) );</span>
<span class='curline'><a href='../S/185.html#L96818'>pFKey</a>            96818 libdb/sqlite3.c       iCol = pFKey-&gt;aCol[0].iFrom;</span>
<span class='curline'><a href='../S/185.html#L96821'>pFKey</a>            96821 libdb/sqlite3.c     for(i=0; i&lt;pFKey-&gt;nCol; i++){</span>
<span class='curline'><a href='../S/185.html#L96848'>pFKey</a>            96848 libdb/sqlite3.c       fkLookupParent(pParse, iDb, pTo, pIdx, pFKey, aiCol, regOld, -1,isIgnore);</span>
<span class='curline'><a href='../S/185.html#L96853'>pFKey</a>            96853 libdb/sqlite3.c       fkLookupParent(pParse, iDb, pTo, pIdx, pFKey, aiCol, regNew, +1,isIgnore);</span>
<span class='curline'><a href='../S/185.html#L96861'>pFKey</a>            96861 libdb/sqlite3.c   for(pFKey = sqlite3FkReferences(pTab); pFKey; pFKey=pFKey-&gt;pNextTo){</span>
<span class='curline'><a href='../S/185.html#L96866'>pFKey</a>            96866 libdb/sqlite3.c     if( aChange &amp;&amp; fkParentIsModified(pTab, pFKey, aChange, bChngRowid)==0 ){</span>
<span class='curline'><a href='../S/185.html#L96870'>pFKey</a>            96870 libdb/sqlite3.c     if( !pFKey-&gt;isDeferred &amp;&amp; !(db-&gt;flags &amp; SQLITE_DeferFKs) </span>
<span class='curline'><a href='../S/185.html#L96879'>pFKey</a>            96879 libdb/sqlite3.c     if( sqlite3FkLocateIndex(pParse, pTab, pFKey, &amp;pIdx, &amp;aiCol) ){</span>
<span class='curline'><a href='../S/185.html#L96883'>pFKey</a>            96883 libdb/sqlite3.c     assert( aiCol || pFKey-&gt;nCol==1 );</span>
<span class='curline'><a href='../S/185.html#L96890'>pFKey</a>            96890 libdb/sqlite3.c       pItem-&gt;pTab = pFKey-&gt;pFrom;</span>
<span class='curline'><a href='../S/185.html#L96891'>pFKey</a>            96891 libdb/sqlite3.c       pItem-&gt;zName = pFKey-&gt;pFrom-&gt;zName;</span>
<span class='curline'><a href='../S/185.html#L96896'>pFKey</a>            96896 libdb/sqlite3.c         fkScanChildren(pParse, pSrc, pTab, pIdx, pFKey, aiCol, regNew, -1);</span>
<span class='curline'><a href='../S/185.html#L96905'>pFKey</a>            96905 libdb/sqlite3.c         fkScanChildren(pParse, pSrc, pTab, pIdx, pFKey, aiCol, regOld, 1);</span>
<span class='curline'><a href='../S/185.html#L96928'>pFKey</a>            96928 libdb/sqlite3.c     for(p=pTab-&gt;pFKey; p; p=p-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L96968'>pFKey</a>            96968 libdb/sqlite3.c       return (sqlite3FkReferences(pTab) || pTab-&gt;pFKey);</span>
<span class='curline'><a href='../S/185.html#L96975'>pFKey</a>            96975 libdb/sqlite3.c       for(p=pTab-&gt;pFKey; p; p=p-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L97020'>pFKey</a>            97020 libdb/sqlite3.c   FKey *pFKey,                    /* Foreign key to get action for */</span>
<span class='curline'><a href='../S/185.html#L97028'>pFKey</a>            97028 libdb/sqlite3.c   action = pFKey-&gt;aAction[iAction];</span>
<span class='curline'><a href='../S/185.html#L97029'>pFKey</a>            97029 libdb/sqlite3.c   pTrigger = pFKey-&gt;apTrigger[iAction];</span>
<span class='curline'><a href='../S/185.html#L97044'>pFKey</a>            97044 libdb/sqlite3.c     if( sqlite3FkLocateIndex(pParse, pTab, pFKey, &amp;pIdx, &amp;aiCol) ) return 0;</span>
<span class='curline'><a href='../S/185.html#L97045'>pFKey</a>            97045 libdb/sqlite3.c     assert( aiCol || pFKey-&gt;nCol==1 );</span>
<span class='curline'><a href='../S/185.html#L97047'>pFKey</a>            97047 libdb/sqlite3.c     for(i=0; i&lt;pFKey-&gt;nCol; i++){</span>
<span class='curline'><a href='../S/185.html#L97055'>pFKey</a>            97055 libdb/sqlite3.c       iFromCol = aiCol ? aiCol[i] : pFKey-&gt;aCol[0].iFrom;</span>
<span class='curline'><a href='../S/185.html#L97058'>pFKey</a>            97058 libdb/sqlite3.c       tFromCol.z = pFKey-&gt;pFrom-&gt;aCol[iFromCol].zName;</span>
<span class='curline'><a href='../S/185.html#L97103'>pFKey</a>            97103 libdb/sqlite3.c           Expr *pDflt = pFKey-&gt;pFrom-&gt;aCol[iFromCol].pDflt;</span>
<span class='curline'><a href='../S/185.html#L97118'>pFKey</a>            97118 libdb/sqlite3.c     zFrom = pFKey-&gt;pFrom-&gt;zName;</span>
<span class='curline'><a href='../S/185.html#L97192'>pFKey</a>            97192 libdb/sqlite3.c     pFKey-&gt;apTrigger[iAction] = pTrigger;</span>
<span class='curline'><a href='../S/185.html#L97216'>pFKey</a>            97216 libdb/sqlite3.c     FKey *pFKey;                  /* Iterator variable */</span>
<span class='curline'><a href='../S/185.html#L97217'>pFKey</a>            97217 libdb/sqlite3.c     for(pFKey = sqlite3FkReferences(pTab); pFKey; pFKey=pFKey-&gt;pNextTo){</span>
<span class='curline'><a href='../S/185.html#L97218'>pFKey</a>            97218 libdb/sqlite3.c       if( aChange==0 || fkParentIsModified(pTab, pFKey, aChange, bChngRowid) ){</span>
<span class='curline'><a href='../S/185.html#L97219'>pFKey</a>            97219 libdb/sqlite3.c         Trigger *pAct = fkActionTrigger(pParse, pTab, pFKey, pChanges);</span>
<span class='curline'><a href='../S/185.html#L97236'>pFKey</a>            97236 libdb/sqlite3.c   FKey *pFKey;                    /* Iterator variable */</span>
<span class='curline'><a href='../S/185.html#L97240'>pFKey</a>            97240 libdb/sqlite3.c   for(pFKey=pTab-&gt;pFKey; pFKey; pFKey=pNext){</span>
<span class='curline'><a href='../S/185.html#L97244'>pFKey</a>            97244 libdb/sqlite3.c       if( pFKey-&gt;pPrevTo ){</span>
<span class='curline'><a href='../S/185.html#L97245'>pFKey</a>            97245 libdb/sqlite3.c         pFKey-&gt;pPrevTo-&gt;pNextTo = pFKey-&gt;pNextTo;</span>
<span class='curline'><a href='../S/185.html#L97247'>pFKey</a>            97247 libdb/sqlite3.c         void *p = (void *)pFKey-&gt;pNextTo;</span>
<span class='curline'><a href='../S/185.html#L97248'>pFKey</a>            97248 libdb/sqlite3.c         const char *z = (p ? pFKey-&gt;pNextTo-&gt;zTo : pFKey-&gt;zTo);</span>
<span class='curline'><a href='../S/185.html#L97251'>pFKey</a>            97251 libdb/sqlite3.c       if( pFKey-&gt;pNextTo ){</span>
<span class='curline'><a href='../S/185.html#L97252'>pFKey</a>            97252 libdb/sqlite3.c         pFKey-&gt;pNextTo-&gt;pPrevTo = pFKey-&gt;pPrevTo;</span>
<span class='curline'><a href='../S/185.html#L97259'>pFKey</a>            97259 libdb/sqlite3.c     assert( pFKey-&gt;isDeferred==0 || pFKey-&gt;isDeferred==1 );</span>
<span class='curline'><a href='../S/185.html#L97263'>pFKey</a>            97263 libdb/sqlite3.c     fkTriggerDelete(db, pFKey-&gt;apTrigger[0]);</span>
<span class='curline'><a href='../S/185.html#L97264'>pFKey</a>            97264 libdb/sqlite3.c     fkTriggerDelete(db, pFKey-&gt;apTrigger[1]);</span>
<span class='curline'><a href='../S/185.html#L97267'>pFKey</a>            97267 libdb/sqlite3.c     pNext = pFKey-&gt;pNextFrom;</span>
<span class='curline'><a href='../S/185.html#L97268'>pFKey</a>            97268 libdb/sqlite3.c     sqlite3DbFree(db, pFKey);</span>
<span class='curline'><a href='../S/185.html#L99188'>pFKey</a>            99188 libdb/sqlite3.c   if( (pParse-&gt;db-&gt;flags &amp; SQLITE_ForeignKeys)!=0 &amp;&amp; pDest-&gt;pFKey!=0 ){</span>
<span class='curline'><a href='../S/185.html#L102343'>pFKey</a>            102343 libdb/sqlite3.c       pFK = pTab-&gt;pFKey;</span>
<span class='curline'><a href='../S/185.html#L102421'>pFKey</a>            102421 libdb/sqlite3.c       if( pTab==0 || pTab-&gt;pFKey==0 ) continue;</span>
<span class='curline'><a href='../S/185.html#L102427'>pFKey</a>            102427 libdb/sqlite3.c       for(i=1, pFK=pTab-&gt;pFKey; pFK; i++, pFK=pFK-&gt;pNextFrom){</span>
<span class='curline'><a href='../S/185.html#L102449'>pFKey</a>            102449 libdb/sqlite3.c       for(i=1, pFK=pTab-&gt;pFKey; pFK; i++, pFK=pFK-&gt;pNextFrom){</span>
</pre>
</body>
</html>
