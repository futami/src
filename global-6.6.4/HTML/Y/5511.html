<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pPager</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/185.html#L9791'>pPager</a>           9791 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerClose(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9810'>pPager</a>           9810 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerAcquire(Pager *pPager, Pgno pgno, DbPage **ppPage, int clrFlag);</span>
<span class='curline'><a href='../S/185.html#L9812'>pPager</a>           9812 libdb/sqlite3.c SQLITE_PRIVATE DbPage *sqlite3PagerLookup(Pager *pPager, Pgno pgno);</span>
<span class='curline'><a href='../S/185.html#L9830'>pPager</a>           9830 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSync(Pager *pPager, const char *zMaster);</span>
<span class='curline'><a href='../S/185.html#L9833'>pPager</a>           9833 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerOpenSavepoint(Pager *pPager, int n);</span>
<span class='curline'><a href='../S/185.html#L9834'>pPager</a>           9834 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSavepoint(Pager *pPager, int op, int iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L9835'>pPager</a>           9835 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSharedLock(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9838'>pPager</a>           9838 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerCheckpoint(Pager *pPager, int, int*, int*);</span>
<span class='curline'><a href='../S/185.html#L9839'>pPager</a>           9839 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerWalSupported(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9840'>pPager</a>           9840 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerWalCallback(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9841'>pPager</a>           9841 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerOpenWal(Pager *pPager, int *pisOpen);</span>
<span class='curline'><a href='../S/185.html#L9842'>pPager</a>           9842 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerCloseWal(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9846'>pPager</a>           9846 libdb/sqlite3.c SQLITE_PRIVATE   int sqlite3PagerWalFramesize(Pager *pPager);</span>
<span class='curline'><a href='../S/185.html#L9921'>pPager</a>           9921 libdb/sqlite3.c   Pager *pPager;                 /* The pager this page is part of */</span>
<span class='curline'><a href='../S/185.html#L14640'>pPager</a>           14640 libdb/sqlite3.c           Pager *pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L14641'>pPager</a>           14641 libdb/sqlite3.c           totalUsed += sqlite3PagerMemUsed(pPager);</span>
<span class='curline'><a href='../S/185.html#L14730'>pPager</a>           14730 libdb/sqlite3.c           Pager *pPager = sqlite3BtreePager(db-&gt;aDb[i].pBt);</span>
<span class='curline'><a href='../S/185.html#L14731'>pPager</a>           14731 libdb/sqlite3.c           sqlite3PagerCacheStat(pPager, op, resetFlag, &amp;nRet);</span>
<span class='curline'><a href='../S/185.html#L41623'>pPager</a>           41623 libdb/sqlite3.c #define JOURNAL_PG_SZ(pPager)  ((pPager-&gt;pageSize) + 8)</span>
<span class='curline'><a href='../S/185.html#L41629'>pPager</a>           41629 libdb/sqlite3.c #define JOURNAL_HDR_SZ(pPager) (pPager-&gt;sectorSize)</span>
<span class='curline'><a href='../S/185.html#L41640'>pPager</a>           41640 libdb/sqlite3.c # define MEMDB pPager-&gt;memDb</span>
<span class='curline'><a href='../S/185.html#L41677'>pPager</a>           41677 libdb/sqlite3.c static int pagerUseWal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L41678'>pPager</a>           41678 libdb/sqlite3.c   return (pPager-&gt;pWal!=0);</span>
<span class='curline'><a href='../S/185.html#L41698'>pPager</a>           41698 libdb/sqlite3.c   Pager *pPager = p;</span>
<span class='curline'><a href='../S/185.html#L41715'>pPager</a>           41715 libdb/sqlite3.c   assert( p-&gt;tempFile==0 || pPager-&gt;changeCountDone );</span>
<span class='curline'><a href='../S/185.html#L41743'>pPager</a>           41743 libdb/sqlite3.c   assert( pPager-&gt;changeCountDone==0 || pPager-&gt;eLock&gt;=RESERVED_LOCK );</span>
<span class='curline'><a href='../S/185.html#L41749'>pPager</a>           41749 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41750'>pPager</a>           41750 libdb/sqlite3.c       assert( sqlite3PcacheRefCount(pPager-&gt;pPCache)==0 || pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L41754'>pPager</a>           41754 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41761'>pPager</a>           41761 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41762'>pPager</a>           41762 libdb/sqlite3.c       if( !pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L41765'>pPager</a>           41765 libdb/sqlite3.c       assert( pPager-&gt;dbSize==pPager-&gt;dbOrigSize );</span>
<span class='curline'><a href='../S/185.html#L41766'>pPager</a>           41766 libdb/sqlite3.c       assert( pPager-&gt;dbOrigSize==pPager-&gt;dbFileSize );</span>
<span class='curline'><a href='../S/185.html#L41767'>pPager</a>           41767 libdb/sqlite3.c       assert( pPager-&gt;dbOrigSize==pPager-&gt;dbHintSize );</span>
<span class='curline'><a href='../S/185.html#L41768'>pPager</a>           41768 libdb/sqlite3.c       assert( pPager-&gt;setMaster==0 );</span>
<span class='curline'><a href='../S/185.html#L41773'>pPager</a>           41773 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41774'>pPager</a>           41774 libdb/sqlite3.c       if( !pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L41786'>pPager</a>           41786 libdb/sqlite3.c       assert( pPager-&gt;dbOrigSize==pPager-&gt;dbFileSize );</span>
<span class='curline'><a href='../S/185.html#L41787'>pPager</a>           41787 libdb/sqlite3.c       assert( pPager-&gt;dbOrigSize==pPager-&gt;dbHintSize );</span>
<span class='curline'><a href='../S/185.html#L41792'>pPager</a>           41792 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41793'>pPager</a>           41793 libdb/sqlite3.c       assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L41799'>pPager</a>           41799 libdb/sqlite3.c       assert( pPager-&gt;dbOrigSize&lt;=pPager-&gt;dbHintSize );</span>
<span class='curline'><a href='../S/185.html#L41804'>pPager</a>           41804 libdb/sqlite3.c       assert( pPager-&gt;errCode==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41805'>pPager</a>           41805 libdb/sqlite3.c       assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L41817'>pPager</a>           41817 libdb/sqlite3.c       assert( pPager-&gt;errCode!=SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L41818'>pPager</a>           41818 libdb/sqlite3.c       assert( sqlite3PcacheRefCount(pPager-&gt;pPCache)&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L41887'>pPager</a>           41887 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L41891'>pPager</a>           41891 libdb/sqlite3.c   for(i=0; i&lt;pPager-&gt;nSavepoint; i++){</span>
<span class='curline'><a href='../S/185.html#L41892'>pPager</a>           41892 libdb/sqlite3.c     p = &amp;pPager-&gt;aSavepoint[i];</span>
<span class='curline'><a href='../S/185.html#L41903'>pPager</a>           41903 libdb/sqlite3.c static int pageInJournal(Pager *pPager, PgHdr *pPg){</span>
<span class='curline'><a href='../S/185.html#L41904'>pPager</a>           41904 libdb/sqlite3.c   return sqlite3BitvecTest(pPager-&gt;pInJournal, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L41948'>pPager</a>           41948 libdb/sqlite3.c static int pagerUnlockDb(Pager *pPager, int eLock){</span>
<span class='curline'><a href='../S/185.html#L41951'>pPager</a>           41951 libdb/sqlite3.c   assert( !pPager-&gt;exclusiveMode || pPager-&gt;eLock==eLock );</span>
<span class='curline'><a href='../S/185.html#L41953'>pPager</a>           41953 libdb/sqlite3.c   assert( eLock!=NO_LOCK || pagerUseWal(pPager)==0 );</span>
<span class='curline'><a href='../S/185.html#L41954'>pPager</a>           41954 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L41955'>pPager</a>           41955 libdb/sqlite3.c     assert( pPager-&gt;eLock&gt;=eLock );</span>
<span class='curline'><a href='../S/185.html#L41956'>pPager</a>           41956 libdb/sqlite3.c     rc = pPager-&gt;noLock ? SQLITE_OK : sqlite3OsUnlock(pPager-&gt;fd, eLock);</span>
<span class='curline'><a href='../S/185.html#L41957'>pPager</a>           41957 libdb/sqlite3.c     if( pPager-&gt;eLock!=UNKNOWN_LOCK ){</span>
<span class='curline'><a href='../S/185.html#L41958'>pPager</a>           41958 libdb/sqlite3.c       pPager-&gt;eLock = (u8)eLock;</span>
<span class='curline'><a href='../S/185.html#L41960'>pPager</a>           41960 libdb/sqlite3.c     IOTRACE(("UNLOCK %p %d\n", pPager, eLock))</span>
<span class='curline'><a href='../S/185.html#L41975'>pPager</a>           41975 libdb/sqlite3.c static int pagerLockDb(Pager *pPager, int eLock){</span>
<span class='curline'><a href='../S/185.html#L41979'>pPager</a>           41979 libdb/sqlite3.c   if( pPager-&gt;eLock&lt;eLock || pPager-&gt;eLock==UNKNOWN_LOCK ){</span>
<span class='curline'><a href='../S/185.html#L41980'>pPager</a>           41980 libdb/sqlite3.c     rc = pPager-&gt;noLock ? SQLITE_OK : sqlite3OsLock(pPager-&gt;fd, eLock);</span>
<span class='curline'><a href='../S/185.html#L41981'>pPager</a>           41981 libdb/sqlite3.c     if( rc==SQLITE_OK &amp;&amp; (pPager-&gt;eLock!=UNKNOWN_LOCK||eLock==EXCLUSIVE_LOCK) ){</span>
<span class='curline'><a href='../S/185.html#L41982'>pPager</a>           41982 libdb/sqlite3.c       pPager-&gt;eLock = (u8)eLock;</span>
<span class='curline'><a href='../S/185.html#L41983'>pPager</a>           41983 libdb/sqlite3.c       IOTRACE(("LOCK %p %d\n", pPager, eLock))</span>
<span class='curline'><a href='../S/185.html#L42007'>pPager</a>           42007 libdb/sqlite3.c static int jrnlBufferSize(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42009'>pPager</a>           42009 libdb/sqlite3.c   if( !pPager-&gt;tempFile ){</span>
<span class='curline'><a href='../S/185.html#L42014'>pPager</a>           42014 libdb/sqlite3.c     assert( isOpen(pPager-&gt;fd) );</span>
<span class='curline'><a href='../S/185.html#L42015'>pPager</a>           42015 libdb/sqlite3.c     dc = sqlite3OsDeviceCharacteristics(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L42016'>pPager</a>           42016 libdb/sqlite3.c     nSector = pPager-&gt;sectorSize;</span>
<span class='curline'><a href='../S/185.html#L42017'>pPager</a>           42017 libdb/sqlite3.c     szPage = pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L42026'>pPager</a>           42026 libdb/sqlite3.c   return JOURNAL_HDR_SZ(pPager) + JOURNAL_PG_SZ(pPager);</span>
<span class='curline'><a href='../S/185.html#L42048'>pPager</a>           42048 libdb/sqlite3.c   return pager_datahash(pPage-&gt;pPager-&gt;pageSize, (unsigned char *)pPage-&gt;pData);</span>
<span class='curline'><a href='../S/185.html#L42061'>pPager</a>           42061 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L42062'>pPager</a>           42062 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L42152'>pPager</a>           42152 libdb/sqlite3.c static i64 journalHdrOffset(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42154'>pPager</a>           42154 libdb/sqlite3.c   i64 c = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L42156'>pPager</a>           42156 libdb/sqlite3.c     offset = ((c-1)/JOURNAL_HDR_SZ(pPager) + 1) * JOURNAL_HDR_SZ(pPager);</span>
<span class='curline'><a href='../S/185.html#L42158'>pPager</a>           42158 libdb/sqlite3.c   assert( offset%JOURNAL_HDR_SZ(pPager)==0 );</span>
<span class='curline'><a href='../S/185.html#L42160'>pPager</a>           42160 libdb/sqlite3.c   assert( (offset-c)&lt;JOURNAL_HDR_SZ(pPager) );</span>
<span class='curline'><a href='../S/185.html#L42185'>pPager</a>           42185 libdb/sqlite3.c static int zeroJournalHdr(Pager *pPager, int doTruncate){</span>
<span class='curline'><a href='../S/185.html#L42187'>pPager</a>           42187 libdb/sqlite3.c   assert( isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L42188'>pPager</a>           42188 libdb/sqlite3.c   if( pPager-&gt;journalOff ){</span>
<span class='curline'><a href='../S/185.html#L42189'>pPager</a>           42189 libdb/sqlite3.c     const i64 iLimit = pPager-&gt;journalSizeLimit;    /* Local cache of jsl */</span>
<span class='curline'><a href='../S/185.html#L42191'>pPager</a>           42191 libdb/sqlite3.c     IOTRACE(("JZEROHDR %p\n", pPager))</span>
<span class='curline'><a href='../S/185.html#L42193'>pPager</a>           42193 libdb/sqlite3.c       rc = sqlite3OsTruncate(pPager-&gt;jfd, 0);</span>
<span class='curline'><a href='../S/185.html#L42196'>pPager</a>           42196 libdb/sqlite3.c       rc = sqlite3OsWrite(pPager-&gt;jfd, zeroHdr, sizeof(zeroHdr), 0);</span>
<span class='curline'><a href='../S/185.html#L42198'>pPager</a>           42198 libdb/sqlite3.c     if( rc==SQLITE_OK &amp;&amp; !pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L42199'>pPager</a>           42199 libdb/sqlite3.c       rc = sqlite3OsSync(pPager-&gt;jfd, SQLITE_SYNC_DATAONLY|pPager-&gt;syncFlags);</span>
<span class='curline'><a href='../S/185.html#L42210'>pPager</a>           42210 libdb/sqlite3.c       rc = sqlite3OsFileSize(pPager-&gt;jfd, &amp;sz);</span>
<span class='curline'><a href='../S/185.html#L42212'>pPager</a>           42212 libdb/sqlite3.c         rc = sqlite3OsTruncate(pPager-&gt;jfd, iLimit);</span>
<span class='curline'><a href='../S/185.html#L42234'>pPager</a>           42234 libdb/sqlite3.c static int writeJournalHdr(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42236'>pPager</a>           42236 libdb/sqlite3.c   char *zHeader = pPager-&gt;pTmpSpace;  /* Temporary space used to build header */</span>
<span class='curline'><a href='../S/185.html#L42237'>pPager</a>           42237 libdb/sqlite3.c   u32 nHeader = (u32)pPager-&gt;pageSize;/* Size of buffer pointed to by zHeader */</span>
<span class='curline'><a href='../S/185.html#L42241'>pPager</a>           42241 libdb/sqlite3.c   assert( isOpen(pPager-&gt;jfd) );      /* Journal file must be open. */</span>
<span class='curline'><a href='../S/185.html#L42243'>pPager</a>           42243 libdb/sqlite3.c   if( nHeader&gt;JOURNAL_HDR_SZ(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L42244'>pPager</a>           42244 libdb/sqlite3.c     nHeader = JOURNAL_HDR_SZ(pPager);</span>
<span class='curline'><a href='../S/185.html#L42251'>pPager</a>           42251 libdb/sqlite3.c   for(ii=0; ii&lt;pPager-&gt;nSavepoint; ii++){</span>
<span class='curline'><a href='../S/185.html#L42252'>pPager</a>           42252 libdb/sqlite3.c     if( pPager-&gt;aSavepoint[ii].iHdrOffset==0 ){</span>
<span class='curline'><a href='../S/185.html#L42253'>pPager</a>           42253 libdb/sqlite3.c       pPager-&gt;aSavepoint[ii].iHdrOffset = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L42257'>pPager</a>           42257 libdb/sqlite3.c   pPager-&gt;journalHdr = pPager-&gt;journalOff = journalHdrOffset(pPager);</span>
<span class='curline'><a href='../S/185.html#L42279'>pPager</a>           42279 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) || pPager-&gt;noSync );</span>
<span class='curline'><a href='../S/185.html#L42280'>pPager</a>           42280 libdb/sqlite3.c   if( pPager-&gt;noSync || (pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY)</span>
<span class='curline'><a href='../S/185.html#L42281'>pPager</a>           42281 libdb/sqlite3.c    || (sqlite3OsDeviceCharacteristics(pPager-&gt;fd)&amp;SQLITE_IOCAP_SAFE_APPEND) </span>
<span class='curline'><a href='../S/185.html#L42290'>pPager</a>           42290 libdb/sqlite3.c   sqlite3_randomness(sizeof(pPager-&gt;cksumInit), &amp;pPager-&gt;cksumInit);</span>
<span class='curline'><a href='../S/185.html#L42291'>pPager</a>           42291 libdb/sqlite3.c   put32bits(&amp;zHeader[sizeof(aJournalMagic)+4], pPager-&gt;cksumInit);</span>
<span class='curline'><a href='../S/185.html#L42293'>pPager</a>           42293 libdb/sqlite3.c   put32bits(&amp;zHeader[sizeof(aJournalMagic)+8], pPager-&gt;dbOrigSize);</span>
<span class='curline'><a href='../S/185.html#L42295'>pPager</a>           42295 libdb/sqlite3.c   put32bits(&amp;zHeader[sizeof(aJournalMagic)+12], pPager-&gt;sectorSize);</span>
<span class='curline'><a href='../S/185.html#L42298'>pPager</a>           42298 libdb/sqlite3.c   put32bits(&amp;zHeader[sizeof(aJournalMagic)+16], pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L42325'>pPager</a>           42325 libdb/sqlite3.c   for(nWrite=0; rc==SQLITE_OK&amp;&amp;nWrite&lt;JOURNAL_HDR_SZ(pPager); nWrite+=nHeader){</span>
<span class='curline'><a href='../S/185.html#L42326'>pPager</a>           42326 libdb/sqlite3.c     IOTRACE(("JHDR %p %lld %d\n", pPager, pPager-&gt;journalHdr, nHeader))</span>
<span class='curline'><a href='../S/185.html#L42327'>pPager</a>           42327 libdb/sqlite3.c     rc = sqlite3OsWrite(pPager-&gt;jfd, zHeader, nHeader, pPager-&gt;journalOff);</span>
<span class='curline'><a href='../S/185.html#L42328'>pPager</a>           42328 libdb/sqlite3.c     assert( pPager-&gt;journalHdr &lt;= pPager-&gt;journalOff );</span>
<span class='curline'><a href='../S/185.html#L42329'>pPager</a>           42329 libdb/sqlite3.c     pPager-&gt;journalOff += nHeader;</span>
<span class='curline'><a href='../S/185.html#L42353'>pPager</a>           42353 libdb/sqlite3.c   Pager *pPager,               /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L42363'>pPager</a>           42363 libdb/sqlite3.c   assert( isOpen(pPager-&gt;jfd) );      /* Journal file must be open. */</span>
<span class='curline'><a href='../S/185.html#L42369'>pPager</a>           42369 libdb/sqlite3.c   pPager-&gt;journalOff = journalHdrOffset(pPager);</span>
<span class='curline'><a href='../S/185.html#L42370'>pPager</a>           42370 libdb/sqlite3.c   if( pPager-&gt;journalOff+JOURNAL_HDR_SZ(pPager) &gt; journalSize ){</span>
<span class='curline'><a href='../S/185.html#L42373'>pPager</a>           42373 libdb/sqlite3.c   iHdrOff = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L42380'>pPager</a>           42380 libdb/sqlite3.c   if( isHot || iHdrOff!=pPager-&gt;journalHdr ){</span>
<span class='curline'><a href='../S/185.html#L42381'>pPager</a>           42381 libdb/sqlite3.c     rc = sqlite3OsRead(pPager-&gt;jfd, aMagic, sizeof(aMagic), iHdrOff);</span>
<span class='curline'><a href='../S/185.html#L42394'>pPager</a>           42394 libdb/sqlite3.c   if( SQLITE_OK!=(rc = read32bits(pPager-&gt;jfd, iHdrOff+8, pNRec))</span>
<span class='curline'><a href='../S/185.html#L42395'>pPager</a>           42395 libdb/sqlite3.c    || SQLITE_OK!=(rc = read32bits(pPager-&gt;jfd, iHdrOff+12, &amp;pPager-&gt;cksumInit))</span>
<span class='curline'><a href='../S/185.html#L42396'>pPager</a>           42396 libdb/sqlite3.c    || SQLITE_OK!=(rc = read32bits(pPager-&gt;jfd, iHdrOff+16, pDbSize))</span>
<span class='curline'><a href='../S/185.html#L42401'>pPager</a>           42401 libdb/sqlite3.c   if( pPager-&gt;journalOff==0 ){</span>
<span class='curline'><a href='../S/185.html#L42406'>pPager</a>           42406 libdb/sqlite3.c     if( SQLITE_OK!=(rc = read32bits(pPager-&gt;jfd, iHdrOff+20, &amp;iSectorSize))</span>
<span class='curline'><a href='../S/185.html#L42407'>pPager</a>           42407 libdb/sqlite3.c      || SQLITE_OK!=(rc = read32bits(pPager-&gt;jfd, iHdrOff+24, &amp;iPageSize))</span>
<span class='curline'><a href='../S/185.html#L42417'>pPager</a>           42417 libdb/sqlite3.c       iPageSize = pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L42441'>pPager</a>           42441 libdb/sqlite3.c     rc = sqlite3PagerSetPagesize(pPager, &amp;iPageSize, -1);</span>
<span class='curline'><a href='../S/185.html#L42450'>pPager</a>           42450 libdb/sqlite3.c     pPager-&gt;sectorSize = iSectorSize;</span>
<span class='curline'><a href='../S/185.html#L42453'>pPager</a>           42453 libdb/sqlite3.c   pPager-&gt;journalOff += JOURNAL_HDR_SZ(pPager);</span>
<span class='curline'><a href='../S/185.html#L42477'>pPager</a>           42477 libdb/sqlite3.c static int writeMasterJournal(Pager *pPager, const char *zMaster){</span>
<span class='curline'><a href='../S/185.html#L42484'>pPager</a>           42484 libdb/sqlite3.c   assert( pPager-&gt;setMaster==0 );</span>
<span class='curline'><a href='../S/185.html#L42485'>pPager</a>           42485 libdb/sqlite3.c   assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L42488'>pPager</a>           42488 libdb/sqlite3.c    || pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY </span>
<span class='curline'><a href='../S/185.html#L42489'>pPager</a>           42489 libdb/sqlite3.c    || !isOpen(pPager-&gt;jfd)</span>
<span class='curline'><a href='../S/185.html#L42493'>pPager</a>           42493 libdb/sqlite3.c   pPager-&gt;setMaster = 1;</span>
<span class='curline'><a href='../S/185.html#L42494'>pPager</a>           42494 libdb/sqlite3.c   assert( pPager-&gt;journalHdr &lt;= pPager-&gt;journalOff );</span>
<span class='curline'><a href='../S/185.html#L42505'>pPager</a>           42505 libdb/sqlite3.c   if( pPager-&gt;fullSync ){</span>
<span class='curline'><a href='../S/185.html#L42506'>pPager</a>           42506 libdb/sqlite3.c     pPager-&gt;journalOff = journalHdrOffset(pPager);</span>
<span class='curline'><a href='../S/185.html#L42508'>pPager</a>           42508 libdb/sqlite3.c   iHdrOff = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L42513'>pPager</a>           42513 libdb/sqlite3.c   if( (0 != (rc = write32bits(pPager-&gt;jfd, iHdrOff, PAGER_MJ_PGNO(pPager))))</span>
<span class='curline'><a href='../S/185.html#L42514'>pPager</a>           42514 libdb/sqlite3.c    || (0 != (rc = sqlite3OsWrite(pPager-&gt;jfd, zMaster, nMaster, iHdrOff+4)))</span>
<span class='curline'><a href='../S/185.html#L42515'>pPager</a>           42515 libdb/sqlite3.c    || (0 != (rc = write32bits(pPager-&gt;jfd, iHdrOff+4+nMaster, nMaster)))</span>
<span class='curline'><a href='../S/185.html#L42516'>pPager</a>           42516 libdb/sqlite3.c    || (0 != (rc = write32bits(pPager-&gt;jfd, iHdrOff+4+nMaster+4, cksum)))</span>
<span class='curline'><a href='../S/185.html#L42517'>pPager</a>           42517 libdb/sqlite3.c    || (0 != (rc = sqlite3OsWrite(pPager-&gt;jfd, aJournalMagic, 8, iHdrOff+4+nMaster+8)))</span>
<span class='curline'><a href='../S/185.html#L42521'>pPager</a>           42521 libdb/sqlite3.c   pPager-&gt;journalOff += (nMaster+20);</span>
<span class='curline'><a href='../S/185.html#L42533'>pPager</a>           42533 libdb/sqlite3.c   if( SQLITE_OK==(rc = sqlite3OsFileSize(pPager-&gt;jfd, &amp;jrnlSize))</span>
<span class='curline'><a href='../S/185.html#L42534'>pPager</a>           42534 libdb/sqlite3.c    &amp;&amp; jrnlSize&gt;pPager-&gt;journalOff</span>
<span class='curline'><a href='../S/185.html#L42536'>pPager</a>           42536 libdb/sqlite3.c     rc = sqlite3OsTruncate(pPager-&gt;jfd, pPager-&gt;journalOff);</span>
<span class='curline'><a href='../S/185.html#L42544'>pPager</a>           42544 libdb/sqlite3.c static void pager_reset(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42545'>pPager</a>           42545 libdb/sqlite3.c   sqlite3BackupRestart(pPager-&gt;pBackup);</span>
<span class='curline'><a href='../S/185.html#L42546'>pPager</a>           42546 libdb/sqlite3.c   sqlite3PcacheClear(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L42554'>pPager</a>           42554 libdb/sqlite3.c static void releaseAllSavepoints(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42556'>pPager</a>           42556 libdb/sqlite3.c   for(ii=0; ii&lt;pPager-&gt;nSavepoint; ii++){</span>
<span class='curline'><a href='../S/185.html#L42557'>pPager</a>           42557 libdb/sqlite3.c     sqlite3BitvecDestroy(pPager-&gt;aSavepoint[ii].pInSavepoint);</span>
<span class='curline'><a href='../S/185.html#L42559'>pPager</a>           42559 libdb/sqlite3.c   if( !pPager-&gt;exclusiveMode || sqlite3IsMemJournal(pPager-&gt;sjfd) ){</span>
<span class='curline'><a href='../S/185.html#L42560'>pPager</a>           42560 libdb/sqlite3.c     sqlite3OsClose(pPager-&gt;sjfd);</span>
<span class='curline'><a href='../S/185.html#L42562'>pPager</a>           42562 libdb/sqlite3.c   sqlite3_free(pPager-&gt;aSavepoint);</span>
<span class='curline'><a href='../S/185.html#L42563'>pPager</a>           42563 libdb/sqlite3.c   pPager-&gt;aSavepoint = 0;</span>
<span class='curline'><a href='../S/185.html#L42564'>pPager</a>           42564 libdb/sqlite3.c   pPager-&gt;nSavepoint = 0;</span>
<span class='curline'><a href='../S/185.html#L42565'>pPager</a>           42565 libdb/sqlite3.c   pPager-&gt;nSubRec = 0;</span>
<span class='curline'><a href='../S/185.html#L42573'>pPager</a>           42573 libdb/sqlite3.c static int addToSavepointBitvecs(Pager *pPager, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L42577'>pPager</a>           42577 libdb/sqlite3.c   for(ii=0; ii&lt;pPager-&gt;nSavepoint; ii++){</span>
<span class='curline'><a href='../S/185.html#L42578'>pPager</a>           42578 libdb/sqlite3.c     PagerSavepoint *p = &amp;pPager-&gt;aSavepoint[ii];</span>
<span class='curline'><a href='../S/185.html#L42605'>pPager</a>           42605 libdb/sqlite3.c static void pager_unlock(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42607'>pPager</a>           42607 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_READER </span>
<span class='curline'><a href='../S/185.html#L42608'>pPager</a>           42608 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_OPEN </span>
<span class='curline'><a href='../S/185.html#L42609'>pPager</a>           42609 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_ERROR </span>
<span class='curline'><a href='../S/185.html#L42612'>pPager</a>           42612 libdb/sqlite3.c   sqlite3BitvecDestroy(pPager-&gt;pInJournal);</span>
<span class='curline'><a href='../S/185.html#L42613'>pPager</a>           42613 libdb/sqlite3.c   pPager-&gt;pInJournal = 0;</span>
<span class='curline'><a href='../S/185.html#L42614'>pPager</a>           42614 libdb/sqlite3.c   releaseAllSavepoints(pPager);</span>
<span class='curline'><a href='../S/185.html#L42616'>pPager</a>           42616 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L42617'>pPager</a>           42617 libdb/sqlite3.c     assert( !isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L42618'>pPager</a>           42618 libdb/sqlite3.c     sqlite3WalEndReadTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L42619'>pPager</a>           42619 libdb/sqlite3.c     pPager-&gt;eState = PAGER_OPEN;</span>
<span class='curline'><a href='../S/185.html#L42620'>pPager</a>           42620 libdb/sqlite3.c   }else if( !pPager-&gt;exclusiveMode ){</span>
<span class='curline'><a href='../S/185.html#L42622'>pPager</a>           42622 libdb/sqlite3.c     int iDc = isOpen(pPager-&gt;fd)?sqlite3OsDeviceCharacteristics(pPager-&gt;fd):0;</span>
<span class='curline'><a href='../S/185.html#L42636'>pPager</a>           42636 libdb/sqlite3.c      || 1!=(pPager-&gt;journalMode &amp; 5)</span>
<span class='curline'><a href='../S/185.html#L42638'>pPager</a>           42638 libdb/sqlite3.c       sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L42646'>pPager</a>           42646 libdb/sqlite3.c     rc = pagerUnlockDb(pPager, NO_LOCK);</span>
<span class='curline'><a href='../S/185.html#L42647'>pPager</a>           42647 libdb/sqlite3.c     if( rc!=SQLITE_OK &amp;&amp; pPager-&gt;eState==PAGER_ERROR ){</span>
<span class='curline'><a href='../S/185.html#L42648'>pPager</a>           42648 libdb/sqlite3.c       pPager-&gt;eLock = UNKNOWN_LOCK;</span>
<span class='curline'><a href='../S/185.html#L42655'>pPager</a>           42655 libdb/sqlite3.c     assert( pPager-&gt;errCode || pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L42656'>pPager</a>           42656 libdb/sqlite3.c     pPager-&gt;changeCountDone = 0;</span>
<span class='curline'><a href='../S/185.html#L42657'>pPager</a>           42657 libdb/sqlite3.c     pPager-&gt;eState = PAGER_OPEN;</span>
<span class='curline'><a href='../S/185.html#L42665'>pPager</a>           42665 libdb/sqlite3.c   if( pPager-&gt;errCode ){</span>
<span class='curline'><a href='../S/185.html#L42667'>pPager</a>           42667 libdb/sqlite3.c     pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L42668'>pPager</a>           42668 libdb/sqlite3.c     pPager-&gt;changeCountDone = pPager-&gt;tempFile;</span>
<span class='curline'><a href='../S/185.html#L42669'>pPager</a>           42669 libdb/sqlite3.c     pPager-&gt;eState = PAGER_OPEN;</span>
<span class='curline'><a href='../S/185.html#L42670'>pPager</a>           42670 libdb/sqlite3.c     pPager-&gt;errCode = SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L42671'>pPager</a>           42671 libdb/sqlite3.c     if( USEFETCH(pPager) ) sqlite3OsUnfetch(pPager-&gt;fd, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L42674'>pPager</a>           42674 libdb/sqlite3.c   pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L42675'>pPager</a>           42675 libdb/sqlite3.c   pPager-&gt;journalHdr = 0;</span>
<span class='curline'><a href='../S/185.html#L42676'>pPager</a>           42676 libdb/sqlite3.c   pPager-&gt;setMaster = 0;</span>
<span class='curline'><a href='../S/185.html#L42698'>pPager</a>           42698 libdb/sqlite3.c static int pager_error(Pager *pPager, int rc){</span>
<span class='curline'><a href='../S/185.html#L42702'>pPager</a>           42702 libdb/sqlite3.c        pPager-&gt;errCode==SQLITE_FULL ||</span>
<span class='curline'><a href='../S/185.html#L42703'>pPager</a>           42703 libdb/sqlite3.c        pPager-&gt;errCode==SQLITE_OK ||</span>
<span class='curline'><a href='../S/185.html#L42704'>pPager</a>           42704 libdb/sqlite3.c        (pPager-&gt;errCode &amp; 0xff)==SQLITE_IOERR</span>
<span class='curline'><a href='../S/185.html#L42707'>pPager</a>           42707 libdb/sqlite3.c     pPager-&gt;errCode = rc;</span>
<span class='curline'><a href='../S/185.html#L42708'>pPager</a>           42708 libdb/sqlite3.c     pPager-&gt;eState = PAGER_ERROR;</span>
<span class='curline'><a href='../S/185.html#L42713'>pPager</a>           42713 libdb/sqlite3.c static int pager_truncate(Pager *pPager, Pgno nPage);</span>
<span class='curline'><a href='../S/185.html#L42768'>pPager</a>           42768 libdb/sqlite3.c static int pager_end_transaction(Pager *pPager, int hasMaster, int bCommit){</span>
<span class='curline'><a href='../S/185.html#L42785'>pPager</a>           42785 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L42786'>pPager</a>           42786 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L42787'>pPager</a>           42787 libdb/sqlite3.c   if( pPager-&gt;eState&lt;PAGER_WRITER_LOCKED &amp;&amp; pPager-&gt;eLock&lt;RESERVED_LOCK ){</span>
<span class='curline'><a href='../S/185.html#L42791'>pPager</a>           42791 libdb/sqlite3.c   releaseAllSavepoints(pPager);</span>
<span class='curline'><a href='../S/185.html#L42792'>pPager</a>           42792 libdb/sqlite3.c   assert( isOpen(pPager-&gt;jfd) || pPager-&gt;pInJournal==0 );</span>
<span class='curline'><a href='../S/185.html#L42793'>pPager</a>           42793 libdb/sqlite3.c   if( isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L42794'>pPager</a>           42794 libdb/sqlite3.c     assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L42797'>pPager</a>           42797 libdb/sqlite3.c     if( sqlite3IsMemJournal(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L42798'>pPager</a>           42798 libdb/sqlite3.c       assert( pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY );</span>
<span class='curline'><a href='../S/185.html#L42799'>pPager</a>           42799 libdb/sqlite3.c       sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L42800'>pPager</a>           42800 libdb/sqlite3.c     }else if( pPager-&gt;journalMode==PAGER_JOURNALMODE_TRUNCATE ){</span>
<span class='curline'><a href='../S/185.html#L42801'>pPager</a>           42801 libdb/sqlite3.c       if( pPager-&gt;journalOff==0 ){</span>
<span class='curline'><a href='../S/185.html#L42804'>pPager</a>           42804 libdb/sqlite3.c         rc = sqlite3OsTruncate(pPager-&gt;jfd, 0);</span>
<span class='curline'><a href='../S/185.html#L42805'>pPager</a>           42805 libdb/sqlite3.c         if( rc==SQLITE_OK &amp;&amp; pPager-&gt;fullSync ){</span>
<span class='curline'><a href='../S/185.html#L42811'>pPager</a>           42811 libdb/sqlite3.c           rc = sqlite3OsSync(pPager-&gt;jfd, pPager-&gt;syncFlags);</span>
<span class='curline'><a href='../S/185.html#L42814'>pPager</a>           42814 libdb/sqlite3.c       pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L42815'>pPager</a>           42815 libdb/sqlite3.c     }else if( pPager-&gt;journalMode==PAGER_JOURNALMODE_PERSIST</span>
<span class='curline'><a href='../S/185.html#L42816'>pPager</a>           42816 libdb/sqlite3.c       || (pPager-&gt;exclusiveMode &amp;&amp; pPager-&gt;journalMode!=PAGER_JOURNALMODE_WAL)</span>
<span class='curline'><a href='../S/185.html#L42818'>pPager</a>           42818 libdb/sqlite3.c       rc = zeroJournalHdr(pPager, hasMaster);</span>
<span class='curline'><a href='../S/185.html#L42819'>pPager</a>           42819 libdb/sqlite3.c       pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L42826'>pPager</a>           42826 libdb/sqlite3.c       int bDelete = (!pPager-&gt;tempFile &amp;&amp; sqlite3JournalExists(pPager-&gt;jfd));</span>
<span class='curline'><a href='../S/185.html#L42827'>pPager</a>           42827 libdb/sqlite3.c       assert( pPager-&gt;journalMode==PAGER_JOURNALMODE_DELETE </span>
<span class='curline'><a href='../S/185.html#L42828'>pPager</a>           42828 libdb/sqlite3.c            || pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY </span>
<span class='curline'><a href='../S/185.html#L42829'>pPager</a>           42829 libdb/sqlite3.c            || pPager-&gt;journalMode==PAGER_JOURNALMODE_WAL </span>
<span class='curline'><a href='../S/185.html#L42831'>pPager</a>           42831 libdb/sqlite3.c       sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L42833'>pPager</a>           42833 libdb/sqlite3.c         rc = sqlite3OsDelete(pPager-&gt;pVfs, pPager-&gt;zJournal, 0);</span>
<span class='curline'><a href='../S/185.html#L42839'>pPager</a>           42839 libdb/sqlite3.c   sqlite3PcacheIterateDirty(pPager-&gt;pPCache, pager_set_pagehash);</span>
<span class='curline'><a href='../S/185.html#L42840'>pPager</a>           42840 libdb/sqlite3.c   if( pPager-&gt;dbSize==0 &amp;&amp; sqlite3PcacheRefCount(pPager-&gt;pPCache)&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L42841'>pPager</a>           42841 libdb/sqlite3.c     PgHdr *p = sqlite3PagerLookup(pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L42849'>pPager</a>           42849 libdb/sqlite3.c   sqlite3BitvecDestroy(pPager-&gt;pInJournal);</span>
<span class='curline'><a href='../S/185.html#L42850'>pPager</a>           42850 libdb/sqlite3.c   pPager-&gt;pInJournal = 0;</span>
<span class='curline'><a href='../S/185.html#L42851'>pPager</a>           42851 libdb/sqlite3.c   pPager-&gt;nRec = 0;</span>
<span class='curline'><a href='../S/185.html#L42852'>pPager</a>           42852 libdb/sqlite3.c   sqlite3PcacheCleanAll(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L42853'>pPager</a>           42853 libdb/sqlite3.c   sqlite3PcacheTruncate(pPager-&gt;pPCache, pPager-&gt;dbSize);</span>
<span class='curline'><a href='../S/185.html#L42855'>pPager</a>           42855 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L42860'>pPager</a>           42860 libdb/sqlite3.c     rc2 = sqlite3WalEndWriteTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L42862'>pPager</a>           42862 libdb/sqlite3.c   }else if( rc==SQLITE_OK &amp;&amp; bCommit &amp;&amp; pPager-&gt;dbFileSize&gt;pPager-&gt;dbSize ){</span>
<span class='curline'><a href='../S/185.html#L42869'>pPager</a>           42869 libdb/sqlite3.c     assert( pPager-&gt;eLock==EXCLUSIVE_LOCK );</span>
<span class='curline'><a href='../S/185.html#L42870'>pPager</a>           42870 libdb/sqlite3.c     rc = pager_truncate(pPager, pPager-&gt;dbSize);</span>
<span class='curline'><a href='../S/185.html#L42873'>pPager</a>           42873 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; bCommit &amp;&amp; isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L42874'>pPager</a>           42874 libdb/sqlite3.c     rc = sqlite3OsFileControl(pPager-&gt;fd, SQLITE_FCNTL_COMMIT_PHASETWO, 0);</span>
<span class='curline'><a href='../S/185.html#L42878'>pPager</a>           42878 libdb/sqlite3.c   if( !pPager-&gt;exclusiveMode </span>
<span class='curline'><a href='../S/185.html#L42879'>pPager</a>           42879 libdb/sqlite3.c    &amp;&amp; (!pagerUseWal(pPager) || sqlite3WalExclusiveMode(pPager-&gt;pWal, 0))</span>
<span class='curline'><a href='../S/185.html#L42881'>pPager</a>           42881 libdb/sqlite3.c     rc2 = pagerUnlockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L42882'>pPager</a>           42882 libdb/sqlite3.c     pPager-&gt;changeCountDone = 0;</span>
<span class='curline'><a href='../S/185.html#L42884'>pPager</a>           42884 libdb/sqlite3.c   pPager-&gt;eState = PAGER_READER;</span>
<span class='curline'><a href='../S/185.html#L42885'>pPager</a>           42885 libdb/sqlite3.c   pPager-&gt;setMaster = 0;</span>
<span class='curline'><a href='../S/185.html#L42907'>pPager</a>           42907 libdb/sqlite3.c static void pagerUnlockAndRollback(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42908'>pPager</a>           42908 libdb/sqlite3.c   if( pPager-&gt;eState!=PAGER_ERROR &amp;&amp; pPager-&gt;eState!=PAGER_OPEN ){</span>
<span class='curline'><a href='../S/185.html#L42909'>pPager</a>           42909 libdb/sqlite3.c     assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L42910'>pPager</a>           42910 libdb/sqlite3.c     if( pPager-&gt;eState&gt;=PAGER_WRITER_LOCKED ){</span>
<span class='curline'><a href='../S/185.html#L42912'>pPager</a>           42912 libdb/sqlite3.c       sqlite3PagerRollback(pPager);</span>
<span class='curline'><a href='../S/185.html#L42914'>pPager</a>           42914 libdb/sqlite3.c     }else if( !pPager-&gt;exclusiveMode ){</span>
<span class='curline'><a href='../S/185.html#L42915'>pPager</a>           42915 libdb/sqlite3.c       assert( pPager-&gt;eState==PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L42916'>pPager</a>           42916 libdb/sqlite3.c       pager_end_transaction(pPager, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L42919'>pPager</a>           42919 libdb/sqlite3.c   pager_unlock(pPager);</span>
<span class='curline'><a href='../S/185.html#L42941'>pPager</a>           42941 libdb/sqlite3.c static u32 pager_cksum(Pager *pPager, const u8 *aData){</span>
<span class='curline'><a href='../S/185.html#L42942'>pPager</a>           42942 libdb/sqlite3.c   u32 cksum = pPager-&gt;cksumInit;         /* Checksum value to return */</span>
<span class='curline'><a href='../S/185.html#L42943'>pPager</a>           42943 libdb/sqlite3.c   int i = pPager-&gt;pageSize-200;          /* Loop counter */</span>
<span class='curline'><a href='../S/185.html#L42956'>pPager</a>           42956 libdb/sqlite3.c static void pagerReportSize(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L42957'>pPager</a>           42957 libdb/sqlite3.c   if( pPager-&gt;xCodecSizeChng ){</span>
<span class='curline'><a href='../S/185.html#L42958'>pPager</a>           42958 libdb/sqlite3.c     pPager-&gt;xCodecSizeChng(pPager-&gt;pCodec, pPager-&gt;pageSize,</span>
<span class='curline'><a href='../S/185.html#L42959'>pPager</a>           42959 libdb/sqlite3.c                            (int)pPager-&gt;nReserve);</span>
<span class='curline'><a href='../S/185.html#L43004'>pPager</a>           43004 libdb/sqlite3.c   Pager *pPager,                /* The pager being played back */</span>
<span class='curline'><a href='../S/185.html#L43023'>pPager</a>           43023 libdb/sqlite3.c   aData = pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L43025'>pPager</a>           43025 libdb/sqlite3.c   assert( pagerUseWal(pPager)==0 || (!isMainJrnl &amp;&amp; isSavepnt) );</span>
<span class='curline'><a href='../S/185.html#L43033'>pPager</a>           43033 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L43034'>pPager</a>           43034 libdb/sqlite3.c        || (pPager-&gt;eState==PAGER_OPEN &amp;&amp; pPager-&gt;eLock==EXCLUSIVE_LOCK)</span>
<span class='curline'><a href='../S/185.html#L43036'>pPager</a>           43036 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_CACHEMOD || isMainJrnl );</span>
<span class='curline'><a href='../S/185.html#L43041'>pPager</a>           43041 libdb/sqlite3.c   jfd = isMainJrnl ? pPager-&gt;jfd : pPager-&gt;sjfd;</span>
<span class='curline'><a href='../S/185.html#L43044'>pPager</a>           43044 libdb/sqlite3.c   rc = sqlite3OsRead(jfd, (u8*)aData, pPager-&gt;pageSize, (*pOffset)+4);</span>
<span class='curline'><a href='../S/185.html#L43046'>pPager</a>           43046 libdb/sqlite3.c   *pOffset += pPager-&gt;pageSize + 4 + isMainJrnl*4;</span>
<span class='curline'><a href='../S/185.html#L43053'>pPager</a>           43053 libdb/sqlite3.c   if( pgno==0 || pgno==PAGER_MJ_PGNO(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L43057'>pPager</a>           43057 libdb/sqlite3.c   if( pgno&gt;(Pgno)pPager-&gt;dbSize || sqlite3BitvecTest(pDone, pgno) ){</span>
<span class='curline'><a href='../S/185.html#L43063'>pPager</a>           43063 libdb/sqlite3.c     if( !isSavepnt &amp;&amp; pager_cksum(pPager, (u8*)aData)!=cksum ){</span>
<span class='curline'><a href='../S/185.html#L43077'>pPager</a>           43077 libdb/sqlite3.c   if( pgno==1 &amp;&amp; pPager-&gt;nReserve!=((u8*)aData)[20] ){</span>
<span class='curline'><a href='../S/185.html#L43078'>pPager</a>           43078 libdb/sqlite3.c     pPager-&gt;nReserve = ((u8*)aData)[20];</span>
<span class='curline'><a href='../S/185.html#L43079'>pPager</a>           43079 libdb/sqlite3.c     pagerReportSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L43117'>pPager</a>           43117 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L43120'>pPager</a>           43120 libdb/sqlite3.c     pPg = sqlite3PagerLookup(pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L43123'>pPager</a>           43123 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_OPEN || pPg==0 );</span>
<span class='curline'><a href='../S/185.html#L43125'>pPager</a>           43125 libdb/sqlite3.c            PAGERID(pPager), pgno, pager_datahash(pPager-&gt;pageSize, (u8*)aData),</span>
<span class='curline'><a href='../S/185.html#L43129'>pPager</a>           43129 libdb/sqlite3.c     isSynced = pPager-&gt;noSync || (*pOffset &lt;= pPager-&gt;journalHdr);</span>
<span class='curline'><a href='../S/185.html#L43133'>pPager</a>           43133 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd)</span>
<span class='curline'><a href='../S/185.html#L43134'>pPager</a>           43134 libdb/sqlite3.c    &amp;&amp; (pPager-&gt;eState&gt;=PAGER_WRITER_DBMOD || pPager-&gt;eState==PAGER_OPEN)</span>
<span class='curline'><a href='../S/185.html#L43137'>pPager</a>           43137 libdb/sqlite3.c     i64 ofst = (pgno-1)*(i64)pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L43139'>pPager</a>           43139 libdb/sqlite3.c     assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L43140'>pPager</a>           43140 libdb/sqlite3.c     rc = sqlite3OsWrite(pPager-&gt;fd, (u8 *)aData, pPager-&gt;pageSize, ofst);</span>
<span class='curline'><a href='../S/185.html#L43141'>pPager</a>           43141 libdb/sqlite3.c     if( pgno&gt;pPager-&gt;dbFileSize ){</span>
<span class='curline'><a href='../S/185.html#L43142'>pPager</a>           43142 libdb/sqlite3.c       pPager-&gt;dbFileSize = pgno;</span>
<span class='curline'><a href='../S/185.html#L43144'>pPager</a>           43144 libdb/sqlite3.c     if( pPager-&gt;pBackup ){</span>
<span class='curline'><a href='../S/185.html#L43145'>pPager</a>           43145 libdb/sqlite3.c       CODEC1(pPager, aData, pgno, 3, rc=SQLITE_NOMEM);</span>
<span class='curline'><a href='../S/185.html#L43146'>pPager</a>           43146 libdb/sqlite3.c       sqlite3BackupUpdate(pPager-&gt;pBackup, pgno, (u8*)aData);</span>
<span class='curline'><a href='../S/185.html#L43147'>pPager</a>           43147 libdb/sqlite3.c       CODEC2(pPager, aData, pgno, 7, rc=SQLITE_NOMEM, aData);</span>
<span class='curline'><a href='../S/185.html#L43167'>pPager</a>           43167 libdb/sqlite3.c     assert( (pPager-&gt;doNotSpill &amp; SPILLFLAG_ROLLBACK)==0 );</span>
<span class='curline'><a href='../S/185.html#L43168'>pPager</a>           43168 libdb/sqlite3.c     pPager-&gt;doNotSpill |= SPILLFLAG_ROLLBACK;</span>
<span class='curline'><a href='../S/185.html#L43169'>pPager</a>           43169 libdb/sqlite3.c     rc = sqlite3PagerAcquire(pPager, pgno, &amp;pPg, 1);</span>
<span class='curline'><a href='../S/185.html#L43170'>pPager</a>           43170 libdb/sqlite3.c     assert( (pPager-&gt;doNotSpill &amp; SPILLFLAG_ROLLBACK)!=0 );</span>
<span class='curline'><a href='../S/185.html#L43171'>pPager</a>           43171 libdb/sqlite3.c     pPager-&gt;doNotSpill &amp;= ~SPILLFLAG_ROLLBACK;</span>
<span class='curline'><a href='../S/185.html#L43185'>pPager</a>           43185 libdb/sqlite3.c     memcpy(pData, (u8*)aData, pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L43186'>pPager</a>           43186 libdb/sqlite3.c     pPager-&gt;xReiniter(pPg);</span>
<span class='curline'><a href='../S/185.html#L43187'>pPager</a>           43187 libdb/sqlite3.c     if( isMainJrnl &amp;&amp; (!isSavepnt || *pOffset&lt;=pPager-&gt;journalHdr) ){</span>
<span class='curline'><a href='../S/185.html#L43207'>pPager</a>           43207 libdb/sqlite3.c       assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L43215'>pPager</a>           43215 libdb/sqlite3.c       memcpy(&amp;pPager-&gt;dbFileVers, &amp;((u8*)pData)[24],sizeof(pPager-&gt;dbFileVers));</span>
<span class='curline'><a href='../S/185.html#L43219'>pPager</a>           43219 libdb/sqlite3.c     CODEC1(pPager, pData, pPg-&gt;pgno, 3, rc=SQLITE_NOMEM);</span>
<span class='curline'><a href='../S/185.html#L43268'>pPager</a>           43268 libdb/sqlite3.c static int pager_delmaster(Pager *pPager, const char *zMaster){</span>
<span class='curline'><a href='../S/185.html#L43269'>pPager</a>           43269 libdb/sqlite3.c   sqlite3_vfs *pVfs = pPager-&gt;pVfs;</span>
<span class='curline'><a href='../S/185.html#L43378'>pPager</a>           43378 libdb/sqlite3.c static int pager_truncate(Pager *pPager, Pgno nPage){</span>
<span class='curline'><a href='../S/185.html#L43380'>pPager</a>           43380 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L43381'>pPager</a>           43381 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L43383'>pPager</a>           43383 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd) </span>
<span class='curline'><a href='../S/185.html#L43384'>pPager</a>           43384 libdb/sqlite3.c    &amp;&amp; (pPager-&gt;eState&gt;=PAGER_WRITER_DBMOD || pPager-&gt;eState==PAGER_OPEN) </span>
<span class='curline'><a href='../S/185.html#L43387'>pPager</a>           43387 libdb/sqlite3.c     int szPage = pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L43388'>pPager</a>           43388 libdb/sqlite3.c     assert( pPager-&gt;eLock==EXCLUSIVE_LOCK );</span>
<span class='curline'><a href='../S/185.html#L43390'>pPager</a>           43390 libdb/sqlite3.c     rc = sqlite3OsFileSize(pPager-&gt;fd, &amp;currentSize);</span>
<span class='curline'><a href='../S/185.html#L43394'>pPager</a>           43394 libdb/sqlite3.c         rc = sqlite3OsTruncate(pPager-&gt;fd, newSize);</span>
<span class='curline'><a href='../S/185.html#L43396'>pPager</a>           43396 libdb/sqlite3.c         char *pTmp = pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L43400'>pPager</a>           43400 libdb/sqlite3.c         rc = sqlite3OsWrite(pPager-&gt;fd, pTmp, szPage, newSize-szPage);</span>
<span class='curline'><a href='../S/185.html#L43403'>pPager</a>           43403 libdb/sqlite3.c         pPager-&gt;dbFileSize = nPage;</span>
<span class='curline'><a href='../S/185.html#L43448'>pPager</a>           43448 libdb/sqlite3.c static void setSectorSize(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L43449'>pPager</a>           43449 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) || pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L43451'>pPager</a>           43451 libdb/sqlite3.c   if( pPager-&gt;tempFile</span>
<span class='curline'><a href='../S/185.html#L43452'>pPager</a>           43452 libdb/sqlite3.c    || (sqlite3OsDeviceCharacteristics(pPager-&gt;fd) &amp; </span>
<span class='curline'><a href='../S/185.html#L43458'>pPager</a>           43458 libdb/sqlite3.c     pPager-&gt;sectorSize = 512;</span>
<span class='curline'><a href='../S/185.html#L43460'>pPager</a>           43460 libdb/sqlite3.c     pPager-&gt;sectorSize = sqlite3SectorSize(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L43521'>pPager</a>           43521 libdb/sqlite3.c static int pager_playback(Pager *pPager, int isHot){</span>
<span class='curline'><a href='../S/185.html#L43522'>pPager</a>           43522 libdb/sqlite3.c   sqlite3_vfs *pVfs = pPager-&gt;pVfs;</span>
<span class='curline'><a href='../S/185.html#L43536'>pPager</a>           43536 libdb/sqlite3.c   assert( isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L43537'>pPager</a>           43537 libdb/sqlite3.c   rc = sqlite3OsFileSize(pPager-&gt;jfd, &amp;szJ);</span>
<span class='curline'><a href='../S/185.html#L43553'>pPager</a>           43553 libdb/sqlite3.c   zMaster = pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L43554'>pPager</a>           43554 libdb/sqlite3.c   rc = readMasterJournal(pPager-&gt;jfd, zMaster, pPager-&gt;pVfs-&gt;mxPathname+1);</span>
<span class='curline'><a href='../S/185.html#L43562'>pPager</a>           43562 libdb/sqlite3.c   pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L43575'>pPager</a>           43575 libdb/sqlite3.c     rc = readJournalHdr(pPager, isHot, szJ, &amp;nRec, &amp;mxPg);</span>
<span class='curline'><a href='../S/185.html#L43589'>pPager</a>           43589 libdb/sqlite3.c       assert( pPager-&gt;journalOff==JOURNAL_HDR_SZ(pPager) );</span>
<span class='curline'><a href='../S/185.html#L43590'>pPager</a>           43590 libdb/sqlite3.c       nRec = (int)((szJ - JOURNAL_HDR_SZ(pPager))/JOURNAL_PG_SZ(pPager));</span>
<span class='curline'><a href='../S/185.html#L43608'>pPager</a>           43608 libdb/sqlite3.c         pPager-&gt;journalHdr+JOURNAL_HDR_SZ(pPager)==pPager-&gt;journalOff ){</span>
<span class='curline'><a href='../S/185.html#L43609'>pPager</a>           43609 libdb/sqlite3.c       nRec = (int)((szJ - pPager-&gt;journalOff) / JOURNAL_PG_SZ(pPager));</span>
<span class='curline'><a href='../S/185.html#L43615'>pPager</a>           43615 libdb/sqlite3.c     if( pPager-&gt;journalOff==JOURNAL_HDR_SZ(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L43616'>pPager</a>           43616 libdb/sqlite3.c       rc = pager_truncate(pPager, mxPg);</span>
<span class='curline'><a href='../S/185.html#L43620'>pPager</a>           43620 libdb/sqlite3.c       pPager-&gt;dbSize = mxPg;</span>
<span class='curline'><a href='../S/185.html#L43628'>pPager</a>           43628 libdb/sqlite3.c         pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L43631'>pPager</a>           43631 libdb/sqlite3.c       rc = pager_playback_one_page(pPager,&amp;pPager-&gt;journalOff,0,1,0);</span>
<span class='curline'><a href='../S/185.html#L43636'>pPager</a>           43636 libdb/sqlite3.c           pPager-&gt;journalOff = szJ;</span>
<span class='curline'><a href='../S/185.html#L43667'>pPager</a>           43667 libdb/sqlite3.c   if( pPager-&gt;fd-&gt;pMethods ){</span>
<span class='curline'><a href='../S/185.html#L43668'>pPager</a>           43668 libdb/sqlite3.c     sqlite3OsFileControlHint(pPager-&gt;fd,SQLITE_FCNTL_DB_UNCHANGED,0);</span>
<span class='curline'><a href='../S/185.html#L43681'>pPager</a>           43681 libdb/sqlite3.c   pPager-&gt;changeCountDone = pPager-&gt;tempFile;</span>
<span class='curline'><a href='../S/185.html#L43684'>pPager</a>           43684 libdb/sqlite3.c     zMaster = pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L43685'>pPager</a>           43685 libdb/sqlite3.c     rc = readMasterJournal(pPager-&gt;jfd, zMaster, pPager-&gt;pVfs-&gt;mxPathname+1);</span>
<span class='curline'><a href='../S/185.html#L43689'>pPager</a>           43689 libdb/sqlite3.c    &amp;&amp; (pPager-&gt;eState&gt;=PAGER_WRITER_DBMOD || pPager-&gt;eState==PAGER_OPEN)</span>
<span class='curline'><a href='../S/185.html#L43691'>pPager</a>           43691 libdb/sqlite3.c     rc = sqlite3PagerSync(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L43694'>pPager</a>           43694 libdb/sqlite3.c     rc = pager_end_transaction(pPager, zMaster[0]!='\0', 0);</span>
<span class='curline'><a href='../S/185.html#L43701'>pPager</a>           43701 libdb/sqlite3.c     rc = pager_delmaster(pPager, zMaster);</span>
<span class='curline'><a href='../S/185.html#L43706'>pPager</a>           43706 libdb/sqlite3.c                 nPlayback, pPager-&gt;zJournal);</span>
<span class='curline'><a href='../S/185.html#L43713'>pPager</a>           43713 libdb/sqlite3.c   setSectorSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L43730'>pPager</a>           43730 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager; /* Pager object associated with page pPg */</span>
<span class='curline'><a href='../S/185.html#L43733'>pPager</a>           43733 libdb/sqlite3.c   int pgsz = pPager-&gt;pageSize; /* Number of bytes to read */</span>
<span class='curline'><a href='../S/185.html#L43735'>pPager</a>           43735 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_READER &amp;&amp; !MEMDB );</span>
<span class='curline'><a href='../S/185.html#L43736'>pPager</a>           43736 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) );</span>
<span class='curline'><a href='../S/185.html#L43741'>pPager</a>           43741 libdb/sqlite3.c     rc = sqlite3WalReadFrame(pPager-&gt;pWal, iFrame, pgsz, pPg-&gt;pData);</span>
<span class='curline'><a href='../S/185.html#L43745'>pPager</a>           43745 libdb/sqlite3.c     i64 iOffset = (pgno-1)*(i64)pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L43746'>pPager</a>           43746 libdb/sqlite3.c     rc = sqlite3OsRead(pPager-&gt;fd, pPg-&gt;pData, pgsz, iOffset);</span>
<span class='curline'><a href='../S/185.html#L43766'>pPager</a>           43766 libdb/sqlite3.c       memset(pPager-&gt;dbFileVers, 0xff, sizeof(pPager-&gt;dbFileVers));</span>
<span class='curline'><a href='../S/185.html#L43769'>pPager</a>           43769 libdb/sqlite3.c       memcpy(&amp;pPager-&gt;dbFileVers, dbFileVers, sizeof(pPager-&gt;dbFileVers));</span>
<span class='curline'><a href='../S/185.html#L43772'>pPager</a>           43772 libdb/sqlite3.c   CODEC1(pPager, pPg-&gt;pData, pgno, 3, rc = SQLITE_NOMEM);</span>
<span class='curline'><a href='../S/185.html#L43775'>pPager</a>           43775 libdb/sqlite3.c   PAGER_INCR(pPager-&gt;nRead);</span>
<span class='curline'><a href='../S/185.html#L43776'>pPager</a>           43776 libdb/sqlite3.c   IOTRACE(("PGIN %p %d\n", pPager, pgno));</span>
<span class='curline'><a href='../S/185.html#L43778'>pPager</a>           43778 libdb/sqlite3.c                PAGERID(pPager), pgno, pager_pagehash(pPg)));</span>
<span class='curline'><a href='../S/185.html#L43795'>pPager</a>           43795 libdb/sqlite3.c   change_counter = sqlite3Get4byte((u8*)pPg-&gt;pPager-&gt;dbFileVers)+1;</span>
<span class='curline'><a href='../S/185.html#L43820'>pPager</a>           43820 libdb/sqlite3.c   Pager *pPager = (Pager *)pCtx;</span>
<span class='curline'><a href='../S/185.html#L43823'>pPager</a>           43823 libdb/sqlite3.c   assert( pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L43824'>pPager</a>           43824 libdb/sqlite3.c   pPg = sqlite3PagerLookup(pPager, iPg);</span>
<span class='curline'><a href='../S/185.html#L43830'>pPager</a>           43830 libdb/sqlite3.c       rc = sqlite3WalFindFrame(pPager-&gt;pWal, pPg-&gt;pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/185.html#L43835'>pPager</a>           43835 libdb/sqlite3.c         pPager-&gt;xReiniter(pPg);</span>
<span class='curline'><a href='../S/185.html#L43849'>pPager</a>           43849 libdb/sqlite3.c   sqlite3BackupRestart(pPager-&gt;pBackup);</span>
<span class='curline'><a href='../S/185.html#L43857'>pPager</a>           43857 libdb/sqlite3.c static int pagerRollbackWal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L43868'>pPager</a>           43868 libdb/sqlite3.c   pPager-&gt;dbSize = pPager-&gt;dbOrigSize;</span>
<span class='curline'><a href='../S/185.html#L43869'>pPager</a>           43869 libdb/sqlite3.c   rc = sqlite3WalUndo(pPager-&gt;pWal, pagerUndoCallback, (void *)pPager);</span>
<span class='curline'><a href='../S/185.html#L43870'>pPager</a>           43870 libdb/sqlite3.c   pList = sqlite3PcacheDirtyList(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L43873'>pPager</a>           43873 libdb/sqlite3.c     rc = pagerUndoCallback((void *)pPager, pList-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L43890'>pPager</a>           43890 libdb/sqlite3.c   Pager *pPager,                  /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L43901'>pPager</a>           43901 libdb/sqlite3.c   assert( pPager-&gt;pWal );</span>
<span class='curline'><a href='../S/185.html#L43929'>pPager</a>           43929 libdb/sqlite3.c   pPager-&gt;aStat[PAGER_STAT_WRITE] += nList;</span>
<span class='curline'><a href='../S/185.html#L43932'>pPager</a>           43932 libdb/sqlite3.c   rc = sqlite3WalFrames(pPager-&gt;pWal, </span>
<span class='curline'><a href='../S/185.html#L43933'>pPager</a>           43933 libdb/sqlite3.c       pPager-&gt;pageSize, pList, nTruncate, isCommit, pPager-&gt;walSyncFlags</span>
<span class='curline'><a href='../S/185.html#L43935'>pPager</a>           43935 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; pPager-&gt;pBackup ){</span>
<span class='curline'><a href='../S/185.html#L43938'>pPager</a>           43938 libdb/sqlite3.c       sqlite3BackupUpdate(pPager-&gt;pBackup, p-&gt;pgno, (u8 *)p-&gt;pData);</span>
<span class='curline'><a href='../S/185.html#L43943'>pPager</a>           43943 libdb/sqlite3.c   pList = sqlite3PcacheDirtyList(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L43960'>pPager</a>           43960 libdb/sqlite3.c static int pagerBeginReadTransaction(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L43964'>pPager</a>           43964 libdb/sqlite3.c   assert( pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L43965'>pPager</a>           43965 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN || pPager-&gt;eState==PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L43972'>pPager</a>           43972 libdb/sqlite3.c   sqlite3WalEndReadTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L43974'>pPager</a>           43974 libdb/sqlite3.c   rc = sqlite3WalBeginReadTransaction(pPager-&gt;pWal, &amp;changed);</span>
<span class='curline'><a href='../S/185.html#L43976'>pPager</a>           43976 libdb/sqlite3.c     pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L43977'>pPager</a>           43977 libdb/sqlite3.c     if( USEFETCH(pPager) ) sqlite3OsUnfetch(pPager-&gt;fd, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L43993'>pPager</a>           43993 libdb/sqlite3.c static int pagerPagecount(Pager *pPager, Pgno *pnPage){</span>
<span class='curline'><a href='../S/185.html#L44002'>pPager</a>           44002 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN );</span>
<span class='curline'><a href='../S/185.html#L44003'>pPager</a>           44003 libdb/sqlite3.c   assert( pPager-&gt;eLock&gt;=SHARED_LOCK );</span>
<span class='curline'><a href='../S/185.html#L44004'>pPager</a>           44004 libdb/sqlite3.c   nPage = sqlite3WalDbsize(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L44014'>pPager</a>           44014 libdb/sqlite3.c     assert( isOpen(pPager-&gt;fd) || pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L44015'>pPager</a>           44015 libdb/sqlite3.c     if( isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L44016'>pPager</a>           44016 libdb/sqlite3.c       int rc = sqlite3OsFileSize(pPager-&gt;fd, &amp;n);</span>
<span class='curline'><a href='../S/185.html#L44021'>pPager</a>           44021 libdb/sqlite3.c     nPage = (Pgno)((n+pPager-&gt;pageSize-1) / pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L44028'>pPager</a>           44028 libdb/sqlite3.c   if( nPage&gt;pPager-&gt;mxPgno ){</span>
<span class='curline'><a href='../S/185.html#L44029'>pPager</a>           44029 libdb/sqlite3.c     pPager-&gt;mxPgno = (Pgno)nPage;</span>
<span class='curline'><a href='../S/185.html#L44055'>pPager</a>           44055 libdb/sqlite3.c static int pagerOpenWalIfPresent(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44057'>pPager</a>           44057 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN );</span>
<span class='curline'><a href='../S/185.html#L44058'>pPager</a>           44058 libdb/sqlite3.c   assert( pPager-&gt;eLock&gt;=SHARED_LOCK );</span>
<span class='curline'><a href='../S/185.html#L44060'>pPager</a>           44060 libdb/sqlite3.c   if( !pPager-&gt;tempFile ){</span>
<span class='curline'><a href='../S/185.html#L44064'>pPager</a>           44064 libdb/sqlite3.c     rc = pagerPagecount(pPager, &amp;nPage);</span>
<span class='curline'><a href='../S/185.html#L44067'>pPager</a>           44067 libdb/sqlite3.c       rc = sqlite3OsDelete(pPager-&gt;pVfs, pPager-&gt;zWal, 0);</span>
<span class='curline'><a href='../S/185.html#L44072'>pPager</a>           44072 libdb/sqlite3.c           pPager-&gt;pVfs, pPager-&gt;zWal, SQLITE_ACCESS_EXISTS, &amp;isWal</span>
<span class='curline'><a href='../S/185.html#L44077'>pPager</a>           44077 libdb/sqlite3.c         testcase( sqlite3PcachePagecount(pPager-&gt;pPCache)==0 );</span>
<span class='curline'><a href='../S/185.html#L44078'>pPager</a>           44078 libdb/sqlite3.c         rc = sqlite3PagerOpenWal(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L44079'>pPager</a>           44079 libdb/sqlite3.c       }else if( pPager-&gt;journalMode==PAGER_JOURNALMODE_WAL ){</span>
<span class='curline'><a href='../S/185.html#L44080'>pPager</a>           44080 libdb/sqlite3.c         pPager-&gt;journalMode = PAGER_JOURNALMODE_DELETE;</span>
<span class='curline'><a href='../S/185.html#L44124'>pPager</a>           44124 libdb/sqlite3.c static int pagerPlaybackSavepoint(Pager *pPager, PagerSavepoint *pSavepoint){</span>
<span class='curline'><a href='../S/185.html#L44130'>pPager</a>           44130 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L44131'>pPager</a>           44131 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L44144'>pPager</a>           44144 libdb/sqlite3.c   pPager-&gt;dbSize = pSavepoint ? pSavepoint-&gt;nOrig : pPager-&gt;dbOrigSize;</span>
<span class='curline'><a href='../S/185.html#L44145'>pPager</a>           44145 libdb/sqlite3.c   pPager-&gt;changeCountDone = pPager-&gt;tempFile;</span>
<span class='curline'><a href='../S/185.html#L44147'>pPager</a>           44147 libdb/sqlite3.c   if( !pSavepoint &amp;&amp; pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L44148'>pPager</a>           44148 libdb/sqlite3.c     return pagerRollbackWal(pPager);</span>
<span class='curline'><a href='../S/185.html#L44156'>pPager</a>           44156 libdb/sqlite3.c   szJ = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L44157'>pPager</a>           44157 libdb/sqlite3.c   assert( pagerUseWal(pPager)==0 || szJ==0 );</span>
<span class='curline'><a href='../S/185.html#L44166'>pPager</a>           44166 libdb/sqlite3.c   if( pSavepoint &amp;&amp; !pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L44168'>pPager</a>           44168 libdb/sqlite3.c     pPager-&gt;journalOff = pSavepoint-&gt;iOffset;</span>
<span class='curline'><a href='../S/185.html#L44169'>pPager</a>           44169 libdb/sqlite3.c     while( rc==SQLITE_OK &amp;&amp; pPager-&gt;journalOff&lt;iHdrOff ){</span>
<span class='curline'><a href='../S/185.html#L44170'>pPager</a>           44170 libdb/sqlite3.c       rc = pager_playback_one_page(pPager, &amp;pPager-&gt;journalOff, pDone, 1, 1);</span>
<span class='curline'><a href='../S/185.html#L44174'>pPager</a>           44174 libdb/sqlite3.c     pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L44182'>pPager</a>           44182 libdb/sqlite3.c   while( rc==SQLITE_OK &amp;&amp; pPager-&gt;journalOff&lt;szJ ){</span>
<span class='curline'><a href='../S/185.html#L44186'>pPager</a>           44186 libdb/sqlite3.c     rc = readJournalHdr(pPager, 0, szJ, &amp;nJRec, &amp;dummy);</span>
<span class='curline'><a href='../S/185.html#L44195'>pPager</a>           44195 libdb/sqlite3.c      &amp;&amp; pPager-&gt;journalHdr+JOURNAL_HDR_SZ(pPager)==pPager-&gt;journalOff</span>
<span class='curline'><a href='../S/185.html#L44197'>pPager</a>           44197 libdb/sqlite3.c       nJRec = (u32)((szJ - pPager-&gt;journalOff)/JOURNAL_PG_SZ(pPager));</span>
<span class='curline'><a href='../S/185.html#L44199'>pPager</a>           44199 libdb/sqlite3.c     for(ii=0; rc==SQLITE_OK &amp;&amp; ii&lt;nJRec &amp;&amp; pPager-&gt;journalOff&lt;szJ; ii++){</span>
<span class='curline'><a href='../S/185.html#L44200'>pPager</a>           44200 libdb/sqlite3.c       rc = pager_playback_one_page(pPager, &amp;pPager-&gt;journalOff, pDone, 1, 1);</span>
<span class='curline'><a href='../S/185.html#L44204'>pPager</a>           44204 libdb/sqlite3.c   assert( rc!=SQLITE_OK || pPager-&gt;journalOff&gt;=szJ );</span>
<span class='curline'><a href='../S/185.html#L44212'>pPager</a>           44212 libdb/sqlite3.c     i64 offset = (i64)pSavepoint-&gt;iSubRec*(4+pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L44214'>pPager</a>           44214 libdb/sqlite3.c     if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L44215'>pPager</a>           44215 libdb/sqlite3.c       rc = sqlite3WalSavepointUndo(pPager-&gt;pWal, pSavepoint-&gt;aWalData);</span>
<span class='curline'><a href='../S/185.html#L44217'>pPager</a>           44217 libdb/sqlite3.c     for(ii=pSavepoint-&gt;iSubRec; rc==SQLITE_OK &amp;&amp; ii&lt;pPager-&gt;nSubRec; ii++){</span>
<span class='curline'><a href='../S/185.html#L44218'>pPager</a>           44218 libdb/sqlite3.c       assert( offset==(i64)ii*(4+pPager-&gt;pageSize) );</span>
<span class='curline'><a href='../S/185.html#L44219'>pPager</a>           44219 libdb/sqlite3.c       rc = pager_playback_one_page(pPager, &amp;offset, pDone, 0, 1);</span>
<span class='curline'><a href='../S/185.html#L44226'>pPager</a>           44226 libdb/sqlite3.c     pPager-&gt;journalOff = szJ;</span>
<span class='curline'><a href='../S/185.html#L44235'>pPager</a>           44235 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerSetCachesize(Pager *pPager, int mxPage){</span>
<span class='curline'><a href='../S/185.html#L44236'>pPager</a>           44236 libdb/sqlite3.c   sqlite3PcacheSetCachesize(pPager-&gt;pPCache, mxPage);</span>
<span class='curline'><a href='../S/185.html#L44242'>pPager</a>           44242 libdb/sqlite3.c static void pagerFixMaplimit(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44244'>pPager</a>           44244 libdb/sqlite3.c   sqlite3_file *fd = pPager-&gt;fd;</span>
<span class='curline'><a href='../S/185.html#L44247'>pPager</a>           44247 libdb/sqlite3.c     sz = pPager-&gt;szMmap;</span>
<span class='curline'><a href='../S/185.html#L44248'>pPager</a>           44248 libdb/sqlite3.c     pPager-&gt;bUseFetch = (sz&gt;0);</span>
<span class='curline'><a href='../S/185.html#L44249'>pPager</a>           44249 libdb/sqlite3.c     sqlite3OsFileControlHint(pPager-&gt;fd, SQLITE_FCNTL_MMAP_SIZE, &amp;sz);</span>
<span class='curline'><a href='../S/185.html#L44257'>pPager</a>           44257 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerSetMmapLimit(Pager *pPager, sqlite3_int64 szMmap){</span>
<span class='curline'><a href='../S/185.html#L44258'>pPager</a>           44258 libdb/sqlite3.c   pPager-&gt;szMmap = szMmap;</span>
<span class='curline'><a href='../S/185.html#L44259'>pPager</a>           44259 libdb/sqlite3.c   pagerFixMaplimit(pPager);</span>
<span class='curline'><a href='../S/185.html#L44265'>pPager</a>           44265 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerShrink(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44266'>pPager</a>           44266 libdb/sqlite3.c   sqlite3PcacheShrink(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L44317'>pPager</a>           44317 libdb/sqlite3.c   Pager *pPager,        /* The pager to set safety level for */</span>
<span class='curline'><a href='../S/185.html#L44322'>pPager</a>           44322 libdb/sqlite3.c   pPager-&gt;noSync =  (level==1 || pPager-&gt;tempFile) ?1:0;</span>
<span class='curline'><a href='../S/185.html#L44323'>pPager</a>           44323 libdb/sqlite3.c   pPager-&gt;fullSync = (level==3 &amp;&amp; !pPager-&gt;tempFile) ?1:0;</span>
<span class='curline'><a href='../S/185.html#L44324'>pPager</a>           44324 libdb/sqlite3.c   if( pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L44325'>pPager</a>           44325 libdb/sqlite3.c     pPager-&gt;syncFlags = 0;</span>
<span class='curline'><a href='../S/185.html#L44326'>pPager</a>           44326 libdb/sqlite3.c     pPager-&gt;ckptSyncFlags = 0;</span>
<span class='curline'><a href='../S/185.html#L44328'>pPager</a>           44328 libdb/sqlite3.c     pPager-&gt;syncFlags = SQLITE_SYNC_FULL;</span>
<span class='curline'><a href='../S/185.html#L44329'>pPager</a>           44329 libdb/sqlite3.c     pPager-&gt;ckptSyncFlags = SQLITE_SYNC_FULL;</span>
<span class='curline'><a href='../S/185.html#L44331'>pPager</a>           44331 libdb/sqlite3.c     pPager-&gt;syncFlags = SQLITE_SYNC_NORMAL;</span>
<span class='curline'><a href='../S/185.html#L44332'>pPager</a>           44332 libdb/sqlite3.c     pPager-&gt;ckptSyncFlags = SQLITE_SYNC_FULL;</span>
<span class='curline'><a href='../S/185.html#L44334'>pPager</a>           44334 libdb/sqlite3.c     pPager-&gt;syncFlags = SQLITE_SYNC_NORMAL;</span>
<span class='curline'><a href='../S/185.html#L44335'>pPager</a>           44335 libdb/sqlite3.c     pPager-&gt;ckptSyncFlags = SQLITE_SYNC_NORMAL;</span>
<span class='curline'><a href='../S/185.html#L44337'>pPager</a>           44337 libdb/sqlite3.c   pPager-&gt;walSyncFlags = pPager-&gt;syncFlags;</span>
<span class='curline'><a href='../S/185.html#L44338'>pPager</a>           44338 libdb/sqlite3.c   if( pPager-&gt;fullSync ){</span>
<span class='curline'><a href='../S/185.html#L44339'>pPager</a>           44339 libdb/sqlite3.c     pPager-&gt;walSyncFlags |= WAL_SYNC_TRANSACTIONS;</span>
<span class='curline'><a href='../S/185.html#L44342'>pPager</a>           44342 libdb/sqlite3.c     pPager-&gt;doNotSpill &amp;= ~SPILLFLAG_OFF;</span>
<span class='curline'><a href='../S/185.html#L44344'>pPager</a>           44344 libdb/sqlite3.c     pPager-&gt;doNotSpill |= SPILLFLAG_OFF;</span>
<span class='curline'><a href='../S/185.html#L44374'>pPager</a>           44374 libdb/sqlite3.c   Pager *pPager,        /* The pager object */</span>
<span class='curline'><a href='../S/185.html#L44386'>pPager</a>           44386 libdb/sqlite3.c   rc = sqlite3OsOpen(pPager-&gt;pVfs, 0, pFile, vfsFlags, 0);</span>
<span class='curline'><a href='../S/185.html#L44413'>pPager</a>           44413 libdb/sqlite3.c   Pager *pPager,                       /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L44417'>pPager</a>           44417 libdb/sqlite3.c   pPager-&gt;xBusyHandler = xBusyHandler;</span>
<span class='curline'><a href='../S/185.html#L44418'>pPager</a>           44418 libdb/sqlite3.c   pPager-&gt;pBusyHandlerArg = pBusyHandlerArg;</span>
<span class='curline'><a href='../S/185.html#L44420'>pPager</a>           44420 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L44421'>pPager</a>           44421 libdb/sqlite3.c     void **ap = (void **)&amp;pPager-&gt;xBusyHandler;</span>
<span class='curline'><a href='../S/185.html#L44424'>pPager</a>           44424 libdb/sqlite3.c     sqlite3OsFileControlHint(pPager-&gt;fd, SQLITE_FCNTL_BUSYHANDLER, (void *)ap);</span>
<span class='curline'><a href='../S/185.html#L44458'>pPager</a>           44458 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSetPagesize(Pager *pPager, u32 *pPageSize, int nReserve){</span>
<span class='curline'><a href='../S/185.html#L44473'>pPager</a>           44473 libdb/sqlite3.c   if( (pPager-&gt;memDb==0 || pPager-&gt;dbSize==0)</span>
<span class='curline'><a href='../S/185.html#L44474'>pPager</a>           44474 libdb/sqlite3.c    &amp;&amp; sqlite3PcacheRefCount(pPager-&gt;pPCache)==0 </span>
<span class='curline'><a href='../S/185.html#L44475'>pPager</a>           44475 libdb/sqlite3.c    &amp;&amp; pageSize &amp;&amp; pageSize!=(u32)pPager-&gt;pageSize </span>
<span class='curline'><a href='../S/185.html#L44480'>pPager</a>           44480 libdb/sqlite3.c     if( pPager-&gt;eState&gt;PAGER_OPEN &amp;&amp; isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L44481'>pPager</a>           44481 libdb/sqlite3.c       rc = sqlite3OsFileSize(pPager-&gt;fd, &amp;nByte);</span>
<span class='curline'><a href='../S/185.html#L44489'>pPager</a>           44489 libdb/sqlite3.c       pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L44490'>pPager</a>           44490 libdb/sqlite3.c       rc = sqlite3PcacheSetPageSize(pPager-&gt;pPCache, pageSize);</span>
<span class='curline'><a href='../S/185.html#L44493'>pPager</a>           44493 libdb/sqlite3.c       sqlite3PageFree(pPager-&gt;pTmpSpace);</span>
<span class='curline'><a href='../S/185.html#L44494'>pPager</a>           44494 libdb/sqlite3.c       pPager-&gt;pTmpSpace = pNew;</span>
<span class='curline'><a href='../S/185.html#L44495'>pPager</a>           44495 libdb/sqlite3.c       pPager-&gt;dbSize = (Pgno)((nByte+pageSize-1)/pageSize);</span>
<span class='curline'><a href='../S/185.html#L44496'>pPager</a>           44496 libdb/sqlite3.c       pPager-&gt;pageSize = pageSize;</span>
<span class='curline'><a href='../S/185.html#L44502'>pPager</a>           44502 libdb/sqlite3.c   *pPageSize = pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L44504'>pPager</a>           44504 libdb/sqlite3.c     if( nReserve&lt;0 ) nReserve = pPager-&gt;nReserve;</span>
<span class='curline'><a href='../S/185.html#L44506'>pPager</a>           44506 libdb/sqlite3.c     pPager-&gt;nReserve = (i16)nReserve;</span>
<span class='curline'><a href='../S/185.html#L44507'>pPager</a>           44507 libdb/sqlite3.c     pagerReportSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L44508'>pPager</a>           44508 libdb/sqlite3.c     pagerFixMaplimit(pPager);</span>
<span class='curline'><a href='../S/185.html#L44521'>pPager</a>           44521 libdb/sqlite3.c SQLITE_PRIVATE void *sqlite3PagerTempSpace(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44522'>pPager</a>           44522 libdb/sqlite3.c   return pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L44532'>pPager</a>           44532 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerMaxPageCount(Pager *pPager, int mxPage){</span>
<span class='curline'><a href='../S/185.html#L44534'>pPager</a>           44534 libdb/sqlite3.c     pPager-&gt;mxPgno = mxPage;</span>
<span class='curline'><a href='../S/185.html#L44536'>pPager</a>           44536 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_OPEN );      /* Called only by OP_MaxPgcnt */</span>
<span class='curline'><a href='../S/185.html#L44537'>pPager</a>           44537 libdb/sqlite3.c   assert( pPager-&gt;mxPgno&gt;=pPager-&gt;dbSize );  /* OP_MaxPgcnt enforces this */</span>
<span class='curline'><a href='../S/185.html#L44538'>pPager</a>           44538 libdb/sqlite3.c   return pPager-&gt;mxPgno;</span>
<span class='curline'><a href='../S/185.html#L44579'>pPager</a>           44579 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerReadFileheader(Pager *pPager, int N, unsigned char *pDest){</span>
<span class='curline'><a href='../S/185.html#L44582'>pPager</a>           44582 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) || pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L44588'>pPager</a>           44588 libdb/sqlite3.c   assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L44590'>pPager</a>           44590 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L44591'>pPager</a>           44591 libdb/sqlite3.c     IOTRACE(("DBHDR %p 0 %d\n", pPager, N))</span>
<span class='curline'><a href='../S/185.html#L44592'>pPager</a>           44592 libdb/sqlite3.c     rc = sqlite3OsRead(pPager-&gt;fd, pDest, N, 0);</span>
<span class='curline'><a href='../S/185.html#L44607'>pPager</a>           44607 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerPagecount(Pager *pPager, int *pnPage){</span>
<span class='curline'><a href='../S/185.html#L44608'>pPager</a>           44608 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L44609'>pPager</a>           44609 libdb/sqlite3.c   assert( pPager-&gt;eState!=PAGER_WRITER_FINISHED );</span>
<span class='curline'><a href='../S/185.html#L44610'>pPager</a>           44610 libdb/sqlite3.c   *pnPage = (int)pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L44628'>pPager</a>           44628 libdb/sqlite3.c static int pager_wait_on_lock(Pager *pPager, int locktype){</span>
<span class='curline'><a href='../S/185.html#L44636'>pPager</a>           44636 libdb/sqlite3.c   assert( (pPager-&gt;eLock&gt;=locktype)</span>
<span class='curline'><a href='../S/185.html#L44637'>pPager</a>           44637 libdb/sqlite3.c        || (pPager-&gt;eLock==NO_LOCK &amp;&amp; locktype==SHARED_LOCK)</span>
<span class='curline'><a href='../S/185.html#L44638'>pPager</a>           44638 libdb/sqlite3.c        || (pPager-&gt;eLock==RESERVED_LOCK &amp;&amp; locktype==EXCLUSIVE_LOCK)</span>
<span class='curline'><a href='../S/185.html#L44642'>pPager</a>           44642 libdb/sqlite3.c     rc = pagerLockDb(pPager, locktype);</span>
<span class='curline'><a href='../S/185.html#L44643'>pPager</a>           44643 libdb/sqlite3.c   }while( rc==SQLITE_BUSY &amp;&amp; pPager-&gt;xBusyHandler(pPager-&gt;pBusyHandlerArg) );</span>
<span class='curline'><a href='../S/185.html#L44672'>pPager</a>           44672 libdb/sqlite3.c   assert( !subjRequiresPage(pPg) || pPg-&gt;pgno&lt;=pPg-&gt;pPager-&gt;dbSize );</span>
<span class='curline'><a href='../S/185.html#L44674'>pPager</a>           44674 libdb/sqlite3.c static void assertTruncateConstraint(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44675'>pPager</a>           44675 libdb/sqlite3.c   sqlite3PcacheIterateDirty(pPager-&gt;pPCache, assertTruncateConstraintCb);</span>
<span class='curline'><a href='../S/185.html#L44678'>pPager</a>           44678 libdb/sqlite3.c # define assertTruncateConstraint(pPager)</span>
<span class='curline'><a href='../S/185.html#L44692'>pPager</a>           44692 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerTruncateImage(Pager *pPager, Pgno nPage){</span>
<span class='curline'><a href='../S/185.html#L44693'>pPager</a>           44693 libdb/sqlite3.c   assert( pPager-&gt;dbSize&gt;=nPage );</span>
<span class='curline'><a href='../S/185.html#L44694'>pPager</a>           44694 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_CACHEMOD );</span>
<span class='curline'><a href='../S/185.html#L44695'>pPager</a>           44695 libdb/sqlite3.c   pPager-&gt;dbSize = nPage;</span>
<span class='curline'><a href='../S/185.html#L44723'>pPager</a>           44723 libdb/sqlite3.c static int pagerSyncHotJournal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44725'>pPager</a>           44725 libdb/sqlite3.c   if( !pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L44726'>pPager</a>           44726 libdb/sqlite3.c     rc = sqlite3OsSync(pPager-&gt;jfd, SQLITE_SYNC_NORMAL);</span>
<span class='curline'><a href='../S/185.html#L44729'>pPager</a>           44729 libdb/sqlite3.c     rc = sqlite3OsFileSize(pPager-&gt;jfd, &amp;pPager-&gt;journalHdr);</span>
<span class='curline'><a href='../S/185.html#L44745'>pPager</a>           44745 libdb/sqlite3.c   Pager *pPager,                  /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L44752'>pPager</a>           44752 libdb/sqlite3.c   if( pPager-&gt;pMmapFreelist ){</span>
<span class='curline'><a href='../S/185.html#L44753'>pPager</a>           44753 libdb/sqlite3.c     *ppPage = p = pPager-&gt;pMmapFreelist;</span>
<span class='curline'><a href='../S/185.html#L44754'>pPager</a>           44754 libdb/sqlite3.c     pPager-&gt;pMmapFreelist = p-&gt;pDirty;</span>
<span class='curline'><a href='../S/185.html#L44756'>pPager</a>           44756 libdb/sqlite3.c     memset(p-&gt;pExtra, 0, pPager-&gt;nExtra);</span>
<span class='curline'><a href='../S/185.html#L44758'>pPager</a>           44758 libdb/sqlite3.c     *ppPage = p = (PgHdr *)sqlite3MallocZero(sizeof(PgHdr) + pPager-&gt;nExtra);</span>
<span class='curline'><a href='../S/185.html#L44760'>pPager</a>           44760 libdb/sqlite3.c       sqlite3OsUnfetch(pPager-&gt;fd, (i64)(pgno-1) * pPager-&gt;pageSize, pData);</span>
<span class='curline'><a href='../S/185.html#L44766'>pPager</a>           44766 libdb/sqlite3.c     p-&gt;pPager = pPager;</span>
<span class='curline'><a href='../S/185.html#L44772'>pPager</a>           44772 libdb/sqlite3.c   assert( p-&gt;pPager==pPager );</span>
<span class='curline'><a href='../S/185.html#L44777'>pPager</a>           44777 libdb/sqlite3.c   pPager-&gt;nMmapOut++;</span>
<span class='curline'><a href='../S/185.html#L44787'>pPager</a>           44787 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L44788'>pPager</a>           44788 libdb/sqlite3.c   pPager-&gt;nMmapOut--;</span>
<span class='curline'><a href='../S/185.html#L44789'>pPager</a>           44789 libdb/sqlite3.c   pPg-&gt;pDirty = pPager-&gt;pMmapFreelist;</span>
<span class='curline'><a href='../S/185.html#L44790'>pPager</a>           44790 libdb/sqlite3.c   pPager-&gt;pMmapFreelist = pPg;</span>
<span class='curline'><a href='../S/185.html#L44792'>pPager</a>           44792 libdb/sqlite3.c   assert( pPager-&gt;fd-&gt;pMethods-&gt;iVersion&gt;=3 );</span>
<span class='curline'><a href='../S/185.html#L44793'>pPager</a>           44793 libdb/sqlite3.c   sqlite3OsUnfetch(pPager-&gt;fd, (i64)(pPg-&gt;pgno-1)*pPager-&gt;pageSize, pPg-&gt;pData);</span>
<span class='curline'><a href='../S/185.html#L44799'>pPager</a>           44799 libdb/sqlite3.c static void pagerFreeMapHdrs(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44802'>pPager</a>           44802 libdb/sqlite3.c   for(p=pPager-&gt;pMmapFreelist; p; p=pNext){</span>
<span class='curline'><a href='../S/185.html#L44823'>pPager</a>           44823 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerClose(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L44824'>pPager</a>           44824 libdb/sqlite3.c   u8 *pTmp = (u8 *)pPager-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L44826'>pPager</a>           44826 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L44829'>pPager</a>           44829 libdb/sqlite3.c   pagerFreeMapHdrs(pPager);</span>
<span class='curline'><a href='../S/185.html#L44831'>pPager</a>           44831 libdb/sqlite3.c   pPager-&gt;exclusiveMode = 0;</span>
<span class='curline'><a href='../S/185.html#L44833'>pPager</a>           44833 libdb/sqlite3.c   sqlite3WalClose(pPager-&gt;pWal, pPager-&gt;ckptSyncFlags, pPager-&gt;pageSize, pTmp);</span>
<span class='curline'><a href='../S/185.html#L44834'>pPager</a>           44834 libdb/sqlite3.c   pPager-&gt;pWal = 0;</span>
<span class='curline'><a href='../S/185.html#L44836'>pPager</a>           44836 libdb/sqlite3.c   pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L44838'>pPager</a>           44838 libdb/sqlite3.c     pager_unlock(pPager);</span>
<span class='curline'><a href='../S/185.html#L44851'>pPager</a>           44851 libdb/sqlite3.c     if( isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L44852'>pPager</a>           44852 libdb/sqlite3.c       pager_error(pPager, pagerSyncHotJournal(pPager));</span>
<span class='curline'><a href='../S/185.html#L44854'>pPager</a>           44854 libdb/sqlite3.c     pagerUnlockAndRollback(pPager);</span>
<span class='curline'><a href='../S/185.html#L44858'>pPager</a>           44858 libdb/sqlite3.c   PAGERTRACE(("CLOSE %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L44859'>pPager</a>           44859 libdb/sqlite3.c   IOTRACE(("CLOSE %p\n", pPager))</span>
<span class='curline'><a href='../S/185.html#L44860'>pPager</a>           44860 libdb/sqlite3.c   sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L44861'>pPager</a>           44861 libdb/sqlite3.c   sqlite3OsClose(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L44863'>pPager</a>           44863 libdb/sqlite3.c   sqlite3PcacheClose(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L44866'>pPager</a>           44866 libdb/sqlite3.c   if( pPager-&gt;xCodecFree ) pPager-&gt;xCodecFree(pPager-&gt;pCodec);</span>
<span class='curline'><a href='../S/185.html#L44869'>pPager</a>           44869 libdb/sqlite3.c   assert( !pPager-&gt;aSavepoint &amp;&amp; !pPager-&gt;pInJournal );</span>
<span class='curline'><a href='../S/185.html#L44870'>pPager</a>           44870 libdb/sqlite3.c   assert( !isOpen(pPager-&gt;jfd) &amp;&amp; !isOpen(pPager-&gt;sjfd) );</span>
<span class='curline'><a href='../S/185.html#L44872'>pPager</a>           44872 libdb/sqlite3.c   sqlite3_free(pPager);</span>
<span class='curline'><a href='../S/185.html#L44927'>pPager</a>           44927 libdb/sqlite3.c static int syncJournal(Pager *pPager, int newHdr){</span>
<span class='curline'><a href='../S/185.html#L44930'>pPager</a>           44930 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L44931'>pPager</a>           44931 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD</span>
<span class='curline'><a href='../S/185.html#L44933'>pPager</a>           44933 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L44934'>pPager</a>           44934 libdb/sqlite3.c   assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L44936'>pPager</a>           44936 libdb/sqlite3.c   rc = sqlite3PagerExclusiveLock(pPager);</span>
<span class='curline'><a href='../S/185.html#L44939'>pPager</a>           44939 libdb/sqlite3.c   if( !pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L44940'>pPager</a>           44940 libdb/sqlite3.c     assert( !pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L44941'>pPager</a>           44941 libdb/sqlite3.c     if( isOpen(pPager-&gt;jfd) &amp;&amp; pPager-&gt;journalMode!=PAGER_JOURNALMODE_MEMORY ){</span>
<span class='curline'><a href='../S/185.html#L44942'>pPager</a>           44942 libdb/sqlite3.c       const int iDc = sqlite3OsDeviceCharacteristics(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L44943'>pPager</a>           44943 libdb/sqlite3.c       assert( isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L44973'>pPager</a>           44973 libdb/sqlite3.c         put32bits(&amp;zHeader[sizeof(aJournalMagic)], pPager-&gt;nRec);</span>
<span class='curline'><a href='../S/185.html#L44975'>pPager</a>           44975 libdb/sqlite3.c         iNextHdrOffset = journalHdrOffset(pPager);</span>
<span class='curline'><a href='../S/185.html#L44976'>pPager</a>           44976 libdb/sqlite3.c         rc = sqlite3OsRead(pPager-&gt;jfd, aMagic, 8, iNextHdrOffset);</span>
<span class='curline'><a href='../S/185.html#L44979'>pPager</a>           44979 libdb/sqlite3.c           rc = sqlite3OsWrite(pPager-&gt;jfd, &amp;zerobyte, 1, iNextHdrOffset);</span>
<span class='curline'><a href='../S/185.html#L44996'>pPager</a>           44996 libdb/sqlite3.c         if( pPager-&gt;fullSync &amp;&amp; 0==(iDc&amp;SQLITE_IOCAP_SEQUENTIAL) ){</span>
<span class='curline'><a href='../S/185.html#L44997'>pPager</a>           44997 libdb/sqlite3.c           PAGERTRACE(("SYNC journal of %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L44998'>pPager</a>           44998 libdb/sqlite3.c           IOTRACE(("JSYNC %p\n", pPager))</span>
<span class='curline'><a href='../S/185.html#L44999'>pPager</a>           44999 libdb/sqlite3.c           rc = sqlite3OsSync(pPager-&gt;jfd, pPager-&gt;syncFlags);</span>
<span class='curline'><a href='../S/185.html#L45002'>pPager</a>           45002 libdb/sqlite3.c         IOTRACE(("JHDR %p %lld\n", pPager, pPager-&gt;journalHdr));</span>
<span class='curline'><a href='../S/185.html#L45004'>pPager</a>           45004 libdb/sqlite3.c             pPager-&gt;jfd, zHeader, sizeof(zHeader), pPager-&gt;journalHdr</span>
<span class='curline'><a href='../S/185.html#L45009'>pPager</a>           45009 libdb/sqlite3.c         PAGERTRACE(("SYNC journal of %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L45010'>pPager</a>           45010 libdb/sqlite3.c         IOTRACE(("JSYNC %p\n", pPager))</span>
<span class='curline'><a href='../S/185.html#L45011'>pPager</a>           45011 libdb/sqlite3.c         rc = sqlite3OsSync(pPager-&gt;jfd, pPager-&gt;syncFlags| </span>
<span class='curline'><a href='../S/185.html#L45012'>pPager</a>           45012 libdb/sqlite3.c           (pPager-&gt;syncFlags==SQLITE_SYNC_FULL?SQLITE_SYNC_DATAONLY:0)</span>
<span class='curline'><a href='../S/185.html#L45017'>pPager</a>           45017 libdb/sqlite3.c       pPager-&gt;journalHdr = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L45019'>pPager</a>           45019 libdb/sqlite3.c         pPager-&gt;nRec = 0;</span>
<span class='curline'><a href='../S/185.html#L45020'>pPager</a>           45020 libdb/sqlite3.c         rc = writeJournalHdr(pPager);</span>
<span class='curline'><a href='../S/185.html#L45024'>pPager</a>           45024 libdb/sqlite3.c       pPager-&gt;journalHdr = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L45032'>pPager</a>           45032 libdb/sqlite3.c   sqlite3PcacheClearSyncFlags(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L45033'>pPager</a>           45033 libdb/sqlite3.c   pPager-&gt;eState = PAGER_WRITER_DBMOD;</span>
<span class='curline'><a href='../S/185.html#L45034'>pPager</a>           45034 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L45070'>pPager</a>           45070 libdb/sqlite3.c static int pager_write_pagelist(Pager *pPager, PgHdr *pList){</span>
<span class='curline'><a href='../S/185.html#L45074'>pPager</a>           45074 libdb/sqlite3.c   assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L45075'>pPager</a>           45075 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_DBMOD );</span>
<span class='curline'><a href='../S/185.html#L45076'>pPager</a>           45076 libdb/sqlite3.c   assert( pPager-&gt;eLock==EXCLUSIVE_LOCK );</span>
<span class='curline'><a href='../S/185.html#L45082'>pPager</a>           45082 libdb/sqlite3.c   if( !isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L45083'>pPager</a>           45083 libdb/sqlite3.c     assert( pPager-&gt;tempFile &amp;&amp; rc==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L45084'>pPager</a>           45084 libdb/sqlite3.c     rc = pagerOpentemp(pPager, pPager-&gt;fd, pPager-&gt;vfsFlags);</span>
<span class='curline'><a href='../S/185.html#L45090'>pPager</a>           45090 libdb/sqlite3.c   assert( rc!=SQLITE_OK || isOpen(pPager-&gt;fd) );</span>
<span class='curline'><a href='../S/185.html#L45092'>pPager</a>           45092 libdb/sqlite3.c    &amp;&amp; pPager-&gt;dbHintSize&lt;pPager-&gt;dbSize</span>
<span class='curline'><a href='../S/185.html#L45093'>pPager</a>           45093 libdb/sqlite3.c    &amp;&amp; (pList-&gt;pDirty || pList-&gt;pgno&gt;pPager-&gt;dbHintSize)</span>
<span class='curline'><a href='../S/185.html#L45095'>pPager</a>           45095 libdb/sqlite3.c     sqlite3_int64 szFile = pPager-&gt;pageSize * (sqlite3_int64)pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L45096'>pPager</a>           45096 libdb/sqlite3.c     sqlite3OsFileControlHint(pPager-&gt;fd, SQLITE_FCNTL_SIZE_HINT, &amp;szFile);</span>
<span class='curline'><a href='../S/185.html#L45097'>pPager</a>           45097 libdb/sqlite3.c     pPager-&gt;dbHintSize = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L45111'>pPager</a>           45111 libdb/sqlite3.c     if( pgno&lt;=pPager-&gt;dbSize &amp;&amp; 0==(pList-&gt;flags&amp;PGHDR_DONT_WRITE) ){</span>
<span class='curline'><a href='../S/185.html#L45112'>pPager</a>           45112 libdb/sqlite3.c       i64 offset = (pgno-1)*(i64)pPager-&gt;pageSize;   /* Offset to write */</span>
<span class='curline'><a href='../S/185.html#L45119'>pPager</a>           45119 libdb/sqlite3.c       CODEC2(pPager, pList-&gt;pData, pgno, 6, return SQLITE_NOMEM, pData);</span>
<span class='curline'><a href='../S/185.html#L45122'>pPager</a>           45122 libdb/sqlite3.c       rc = sqlite3OsWrite(pPager-&gt;fd, pData, pPager-&gt;pageSize, offset);</span>
<span class='curline'><a href='../S/185.html#L45129'>pPager</a>           45129 libdb/sqlite3.c         memcpy(&amp;pPager-&gt;dbFileVers, &amp;pData[24], sizeof(pPager-&gt;dbFileVers));</span>
<span class='curline'><a href='../S/185.html#L45131'>pPager</a>           45131 libdb/sqlite3.c       if( pgno&gt;pPager-&gt;dbFileSize ){</span>
<span class='curline'><a href='../S/185.html#L45132'>pPager</a>           45132 libdb/sqlite3.c         pPager-&gt;dbFileSize = pgno;</span>
<span class='curline'><a href='../S/185.html#L45134'>pPager</a>           45134 libdb/sqlite3.c       pPager-&gt;aStat[PAGER_STAT_WRITE]++;</span>
<span class='curline'><a href='../S/185.html#L45137'>pPager</a>           45137 libdb/sqlite3.c       sqlite3BackupUpdate(pPager-&gt;pBackup, pgno, (u8*)pList-&gt;pData);</span>
<span class='curline'><a href='../S/185.html#L45140'>pPager</a>           45140 libdb/sqlite3.c                    PAGERID(pPager), pgno, pager_pagehash(pList)));</span>
<span class='curline'><a href='../S/185.html#L45141'>pPager</a>           45141 libdb/sqlite3.c       IOTRACE(("PGOUT %p %d\n", pPager, pgno));</span>
<span class='curline'><a href='../S/185.html#L45144'>pPager</a>           45144 libdb/sqlite3.c       PAGERTRACE(("NOSTORE %d page %d\n", PAGERID(pPager), pgno));</span>
<span class='curline'><a href='../S/185.html#L45161'>pPager</a>           45161 libdb/sqlite3.c static int openSubJournal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L45163'>pPager</a>           45163 libdb/sqlite3.c   if( !isOpen(pPager-&gt;sjfd) ){</span>
<span class='curline'><a href='../S/185.html#L45164'>pPager</a>           45164 libdb/sqlite3.c     if( pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY || pPager-&gt;subjInMemory ){</span>
<span class='curline'><a href='../S/185.html#L45165'>pPager</a>           45165 libdb/sqlite3.c       sqlite3MemJournalOpen(pPager-&gt;sjfd);</span>
<span class='curline'><a href='../S/185.html#L45167'>pPager</a>           45167 libdb/sqlite3.c       rc = pagerOpentemp(pPager, pPager-&gt;sjfd, SQLITE_OPEN_SUBJOURNAL);</span>
<span class='curline'><a href='../S/185.html#L45188'>pPager</a>           45188 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L45189'>pPager</a>           45189 libdb/sqlite3.c   if( pPager-&gt;journalMode!=PAGER_JOURNALMODE_OFF ){</span>
<span class='curline'><a href='../S/185.html#L45192'>pPager</a>           45192 libdb/sqlite3.c     assert( pPager-&gt;useJournal );</span>
<span class='curline'><a href='../S/185.html#L45193'>pPager</a>           45193 libdb/sqlite3.c     assert( isOpen(pPager-&gt;jfd) || pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L45194'>pPager</a>           45194 libdb/sqlite3.c     assert( isOpen(pPager-&gt;sjfd) || pPager-&gt;nSubRec==0 );</span>
<span class='curline'><a href='../S/185.html#L45195'>pPager</a>           45195 libdb/sqlite3.c     assert( pagerUseWal(pPager) </span>
<span class='curline'><a href='../S/185.html#L45196'>pPager</a>           45196 libdb/sqlite3.c          || pageInJournal(pPager, pPg) </span>
<span class='curline'><a href='../S/185.html#L45197'>pPager</a>           45197 libdb/sqlite3.c          || pPg-&gt;pgno&gt;pPager-&gt;dbOrigSize </span>
<span class='curline'><a href='../S/185.html#L45199'>pPager</a>           45199 libdb/sqlite3.c     rc = openSubJournal(pPager);</span>
<span class='curline'><a href='../S/185.html#L45205'>pPager</a>           45205 libdb/sqlite3.c       i64 offset = (i64)pPager-&gt;nSubRec*(4+pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L45208'>pPager</a>           45208 libdb/sqlite3.c       CODEC2(pPager, pData, pPg-&gt;pgno, 7, return SQLITE_NOMEM, pData2);</span>
<span class='curline'><a href='../S/185.html#L45209'>pPager</a>           45209 libdb/sqlite3.c       PAGERTRACE(("STMT-JOURNAL %d page %d\n", PAGERID(pPager), pPg-&gt;pgno));</span>
<span class='curline'><a href='../S/185.html#L45210'>pPager</a>           45210 libdb/sqlite3.c       rc = write32bits(pPager-&gt;sjfd, offset, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L45212'>pPager</a>           45212 libdb/sqlite3.c         rc = sqlite3OsWrite(pPager-&gt;sjfd, pData2, pPager-&gt;pageSize, offset+4);</span>
<span class='curline'><a href='../S/185.html#L45217'>pPager</a>           45217 libdb/sqlite3.c     pPager-&gt;nSubRec++;</span>
<span class='curline'><a href='../S/185.html#L45218'>pPager</a>           45218 libdb/sqlite3.c     assert( pPager-&gt;nSavepoint&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L45219'>pPager</a>           45219 libdb/sqlite3.c     rc = addToSavepointBitvecs(pPager, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L45244'>pPager</a>           45244 libdb/sqlite3.c   Pager *pPager = (Pager *)p;</span>
<span class='curline'><a href='../S/185.html#L45247'>pPager</a>           45247 libdb/sqlite3.c   assert( pPg-&gt;pPager==pPager );</span>
<span class='curline'><a href='../S/185.html#L45266'>pPager</a>           45266 libdb/sqlite3.c   if( NEVER(pPager-&gt;errCode) ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L45267'>pPager</a>           45267 libdb/sqlite3.c   testcase( pPager-&gt;doNotSpill &amp; SPILLFLAG_ROLLBACK );</span>
<span class='curline'><a href='../S/185.html#L45268'>pPager</a>           45268 libdb/sqlite3.c   testcase( pPager-&gt;doNotSpill &amp; SPILLFLAG_OFF );</span>
<span class='curline'><a href='../S/185.html#L45269'>pPager</a>           45269 libdb/sqlite3.c   testcase( pPager-&gt;doNotSpill &amp; SPILLFLAG_NOSYNC );</span>
<span class='curline'><a href='../S/185.html#L45270'>pPager</a>           45270 libdb/sqlite3.c   if( pPager-&gt;doNotSpill</span>
<span class='curline'><a href='../S/185.html#L45271'>pPager</a>           45271 libdb/sqlite3.c    &amp;&amp; ((pPager-&gt;doNotSpill &amp; (SPILLFLAG_ROLLBACK|SPILLFLAG_OFF))!=0</span>
<span class='curline'><a href='../S/185.html#L45278'>pPager</a>           45278 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L45284'>pPager</a>           45284 libdb/sqlite3.c       rc = pagerWalFrames(pPager, pPg, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L45290'>pPager</a>           45290 libdb/sqlite3.c      || pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L45292'>pPager</a>           45292 libdb/sqlite3.c       rc = syncJournal(pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L45323'>pPager</a>           45323 libdb/sqlite3.c         rc==SQLITE_OK &amp;&amp; pPg-&gt;pgno&gt;pPager-&gt;dbSize &amp;&amp; subjRequiresPage(pPg)</span>
<span class='curline'><a href='../S/185.html#L45331'>pPager</a>           45331 libdb/sqlite3.c       rc = pager_write_pagelist(pPager, pPg);</span>
<span class='curline'><a href='../S/185.html#L45337'>pPager</a>           45337 libdb/sqlite3.c     PAGERTRACE(("STRESS %d page %d\n", PAGERID(pPager), pPg-&gt;pgno));</span>
<span class='curline'><a href='../S/185.html#L45341'>pPager</a>           45341 libdb/sqlite3.c   return pager_error(pPager, rc); </span>
<span class='curline'><a href='../S/185.html#L45385'>pPager</a>           45385 libdb/sqlite3.c   Pager *pPager = 0;       /* Pager object to allocate and return */</span>
<span class='curline'><a href='../S/185.html#L45477'>pPager</a>           45477 libdb/sqlite3.c     ROUND8(sizeof(*pPager)) +      /* Pager structure */</span>
<span class='curline'><a href='../S/185.html#L45492'>pPager</a>           45492 libdb/sqlite3.c   pPager =              (Pager*)(pPtr);</span>
<span class='curline'><a href='../S/185.html#L45493'>pPager</a>           45493 libdb/sqlite3.c   pPager-&gt;pPCache =    (PCache*)(pPtr += ROUND8(sizeof(*pPager)));</span>
<span class='curline'><a href='../S/185.html#L45494'>pPager</a>           45494 libdb/sqlite3.c   pPager-&gt;fd =   (sqlite3_file*)(pPtr += ROUND8(pcacheSize));</span>
<span class='curline'><a href='../S/185.html#L45495'>pPager</a>           45495 libdb/sqlite3.c   pPager-&gt;sjfd = (sqlite3_file*)(pPtr += ROUND8(pVfs-&gt;szOsFile));</span>
<span class='curline'><a href='../S/185.html#L45496'>pPager</a>           45496 libdb/sqlite3.c   pPager-&gt;jfd =  (sqlite3_file*)(pPtr += journalFileSize);</span>
<span class='curline'><a href='../S/185.html#L45497'>pPager</a>           45497 libdb/sqlite3.c   pPager-&gt;zFilename =    (char*)(pPtr += journalFileSize);</span>
<span class='curline'><a href='../S/185.html#L45498'>pPager</a>           45498 libdb/sqlite3.c   assert( EIGHT_BYTE_ALIGNMENT(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L45503'>pPager</a>           45503 libdb/sqlite3.c     pPager-&gt;zJournal =   (char*)(pPtr += nPathname + 1 + nUri);</span>
<span class='curline'><a href='../S/185.html#L45504'>pPager</a>           45504 libdb/sqlite3.c     memcpy(pPager-&gt;zFilename, zPathname, nPathname);</span>
<span class='curline'><a href='../S/185.html#L45505'>pPager</a>           45505 libdb/sqlite3.c     if( nUri ) memcpy(&amp;pPager-&gt;zFilename[nPathname+1], zUri, nUri);</span>
<span class='curline'><a href='../S/185.html#L45506'>pPager</a>           45506 libdb/sqlite3.c     memcpy(pPager-&gt;zJournal, zPathname, nPathname);</span>
<span class='curline'><a href='../S/185.html#L45507'>pPager</a>           45507 libdb/sqlite3.c     memcpy(&amp;pPager-&gt;zJournal[nPathname], "-journal\000", 8+2);</span>
<span class='curline'><a href='../S/185.html#L45508'>pPager</a>           45508 libdb/sqlite3.c     sqlite3FileSuffix3(pPager-&gt;zFilename, pPager-&gt;zJournal);</span>
<span class='curline'><a href='../S/185.html#L45510'>pPager</a>           45510 libdb/sqlite3.c     pPager-&gt;zWal = &amp;pPager-&gt;zJournal[nPathname+8+1];</span>
<span class='curline'><a href='../S/185.html#L45511'>pPager</a>           45511 libdb/sqlite3.c     memcpy(pPager-&gt;zWal, zPathname, nPathname);</span>
<span class='curline'><a href='../S/185.html#L45512'>pPager</a>           45512 libdb/sqlite3.c     memcpy(&amp;pPager-&gt;zWal[nPathname], "-wal\000", 4+1);</span>
<span class='curline'><a href='../S/185.html#L45513'>pPager</a>           45513 libdb/sqlite3.c     sqlite3FileSuffix3(pPager-&gt;zFilename, pPager-&gt;zWal);</span>
<span class='curline'><a href='../S/185.html#L45517'>pPager</a>           45517 libdb/sqlite3.c   pPager-&gt;pVfs = pVfs;</span>
<span class='curline'><a href='../S/185.html#L45518'>pPager</a>           45518 libdb/sqlite3.c   pPager-&gt;vfsFlags = vfsFlags;</span>
<span class='curline'><a href='../S/185.html#L45524'>pPager</a>           45524 libdb/sqlite3.c     rc = sqlite3OsOpen(pVfs, pPager-&gt;zFilename, pPager-&gt;fd, vfsFlags, &amp;fout);</span>
<span class='curline'><a href='../S/185.html#L45537'>pPager</a>           45537 libdb/sqlite3.c       int iDc = sqlite3OsDeviceCharacteristics(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L45539'>pPager</a>           45539 libdb/sqlite3.c         setSectorSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L45541'>pPager</a>           45541 libdb/sqlite3.c         if( szPageDflt&lt;pPager-&gt;sectorSize ){</span>
<span class='curline'><a href='../S/185.html#L45542'>pPager</a>           45542 libdb/sqlite3.c           if( pPager-&gt;sectorSize&gt;SQLITE_MAX_DEFAULT_PAGE_SIZE ){</span>
<span class='curline'><a href='../S/185.html#L45545'>pPager</a>           45545 libdb/sqlite3.c             szPageDflt = (u32)pPager-&gt;sectorSize;</span>
<span class='curline'><a href='../S/185.html#L45562'>pPager</a>           45562 libdb/sqlite3.c       pPager-&gt;noLock = sqlite3_uri_boolean(zFilename, "nolock", 0);</span>
<span class='curline'><a href='../S/185.html#L45582'>pPager</a>           45582 libdb/sqlite3.c     pPager-&gt;eState = PAGER_READER;     /* Pretend we already have a lock */</span>
<span class='curline'><a href='../S/185.html#L45583'>pPager</a>           45583 libdb/sqlite3.c     pPager-&gt;eLock = EXCLUSIVE_LOCK;    /* Pretend we are in EXCLUSIVE locking mode */</span>
<span class='curline'><a href='../S/185.html#L45584'>pPager</a>           45584 libdb/sqlite3.c     pPager-&gt;noLock = 1;                /* Do no locking */</span>
<span class='curline'><a href='../S/185.html#L45592'>pPager</a>           45592 libdb/sqlite3.c     assert( pPager-&gt;memDb==0 );</span>
<span class='curline'><a href='../S/185.html#L45593'>pPager</a>           45593 libdb/sqlite3.c     rc = sqlite3PagerSetPagesize(pPager, &amp;szPageDflt, -1);</span>
<span class='curline'><a href='../S/185.html#L45602'>pPager</a>           45602 libdb/sqlite3.c                            !memDb?pagerStress:0, (void *)pPager, pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L45608'>pPager</a>           45608 libdb/sqlite3.c     sqlite3OsClose(pPager-&gt;fd);</span>
<span class='curline'><a href='../S/185.html#L45609'>pPager</a>           45609 libdb/sqlite3.c     sqlite3PageFree(pPager-&gt;pTmpSpace);</span>
<span class='curline'><a href='../S/185.html#L45610'>pPager</a>           45610 libdb/sqlite3.c     sqlite3_free(pPager);</span>
<span class='curline'><a href='../S/185.html#L45614'>pPager</a>           45614 libdb/sqlite3.c   PAGERTRACE(("OPEN %d %s\n", FILEHANDLEID(pPager-&gt;fd), pPager-&gt;zFilename));</span>
<span class='curline'><a href='../S/185.html#L45615'>pPager</a>           45615 libdb/sqlite3.c   IOTRACE(("OPEN %p %s\n", pPager, pPager-&gt;zFilename))</span>
<span class='curline'><a href='../S/185.html#L45617'>pPager</a>           45617 libdb/sqlite3.c   pPager-&gt;useJournal = (u8)useJournal;</span>
<span class='curline'><a href='../S/185.html#L45624'>pPager</a>           45624 libdb/sqlite3.c   pPager-&gt;mxPgno = SQLITE_MAX_PAGE_COUNT;</span>
<span class='curline'><a href='../S/185.html#L45627'>pPager</a>           45627 libdb/sqlite3.c   pPager-&gt;tempFile = (u8)tempFile;</span>
<span class='curline'><a href='../S/185.html#L45631'>pPager</a>           45631 libdb/sqlite3.c   pPager-&gt;exclusiveMode = (u8)tempFile; </span>
<span class='curline'><a href='../S/185.html#L45632'>pPager</a>           45632 libdb/sqlite3.c   pPager-&gt;changeCountDone = pPager-&gt;tempFile;</span>
<span class='curline'><a href='../S/185.html#L45633'>pPager</a>           45633 libdb/sqlite3.c   pPager-&gt;memDb = (u8)memDb;</span>
<span class='curline'><a href='../S/185.html#L45634'>pPager</a>           45634 libdb/sqlite3.c   pPager-&gt;readOnly = (u8)readOnly;</span>
<span class='curline'><a href='../S/185.html#L45635'>pPager</a>           45635 libdb/sqlite3.c   assert( useJournal || pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L45636'>pPager</a>           45636 libdb/sqlite3.c   pPager-&gt;noSync = pPager-&gt;tempFile;</span>
<span class='curline'><a href='../S/185.html#L45637'>pPager</a>           45637 libdb/sqlite3.c   if( pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L45638'>pPager</a>           45638 libdb/sqlite3.c     assert( pPager-&gt;fullSync==0 );</span>
<span class='curline'><a href='../S/185.html#L45639'>pPager</a>           45639 libdb/sqlite3.c     assert( pPager-&gt;syncFlags==0 );</span>
<span class='curline'><a href='../S/185.html#L45640'>pPager</a>           45640 libdb/sqlite3.c     assert( pPager-&gt;walSyncFlags==0 );</span>
<span class='curline'><a href='../S/185.html#L45641'>pPager</a>           45641 libdb/sqlite3.c     assert( pPager-&gt;ckptSyncFlags==0 );</span>
<span class='curline'><a href='../S/185.html#L45643'>pPager</a>           45643 libdb/sqlite3.c     pPager-&gt;fullSync = 1;</span>
<span class='curline'><a href='../S/185.html#L45644'>pPager</a>           45644 libdb/sqlite3.c     pPager-&gt;syncFlags = SQLITE_SYNC_NORMAL;</span>
<span class='curline'><a href='../S/185.html#L45645'>pPager</a>           45645 libdb/sqlite3.c     pPager-&gt;walSyncFlags = SQLITE_SYNC_NORMAL | WAL_SYNC_TRANSACTIONS;</span>
<span class='curline'><a href='../S/185.html#L45646'>pPager</a>           45646 libdb/sqlite3.c     pPager-&gt;ckptSyncFlags = SQLITE_SYNC_NORMAL;</span>
<span class='curline'><a href='../S/185.html#L45651'>pPager</a>           45651 libdb/sqlite3.c   pPager-&gt;nExtra = (u16)nExtra;</span>
<span class='curline'><a href='../S/185.html#L45652'>pPager</a>           45652 libdb/sqlite3.c   pPager-&gt;journalSizeLimit = SQLITE_DEFAULT_JOURNAL_SIZE_LIMIT;</span>
<span class='curline'><a href='../S/185.html#L45653'>pPager</a>           45653 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) || tempFile );</span>
<span class='curline'><a href='../S/185.html#L45654'>pPager</a>           45654 libdb/sqlite3.c   setSectorSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L45656'>pPager</a>           45656 libdb/sqlite3.c     pPager-&gt;journalMode = PAGER_JOURNALMODE_OFF;</span>
<span class='curline'><a href='../S/185.html#L45658'>pPager</a>           45658 libdb/sqlite3.c     pPager-&gt;journalMode = PAGER_JOURNALMODE_MEMORY;</span>
<span class='curline'><a href='../S/185.html#L45662'>pPager</a>           45662 libdb/sqlite3.c   pPager-&gt;xReiniter = xReinit;</span>
<span class='curline'><a href='../S/185.html#L45666'>pPager</a>           45666 libdb/sqlite3.c   *ppPager = pPager;</span>
<span class='curline'><a href='../S/185.html#L45676'>pPager</a>           45676 libdb/sqlite3.c static int databaseIsUnmoved(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L45680'>pPager</a>           45680 libdb/sqlite3.c   if( pPager-&gt;tempFile ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L45681'>pPager</a>           45681 libdb/sqlite3.c   if( pPager-&gt;dbSize==0 ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L45682'>pPager</a>           45682 libdb/sqlite3.c   assert( pPager-&gt;zFilename &amp;&amp; pPager-&gt;zFilename[0] );</span>
<span class='curline'><a href='../S/185.html#L45683'>pPager</a>           45683 libdb/sqlite3.c   rc = sqlite3OsFileControl(pPager-&gt;fd, SQLITE_FCNTL_HAS_MOVED, &amp;bHasMoved);</span>
<span class='curline'><a href='../S/185.html#L45727'>pPager</a>           45727 libdb/sqlite3.c static int hasHotJournal(Pager *pPager, int *pExists){</span>
<span class='curline'><a href='../S/185.html#L45728'>pPager</a>           45728 libdb/sqlite3.c   sqlite3_vfs * const pVfs = pPager-&gt;pVfs;</span>
<span class='curline'><a href='../S/185.html#L45731'>pPager</a>           45731 libdb/sqlite3.c   int jrnlOpen = !!isOpen(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L45733'>pPager</a>           45733 libdb/sqlite3.c   assert( pPager-&gt;useJournal );</span>
<span class='curline'><a href='../S/185.html#L45734'>pPager</a>           45734 libdb/sqlite3.c   assert( isOpen(pPager-&gt;fd) );</span>
<span class='curline'><a href='../S/185.html#L45735'>pPager</a>           45735 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN );</span>
<span class='curline'><a href='../S/185.html#L45737'>pPager</a>           45737 libdb/sqlite3.c   assert( jrnlOpen==0 || ( sqlite3OsDeviceCharacteristics(pPager-&gt;jfd) &amp;</span>
<span class='curline'><a href='../S/185.html#L45743'>pPager</a>           45743 libdb/sqlite3.c     rc = sqlite3OsAccess(pVfs, pPager-&gt;zJournal, SQLITE_ACCESS_EXISTS, &amp;exists);</span>
<span class='curline'><a href='../S/185.html#L45756'>pPager</a>           45756 libdb/sqlite3.c     rc = sqlite3OsCheckReservedLock(pPager-&gt;fd, &amp;locked);</span>
<span class='curline'><a href='../S/185.html#L45760'>pPager</a>           45760 libdb/sqlite3.c       rc = pagerPagecount(pPager, &amp;nPage);</span>
<span class='curline'><a href='../S/185.html#L45772'>pPager</a>           45772 libdb/sqlite3.c           if( pagerLockDb(pPager, RESERVED_LOCK)==SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L45773'>pPager</a>           45773 libdb/sqlite3.c             sqlite3OsDelete(pVfs, pPager-&gt;zJournal, 0);</span>
<span class='curline'><a href='../S/185.html#L45774'>pPager</a>           45774 libdb/sqlite3.c             if( !pPager-&gt;exclusiveMode ) pagerUnlockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L45786'>pPager</a>           45786 libdb/sqlite3.c             rc = sqlite3OsOpen(pVfs, pPager-&gt;zJournal, pPager-&gt;jfd, f, &amp;f);</span>
<span class='curline'><a href='../S/185.html#L45790'>pPager</a>           45790 libdb/sqlite3.c             rc = sqlite3OsRead(pPager-&gt;jfd, (void *)&amp;first, 1, 0);</span>
<span class='curline'><a href='../S/185.html#L45795'>pPager</a>           45795 libdb/sqlite3.c               sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L45846'>pPager</a>           45846 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSharedLock(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L45854'>pPager</a>           45854 libdb/sqlite3.c   assert( sqlite3PcacheRefCount(pPager-&gt;pPCache)==0 );</span>
<span class='curline'><a href='../S/185.html#L45855'>pPager</a>           45855 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L45856'>pPager</a>           45856 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN || pPager-&gt;eState==PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L45857'>pPager</a>           45857 libdb/sqlite3.c   if( NEVER(MEMDB &amp;&amp; pPager-&gt;errCode) ){ return pPager-&gt;errCode; }</span>
<span class='curline'><a href='../S/185.html#L45859'>pPager</a>           45859 libdb/sqlite3.c   if( !pagerUseWal(pPager) &amp;&amp; pPager-&gt;eState==PAGER_OPEN ){</span>
<span class='curline'><a href='../S/185.html#L45864'>pPager</a>           45864 libdb/sqlite3.c     rc = pager_wait_on_lock(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L45866'>pPager</a>           45866 libdb/sqlite3.c       assert( pPager-&gt;eLock==NO_LOCK || pPager-&gt;eLock==UNKNOWN_LOCK );</span>
<span class='curline'><a href='../S/185.html#L45873'>pPager</a>           45873 libdb/sqlite3.c     if( pPager-&gt;eLock&lt;=SHARED_LOCK ){</span>
<span class='curline'><a href='../S/185.html#L45874'>pPager</a>           45874 libdb/sqlite3.c       rc = hasHotJournal(pPager, &amp;bHotJournal);</span>
<span class='curline'><a href='../S/185.html#L45880'>pPager</a>           45880 libdb/sqlite3.c       if( pPager-&gt;readOnly ){</span>
<span class='curline'><a href='../S/185.html#L45900'>pPager</a>           45900 libdb/sqlite3.c       rc = pagerLockDb(pPager, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/185.html#L45918'>pPager</a>           45918 libdb/sqlite3.c       if( !isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L45919'>pPager</a>           45919 libdb/sqlite3.c         sqlite3_vfs * const pVfs = pPager-&gt;pVfs;</span>
<span class='curline'><a href='../S/185.html#L45922'>pPager</a>           45922 libdb/sqlite3.c             pVfs, pPager-&gt;zJournal, SQLITE_ACCESS_EXISTS, &amp;bExists);</span>
<span class='curline'><a href='../S/185.html#L45926'>pPager</a>           45926 libdb/sqlite3.c           assert( !pPager-&gt;tempFile );</span>
<span class='curline'><a href='../S/185.html#L45927'>pPager</a>           45927 libdb/sqlite3.c           rc = sqlite3OsOpen(pVfs, pPager-&gt;zJournal, pPager-&gt;jfd, f, &amp;fout);</span>
<span class='curline'><a href='../S/185.html#L45928'>pPager</a>           45928 libdb/sqlite3.c           assert( rc!=SQLITE_OK || isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L45931'>pPager</a>           45931 libdb/sqlite3.c             sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L45944'>pPager</a>           45944 libdb/sqlite3.c       if( isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L45946'>pPager</a>           45946 libdb/sqlite3.c         rc = pagerSyncHotJournal(pPager);</span>
<span class='curline'><a href='../S/185.html#L45948'>pPager</a>           45948 libdb/sqlite3.c           rc = pager_playback(pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L45949'>pPager</a>           45949 libdb/sqlite3.c           pPager-&gt;eState = PAGER_OPEN;</span>
<span class='curline'><a href='../S/185.html#L45951'>pPager</a>           45951 libdb/sqlite3.c       }else if( !pPager-&gt;exclusiveMode ){</span>
<span class='curline'><a href='../S/185.html#L45952'>pPager</a>           45952 libdb/sqlite3.c         pagerUnlockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L45972'>pPager</a>           45972 libdb/sqlite3.c         pager_error(pPager, rc);</span>
<span class='curline'><a href='../S/185.html#L45976'>pPager</a>           45976 libdb/sqlite3.c       assert( pPager-&gt;eState==PAGER_OPEN );</span>
<span class='curline'><a href='../S/185.html#L45977'>pPager</a>           45977 libdb/sqlite3.c       assert( (pPager-&gt;eLock==SHARED_LOCK)</span>
<span class='curline'><a href='../S/185.html#L45978'>pPager</a>           45978 libdb/sqlite3.c            || (pPager-&gt;exclusiveMode &amp;&amp; pPager-&gt;eLock&gt;SHARED_LOCK)</span>
<span class='curline'><a href='../S/185.html#L45982'>pPager</a>           45982 libdb/sqlite3.c     if( !pPager-&gt;tempFile &amp;&amp; (</span>
<span class='curline'><a href='../S/185.html#L45983'>pPager</a>           45983 libdb/sqlite3.c         pPager-&gt;pBackup </span>
<span class='curline'><a href='../S/185.html#L45984'>pPager</a>           45984 libdb/sqlite3.c      || sqlite3PcachePagecount(pPager-&gt;pPCache)&gt;0 </span>
<span class='curline'><a href='../S/185.html#L45985'>pPager</a>           45985 libdb/sqlite3.c      || USEFETCH(pPager)</span>
<span class='curline'><a href='../S/185.html#L46004'>pPager</a>           46004 libdb/sqlite3.c       char dbFileVers[sizeof(pPager-&gt;dbFileVers)];</span>
<span class='curline'><a href='../S/185.html#L46006'>pPager</a>           46006 libdb/sqlite3.c       rc = pagerPagecount(pPager, &amp;nPage);</span>
<span class='curline'><a href='../S/185.html#L46010'>pPager</a>           46010 libdb/sqlite3.c         IOTRACE(("CKVERS %p %d\n", pPager, sizeof(dbFileVers)));</span>
<span class='curline'><a href='../S/185.html#L46011'>pPager</a>           46011 libdb/sqlite3.c         rc = sqlite3OsRead(pPager-&gt;fd, &amp;dbFileVers, sizeof(dbFileVers), 24);</span>
<span class='curline'><a href='../S/185.html#L46019'>pPager</a>           46019 libdb/sqlite3.c       if( memcmp(pPager-&gt;dbFileVers, dbFileVers, sizeof(dbFileVers))!=0 ){</span>
<span class='curline'><a href='../S/185.html#L46020'>pPager</a>           46020 libdb/sqlite3.c         pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L46028'>pPager</a>           46028 libdb/sqlite3.c         if( USEFETCH(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46029'>pPager</a>           46029 libdb/sqlite3.c           sqlite3OsUnfetch(pPager-&gt;fd, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L46037'>pPager</a>           46037 libdb/sqlite3.c     rc = pagerOpenWalIfPresent(pPager);</span>
<span class='curline'><a href='../S/185.html#L46039'>pPager</a>           46039 libdb/sqlite3.c     assert( pPager-&gt;pWal==0 || rc==SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L46043'>pPager</a>           46043 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46045'>pPager</a>           46045 libdb/sqlite3.c     rc = pagerBeginReadTransaction(pPager);</span>
<span class='curline'><a href='../S/185.html#L46048'>pPager</a>           46048 libdb/sqlite3.c   if( pPager-&gt;eState==PAGER_OPEN &amp;&amp; rc==SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L46049'>pPager</a>           46049 libdb/sqlite3.c     rc = pagerPagecount(pPager, &amp;pPager-&gt;dbSize);</span>
<span class='curline'><a href='../S/185.html#L46055'>pPager</a>           46055 libdb/sqlite3.c     pager_unlock(pPager);</span>
<span class='curline'><a href='../S/185.html#L46056'>pPager</a>           46056 libdb/sqlite3.c     assert( pPager-&gt;eState==PAGER_OPEN );</span>
<span class='curline'><a href='../S/185.html#L46058'>pPager</a>           46058 libdb/sqlite3.c     pPager-&gt;eState = PAGER_READER;</span>
<span class='curline'><a href='../S/185.html#L46071'>pPager</a>           46071 libdb/sqlite3.c static void pagerUnlockIfUnused(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L46072'>pPager</a>           46072 libdb/sqlite3.c   if( pPager-&gt;nMmapOut==0 &amp;&amp; (sqlite3PcacheRefCount(pPager-&gt;pPCache)==0) ){</span>
<span class='curline'><a href='../S/185.html#L46073'>pPager</a>           46073 libdb/sqlite3.c     pagerUnlockAndRollback(pPager);</span>
<span class='curline'><a href='../S/185.html#L46128'>pPager</a>           46128 libdb/sqlite3.c   Pager *pPager,      /* The pager open on the database file */</span>
<span class='curline'><a href='../S/185.html#L46142'>pPager</a>           46142 libdb/sqlite3.c   const int bMmapOk = (pgno!=1 &amp;&amp; USEFETCH(pPager)</span>
<span class='curline'><a href='../S/185.html#L46143'>pPager</a>           46143 libdb/sqlite3.c    &amp;&amp; (pPager-&gt;eState==PAGER_READER || (flags &amp; PAGER_GET_READONLY))</span>
<span class='curline'><a href='../S/185.html#L46145'>pPager</a>           46145 libdb/sqlite3.c    &amp;&amp; pPager-&gt;xCodec==0</span>
<span class='curline'><a href='../S/185.html#L46149'>pPager</a>           46149 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L46150'>pPager</a>           46150 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46159'>pPager</a>           46159 libdb/sqlite3.c   if( pPager-&gt;errCode!=SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L46160'>pPager</a>           46160 libdb/sqlite3.c     rc = pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L46162'>pPager</a>           46162 libdb/sqlite3.c     if( bMmapOk &amp;&amp; pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46163'>pPager</a>           46163 libdb/sqlite3.c       rc = sqlite3WalFindFrame(pPager-&gt;pWal, pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/185.html#L46170'>pPager</a>           46170 libdb/sqlite3.c       rc = sqlite3OsFetch(pPager-&gt;fd, </span>
<span class='curline'><a href='../S/185.html#L46171'>pPager</a>           46171 libdb/sqlite3.c           (i64)(pgno-1) * pPager-&gt;pageSize, pPager-&gt;pageSize, &amp;pData</span>
<span class='curline'><a href='../S/185.html#L46175'>pPager</a>           46175 libdb/sqlite3.c         if( pPager-&gt;eState&gt;PAGER_READER ){</span>
<span class='curline'><a href='../S/185.html#L46176'>pPager</a>           46176 libdb/sqlite3.c           pPg = sqlite3PagerLookup(pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L46179'>pPager</a>           46179 libdb/sqlite3.c           rc = pagerAcquireMapPage(pPager, pgno, pData, &amp;pPg);</span>
<span class='curline'><a href='../S/185.html#L46181'>pPager</a>           46181 libdb/sqlite3.c           sqlite3OsUnfetch(pPager-&gt;fd, (i64)(pgno-1)*pPager-&gt;pageSize, pData);</span>
<span class='curline'><a href='../S/185.html#L46196'>pPager</a>           46196 libdb/sqlite3.c       pBase = sqlite3PcacheFetch(pPager-&gt;pPCache, pgno, 3);</span>
<span class='curline'><a href='../S/185.html#L46198'>pPager</a>           46198 libdb/sqlite3.c         rc = sqlite3PcacheFetchStress(pPager-&gt;pPCache, pgno, &amp;pBase);</span>
<span class='curline'><a href='../S/185.html#L46201'>pPager</a>           46201 libdb/sqlite3.c       pPg = *ppPage = sqlite3PcacheFetchFinish(pPager-&gt;pPCache, pgno, pBase);</span>
<span class='curline'><a href='../S/185.html#L46214'>pPager</a>           46214 libdb/sqlite3.c   assert( (*ppPage)-&gt;pPager==pPager || (*ppPage)-&gt;pPager==0 );</span>
<span class='curline'><a href='../S/185.html#L46216'>pPager</a>           46216 libdb/sqlite3.c   if( (*ppPage)-&gt;pPager &amp;&amp; !noContent ){</span>
<span class='curline'><a href='../S/185.html#L46219'>pPager</a>           46219 libdb/sqlite3.c     assert( pgno&lt;=PAGER_MAX_PGNO &amp;&amp; pgno!=PAGER_MJ_PGNO(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46220'>pPager</a>           46220 libdb/sqlite3.c     pPager-&gt;aStat[PAGER_STAT_HIT]++;</span>
<span class='curline'><a href='../S/185.html#L46228'>pPager</a>           46228 libdb/sqlite3.c     pPg-&gt;pPager = pPager;</span>
<span class='curline'><a href='../S/185.html#L46232'>pPager</a>           46232 libdb/sqlite3.c     if( pgno&gt;PAGER_MAX_PGNO || pgno==PAGER_MJ_PGNO(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46237'>pPager</a>           46237 libdb/sqlite3.c     if( MEMDB || pPager-&gt;dbSize&lt;pgno || noContent || !isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L46238'>pPager</a>           46238 libdb/sqlite3.c       if( pgno&gt;pPager-&gt;mxPgno ){</span>
<span class='curline'><a href='../S/185.html#L46250'>pPager</a>           46250 libdb/sqlite3.c         if( pgno&lt;=pPager-&gt;dbOrigSize ){</span>
<span class='curline'><a href='../S/185.html#L46251'>pPager</a>           46251 libdb/sqlite3.c           TESTONLY( rc = ) sqlite3BitvecSet(pPager-&gt;pInJournal, pgno);</span>
<span class='curline'><a href='../S/185.html#L46254'>pPager</a>           46254 libdb/sqlite3.c         TESTONLY( rc = ) addToSavepointBitvecs(pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L46258'>pPager</a>           46258 libdb/sqlite3.c       memset(pPg-&gt;pData, 0, pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L46259'>pPager</a>           46259 libdb/sqlite3.c       IOTRACE(("ZERO %p %d\n", pPager, pgno));</span>
<span class='curline'><a href='../S/185.html#L46261'>pPager</a>           46261 libdb/sqlite3.c       if( pagerUseWal(pPager) &amp;&amp; bMmapOk==0 ){</span>
<span class='curline'><a href='../S/185.html#L46262'>pPager</a>           46262 libdb/sqlite3.c         rc = sqlite3WalFindFrame(pPager-&gt;pWal, pgno, &amp;iFrame);</span>
<span class='curline'><a href='../S/185.html#L46265'>pPager</a>           46265 libdb/sqlite3.c       assert( pPg-&gt;pPager==pPager );</span>
<span class='curline'><a href='../S/185.html#L46266'>pPager</a>           46266 libdb/sqlite3.c       pPager-&gt;aStat[PAGER_STAT_MISS]++;</span>
<span class='curline'><a href='../S/185.html#L46282'>pPager</a>           46282 libdb/sqlite3.c   pagerUnlockIfUnused(pPager);</span>
<span class='curline'><a href='../S/185.html#L46299'>pPager</a>           46299 libdb/sqlite3.c SQLITE_PRIVATE DbPage *sqlite3PagerLookup(Pager *pPager, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L46301'>pPager</a>           46301 libdb/sqlite3.c   assert( pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L46303'>pPager</a>           46303 libdb/sqlite3.c   assert( pPager-&gt;pPCache!=0 );</span>
<span class='curline'><a href='../S/185.html#L46304'>pPager</a>           46304 libdb/sqlite3.c   pPage = sqlite3PcacheFetch(pPager-&gt;pPCache, pgno, 0);</span>
<span class='curline'><a href='../S/185.html#L46305'>pPager</a>           46305 libdb/sqlite3.c   return sqlite3PcacheFetchFinish(pPager-&gt;pPCache, pgno, pPage);</span>
<span class='curline'><a href='../S/185.html#L46317'>pPager</a>           46317 libdb/sqlite3.c   Pager *pPager;</span>
<span class='curline'><a href='../S/185.html#L46319'>pPager</a>           46319 libdb/sqlite3.c   pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L46325'>pPager</a>           46325 libdb/sqlite3.c   pagerUnlockIfUnused(pPager);</span>
<span class='curline'><a href='../S/185.html#L46353'>pPager</a>           46353 libdb/sqlite3.c static int pager_open_journal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L46355'>pPager</a>           46355 libdb/sqlite3.c   sqlite3_vfs * const pVfs = pPager-&gt;pVfs;   /* Local cache of vfs pointer */</span>
<span class='curline'><a href='../S/185.html#L46357'>pPager</a>           46357 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L46358'>pPager</a>           46358 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46359'>pPager</a>           46359 libdb/sqlite3.c   assert( pPager-&gt;pInJournal==0 );</span>
<span class='curline'><a href='../S/185.html#L46364'>pPager</a>           46364 libdb/sqlite3.c   if( NEVER(pPager-&gt;errCode) ) return pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L46366'>pPager</a>           46366 libdb/sqlite3.c   if( !pagerUseWal(pPager) &amp;&amp; pPager-&gt;journalMode!=PAGER_JOURNALMODE_OFF ){</span>
<span class='curline'><a href='../S/185.html#L46367'>pPager</a>           46367 libdb/sqlite3.c     pPager-&gt;pInJournal = sqlite3BitvecCreate(pPager-&gt;dbSize);</span>
<span class='curline'><a href='../S/185.html#L46368'>pPager</a>           46368 libdb/sqlite3.c     if( pPager-&gt;pInJournal==0 ){</span>
<span class='curline'><a href='../S/185.html#L46373'>pPager</a>           46373 libdb/sqlite3.c     if( !isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L46374'>pPager</a>           46374 libdb/sqlite3.c       if( pPager-&gt;journalMode==PAGER_JOURNALMODE_MEMORY ){</span>
<span class='curline'><a href='../S/185.html#L46375'>pPager</a>           46375 libdb/sqlite3.c         sqlite3MemJournalOpen(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L46379'>pPager</a>           46379 libdb/sqlite3.c           (pPager-&gt;tempFile ? </span>
<span class='curline'><a href='../S/185.html#L46386'>pPager</a>           46386 libdb/sqlite3.c         rc = databaseIsUnmoved(pPager);</span>
<span class='curline'><a href='../S/185.html#L46390'>pPager</a>           46390 libdb/sqlite3.c               pVfs, pPager-&gt;zJournal, pPager-&gt;jfd, flags, jrnlBufferSize(pPager)</span>
<span class='curline'><a href='../S/185.html#L46393'>pPager</a>           46393 libdb/sqlite3.c           rc = sqlite3OsOpen(pVfs, pPager-&gt;zJournal, pPager-&gt;jfd, flags, 0);</span>
<span class='curline'><a href='../S/185.html#L46397'>pPager</a>           46397 libdb/sqlite3.c       assert( rc!=SQLITE_OK || isOpen(pPager-&gt;jfd) );</span>
<span class='curline'><a href='../S/185.html#L46406'>pPager</a>           46406 libdb/sqlite3.c       pPager-&gt;nRec = 0;</span>
<span class='curline'><a href='../S/185.html#L46407'>pPager</a>           46407 libdb/sqlite3.c       pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L46408'>pPager</a>           46408 libdb/sqlite3.c       pPager-&gt;setMaster = 0;</span>
<span class='curline'><a href='../S/185.html#L46409'>pPager</a>           46409 libdb/sqlite3.c       pPager-&gt;journalHdr = 0;</span>
<span class='curline'><a href='../S/185.html#L46410'>pPager</a>           46410 libdb/sqlite3.c       rc = writeJournalHdr(pPager);</span>
<span class='curline'><a href='../S/185.html#L46415'>pPager</a>           46415 libdb/sqlite3.c     sqlite3BitvecDestroy(pPager-&gt;pInJournal);</span>
<span class='curline'><a href='../S/185.html#L46416'>pPager</a>           46416 libdb/sqlite3.c     pPager-&gt;pInJournal = 0;</span>
<span class='curline'><a href='../S/185.html#L46418'>pPager</a>           46418 libdb/sqlite3.c     assert( pPager-&gt;eState==PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L46419'>pPager</a>           46419 libdb/sqlite3.c     pPager-&gt;eState = PAGER_WRITER_CACHEMOD;</span>
<span class='curline'><a href='../S/185.html#L46442'>pPager</a>           46442 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerBegin(Pager *pPager, int exFlag, int subjInMemory){</span>
<span class='curline'><a href='../S/185.html#L46445'>pPager</a>           46445 libdb/sqlite3.c   if( pPager-&gt;errCode ) return pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L46446'>pPager</a>           46446 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_READER &amp;&amp; pPager-&gt;eState&lt;PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L46447'>pPager</a>           46447 libdb/sqlite3.c   pPager-&gt;subjInMemory = (u8)subjInMemory;</span>
<span class='curline'><a href='../S/185.html#L46449'>pPager</a>           46449 libdb/sqlite3.c   if( ALWAYS(pPager-&gt;eState==PAGER_READER) ){</span>
<span class='curline'><a href='../S/185.html#L46450'>pPager</a>           46450 libdb/sqlite3.c     assert( pPager-&gt;pInJournal==0 );</span>
<span class='curline'><a href='../S/185.html#L46452'>pPager</a>           46452 libdb/sqlite3.c     if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46456'>pPager</a>           46456 libdb/sqlite3.c       if( pPager-&gt;exclusiveMode &amp;&amp; sqlite3WalExclusiveMode(pPager-&gt;pWal, -1) ){</span>
<span class='curline'><a href='../S/185.html#L46457'>pPager</a>           46457 libdb/sqlite3.c         rc = pagerLockDb(pPager, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/185.html#L46461'>pPager</a>           46461 libdb/sqlite3.c         sqlite3WalExclusiveMode(pPager-&gt;pWal, 1);</span>
<span class='curline'><a href='../S/185.html#L46469'>pPager</a>           46469 libdb/sqlite3.c       rc = sqlite3WalBeginWriteTransaction(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L46476'>pPager</a>           46476 libdb/sqlite3.c       rc = pagerLockDb(pPager, RESERVED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L46478'>pPager</a>           46478 libdb/sqlite3.c         rc = pager_wait_on_lock(pPager, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/185.html#L46492'>pPager</a>           46492 libdb/sqlite3.c       pPager-&gt;eState = PAGER_WRITER_LOCKED;</span>
<span class='curline'><a href='../S/185.html#L46493'>pPager</a>           46493 libdb/sqlite3.c       pPager-&gt;dbHintSize = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L46494'>pPager</a>           46494 libdb/sqlite3.c       pPager-&gt;dbFileSize = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L46495'>pPager</a>           46495 libdb/sqlite3.c       pPager-&gt;dbOrigSize = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L46496'>pPager</a>           46496 libdb/sqlite3.c       pPager-&gt;journalOff = 0;</span>
<span class='curline'><a href='../S/185.html#L46499'>pPager</a>           46499 libdb/sqlite3.c     assert( rc==SQLITE_OK || pPager-&gt;eState==PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L46500'>pPager</a>           46500 libdb/sqlite3.c     assert( rc!=SQLITE_OK || pPager-&gt;eState==PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L46501'>pPager</a>           46501 libdb/sqlite3.c     assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46504'>pPager</a>           46504 libdb/sqlite3.c   PAGERTRACE(("TRANSACTION %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L46516'>pPager</a>           46516 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L46524'>pPager</a>           46524 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_LOCKED</span>
<span class='curline'><a href='../S/185.html#L46525'>pPager</a>           46525 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L46526'>pPager</a>           46526 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD</span>
<span class='curline'><a href='../S/185.html#L46528'>pPager</a>           46528 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46529'>pPager</a>           46529 libdb/sqlite3.c   assert( pPager-&gt;errCode==0 );</span>
<span class='curline'><a href='../S/185.html#L46530'>pPager</a>           46530 libdb/sqlite3.c   assert( pPager-&gt;readOnly==0 );</span>
<span class='curline'><a href='../S/185.html#L46543'>pPager</a>           46543 libdb/sqlite3.c   if( pPager-&gt;eState==PAGER_WRITER_LOCKED ){</span>
<span class='curline'><a href='../S/185.html#L46544'>pPager</a>           46544 libdb/sqlite3.c     rc = pager_open_journal(pPager);</span>
<span class='curline'><a href='../S/185.html#L46547'>pPager</a>           46547 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_CACHEMOD );</span>
<span class='curline'><a href='../S/185.html#L46548'>pPager</a>           46548 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46554'>pPager</a>           46554 libdb/sqlite3.c   inJournal = pageInJournal(pPager, pPg);</span>
<span class='curline'><a href='../S/185.html#L46555'>pPager</a>           46555 libdb/sqlite3.c   if( inJournal &amp;&amp; (pPager-&gt;nSavepoint==0 || !subjRequiresPage(pPg)) ){</span>
<span class='curline'><a href='../S/185.html#L46556'>pPager</a>           46556 libdb/sqlite3.c     assert( !pagerUseWal(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46563'>pPager</a>           46563 libdb/sqlite3.c     if( !inJournal &amp;&amp; !pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46564'>pPager</a>           46564 libdb/sqlite3.c       assert( pagerUseWal(pPager)==0 );</span>
<span class='curline'><a href='../S/185.html#L46565'>pPager</a>           46565 libdb/sqlite3.c       if( pPg-&gt;pgno&lt;=pPager-&gt;dbOrigSize &amp;&amp; isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L46568'>pPager</a>           46568 libdb/sqlite3.c         i64 iOff = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L46573'>pPager</a>           46573 libdb/sqlite3.c         assert( pPg-&gt;pgno!=PAGER_MJ_PGNO(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46575'>pPager</a>           46575 libdb/sqlite3.c         assert( pPager-&gt;journalHdr&lt;=pPager-&gt;journalOff );</span>
<span class='curline'><a href='../S/185.html#L46576'>pPager</a>           46576 libdb/sqlite3.c         CODEC2(pPager, pPg-&gt;pData, pPg-&gt;pgno, 7, return SQLITE_NOMEM, pData2);</span>
<span class='curline'><a href='../S/185.html#L46577'>pPager</a>           46577 libdb/sqlite3.c         cksum = pager_cksum(pPager, (u8*)pData2);</span>
<span class='curline'><a href='../S/185.html#L46588'>pPager</a>           46588 libdb/sqlite3.c         rc = write32bits(pPager-&gt;jfd, iOff, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L46590'>pPager</a>           46590 libdb/sqlite3.c         rc = sqlite3OsWrite(pPager-&gt;jfd, pData2, pPager-&gt;pageSize, iOff+4);</span>
<span class='curline'><a href='../S/185.html#L46592'>pPager</a>           46592 libdb/sqlite3.c         rc = write32bits(pPager-&gt;jfd, iOff+pPager-&gt;pageSize+4, cksum);</span>
<span class='curline'><a href='../S/185.html#L46595'>pPager</a>           46595 libdb/sqlite3.c         IOTRACE(("JOUT %p %d %lld %d\n", pPager, pPg-&gt;pgno, </span>
<span class='curline'><a href='../S/185.html#L46596'>pPager</a>           46596 libdb/sqlite3.c                  pPager-&gt;journalOff, pPager-&gt;pageSize));</span>
<span class='curline'><a href='../S/185.html#L46599'>pPager</a>           46599 libdb/sqlite3.c              PAGERID(pPager), pPg-&gt;pgno, </span>
<span class='curline'><a href='../S/185.html#L46602'>pPager</a>           46602 libdb/sqlite3.c         pPager-&gt;journalOff += 8 + pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L46603'>pPager</a>           46603 libdb/sqlite3.c         pPager-&gt;nRec++;</span>
<span class='curline'><a href='../S/185.html#L46604'>pPager</a>           46604 libdb/sqlite3.c         assert( pPager-&gt;pInJournal!=0 );</span>
<span class='curline'><a href='../S/185.html#L46605'>pPager</a>           46605 libdb/sqlite3.c         rc = sqlite3BitvecSet(pPager-&gt;pInJournal, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L46608'>pPager</a>           46608 libdb/sqlite3.c         rc |= addToSavepointBitvecs(pPager, pPg-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L46614'>pPager</a>           46614 libdb/sqlite3.c         if( pPager-&gt;eState!=PAGER_WRITER_DBMOD ){</span>
<span class='curline'><a href='../S/185.html#L46618'>pPager</a>           46618 libdb/sqlite3.c                 PAGERID(pPager), pPg-&gt;pgno,</span>
<span class='curline'><a href='../S/185.html#L46628'>pPager</a>           46628 libdb/sqlite3.c     if( pPager-&gt;nSavepoint&gt;0 &amp;&amp; subjRequiresPage(pPg) ){</span>
<span class='curline'><a href='../S/185.html#L46635'>pPager</a>           46635 libdb/sqlite3.c   if( pPager-&gt;dbSize&lt;pPg-&gt;pgno ){</span>
<span class='curline'><a href='../S/185.html#L46636'>pPager</a>           46636 libdb/sqlite3.c     pPager-&gt;dbSize = pPg-&gt;pgno;</span>
<span class='curline'><a href='../S/185.html#L46659'>pPager</a>           46659 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;   /* The pager that owns pPg */</span>
<span class='curline'><a href='../S/185.html#L46660'>pPager</a>           46660 libdb/sqlite3.c   Pgno nPagePerSector = (pPager-&gt;sectorSize/pPager-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L46667'>pPager</a>           46667 libdb/sqlite3.c   assert( (pPager-&gt;doNotSpill &amp; SPILLFLAG_NOSYNC)==0 );</span>
<span class='curline'><a href='../S/185.html#L46668'>pPager</a>           46668 libdb/sqlite3.c   pPager-&gt;doNotSpill |= SPILLFLAG_NOSYNC;</span>
<span class='curline'><a href='../S/185.html#L46676'>pPager</a>           46676 libdb/sqlite3.c   nPageCount = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L46691'>pPager</a>           46691 libdb/sqlite3.c     if( pg==pPg-&gt;pgno || !sqlite3BitvecTest(pPager-&gt;pInJournal, pg) ){</span>
<span class='curline'><a href='../S/185.html#L46692'>pPager</a>           46692 libdb/sqlite3.c       if( pg!=PAGER_MJ_PGNO(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46693'>pPager</a>           46693 libdb/sqlite3.c         rc = sqlite3PagerGet(pPager, pg, &amp;pPage);</span>
<span class='curline'><a href='../S/185.html#L46702'>pPager</a>           46702 libdb/sqlite3.c     }else if( (pPage = sqlite3PagerLookup(pPager, pg))!=0 ){</span>
<span class='curline'><a href='../S/185.html#L46719'>pPager</a>           46719 libdb/sqlite3.c       PgHdr *pPage = sqlite3PagerLookup(pPager, pg1+ii);</span>
<span class='curline'><a href='../S/185.html#L46727'>pPager</a>           46727 libdb/sqlite3.c   assert( (pPager-&gt;doNotSpill &amp; SPILLFLAG_NOSYNC)!=0 );</span>
<span class='curline'><a href='../S/185.html#L46728'>pPager</a>           46728 libdb/sqlite3.c   pPager-&gt;doNotSpill &amp;= ~SPILLFLAG_NOSYNC;</span>
<span class='curline'><a href='../S/185.html#L46748'>pPager</a>           46748 libdb/sqlite3.c   assert( pPg-&gt;pPager-&gt;eState&gt;=PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L46749'>pPager</a>           46749 libdb/sqlite3.c   assert( pPg-&gt;pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L46750'>pPager</a>           46750 libdb/sqlite3.c   assert( assert_pager_state(pPg-&gt;pPager) );</span>
<span class='curline'><a href='../S/185.html#L46751'>pPager</a>           46751 libdb/sqlite3.c   if( pPg-&gt;pPager-&gt;sectorSize &gt; (u32)pPg-&gt;pPager-&gt;pageSize ){</span>
<span class='curline'><a href='../S/185.html#L46784'>pPager</a>           46784 libdb/sqlite3.c   Pager *pPager = pPg-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L46785'>pPager</a>           46785 libdb/sqlite3.c   if( (pPg-&gt;flags&amp;PGHDR_DIRTY) &amp;&amp; pPager-&gt;nSavepoint==0 ){</span>
<span class='curline'><a href='../S/185.html#L46786'>pPager</a>           46786 libdb/sqlite3.c     PAGERTRACE(("DONT_WRITE page %d of %d\n", pPg-&gt;pgno, PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L46787'>pPager</a>           46787 libdb/sqlite3.c     IOTRACE(("CLEAN %p %d\n", pPager, pPg-&gt;pgno))</span>
<span class='curline'><a href='../S/185.html#L46815'>pPager</a>           46815 libdb/sqlite3.c static int pager_incr_changecounter(Pager *pPager, int isDirectMode){</span>
<span class='curline'><a href='../S/185.html#L46818'>pPager</a>           46818 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L46819'>pPager</a>           46819 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD</span>
<span class='curline'><a href='../S/185.html#L46821'>pPager</a>           46821 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46841'>pPager</a>           46841 libdb/sqlite3.c   if( !pPager-&gt;changeCountDone &amp;&amp; ALWAYS(pPager-&gt;dbSize&gt;0) ){</span>
<span class='curline'><a href='../S/185.html#L46844'>pPager</a>           46844 libdb/sqlite3.c     assert( !pPager-&gt;tempFile &amp;&amp; isOpen(pPager-&gt;fd) );</span>
<span class='curline'><a href='../S/185.html#L46847'>pPager</a>           46847 libdb/sqlite3.c     rc = sqlite3PagerGet(pPager, 1, &amp;pPgHdr);</span>
<span class='curline'><a href='../S/185.html#L46866'>pPager</a>           46866 libdb/sqlite3.c         assert( pPager-&gt;dbFileSize&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L46867'>pPager</a>           46867 libdb/sqlite3.c         CODEC2(pPager, pPgHdr-&gt;pData, 1, 6, rc=SQLITE_NOMEM, zBuf);</span>
<span class='curline'><a href='../S/185.html#L46869'>pPager</a>           46869 libdb/sqlite3.c           rc = sqlite3OsWrite(pPager-&gt;fd, zBuf, pPager-&gt;pageSize, 0);</span>
<span class='curline'><a href='../S/185.html#L46870'>pPager</a>           46870 libdb/sqlite3.c           pPager-&gt;aStat[PAGER_STAT_WRITE]++;</span>
<span class='curline'><a href='../S/185.html#L46877'>pPager</a>           46877 libdb/sqlite3.c           memcpy(&amp;pPager-&gt;dbFileVers, pCopy, sizeof(pPager-&gt;dbFileVers));</span>
<span class='curline'><a href='../S/185.html#L46878'>pPager</a>           46878 libdb/sqlite3.c           pPager-&gt;changeCountDone = 1;</span>
<span class='curline'><a href='../S/185.html#L46881'>pPager</a>           46881 libdb/sqlite3.c         pPager-&gt;changeCountDone = 1;</span>
<span class='curline'><a href='../S/185.html#L46898'>pPager</a>           46898 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSync(Pager *pPager, const char *zMaster){</span>
<span class='curline'><a href='../S/185.html#L46901'>pPager</a>           46901 libdb/sqlite3.c   if( isOpen(pPager-&gt;fd) ){</span>
<span class='curline'><a href='../S/185.html#L46903'>pPager</a>           46903 libdb/sqlite3.c     rc = sqlite3OsFileControl(pPager-&gt;fd, SQLITE_FCNTL_SYNC, pArg);</span>
<span class='curline'><a href='../S/185.html#L46906'>pPager</a>           46906 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; !pPager-&gt;noSync ){</span>
<span class='curline'><a href='../S/185.html#L46908'>pPager</a>           46908 libdb/sqlite3.c     rc = sqlite3OsSync(pPager-&gt;fd, pPager-&gt;syncFlags);</span>
<span class='curline'><a href='../S/185.html#L46924'>pPager</a>           46924 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerExclusiveLock(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L46926'>pPager</a>           46926 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_CACHEMOD </span>
<span class='curline'><a href='../S/185.html#L46927'>pPager</a>           46927 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD </span>
<span class='curline'><a href='../S/185.html#L46928'>pPager</a>           46928 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_LOCKED </span>
<span class='curline'><a href='../S/185.html#L46930'>pPager</a>           46930 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46931'>pPager</a>           46931 libdb/sqlite3.c   if( 0==pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46932'>pPager</a>           46932 libdb/sqlite3.c     rc = pager_wait_on_lock(pPager, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/185.html#L46964'>pPager</a>           46964 libdb/sqlite3.c   Pager *pPager,                  /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L46970'>pPager</a>           46970 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_LOCKED</span>
<span class='curline'><a href='../S/185.html#L46971'>pPager</a>           46971 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L46972'>pPager</a>           46972 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD</span>
<span class='curline'><a href='../S/185.html#L46973'>pPager</a>           46973 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_ERROR</span>
<span class='curline'><a href='../S/185.html#L46975'>pPager</a>           46975 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L46978'>pPager</a>           46978 libdb/sqlite3.c   if( NEVER(pPager-&gt;errCode) ) return pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L46981'>pPager</a>           46981 libdb/sqlite3.c       pPager-&gt;zFilename, zMaster, pPager-&gt;dbSize));</span>
<span class='curline'><a href='../S/185.html#L46984'>pPager</a>           46984 libdb/sqlite3.c   if( pPager-&gt;eState&lt;PAGER_WRITER_CACHEMOD ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L46991'>pPager</a>           46991 libdb/sqlite3.c     sqlite3BackupRestart(pPager-&gt;pBackup);</span>
<span class='curline'><a href='../S/185.html#L46993'>pPager</a>           46993 libdb/sqlite3.c     if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L46994'>pPager</a>           46994 libdb/sqlite3.c       PgHdr *pList = sqlite3PcacheDirtyList(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L46999'>pPager</a>           46999 libdb/sqlite3.c         rc = sqlite3PagerGet(pPager, 1, &amp;pPageOne);</span>
<span class='curline'><a href='../S/185.html#L47005'>pPager</a>           47005 libdb/sqlite3.c         rc = pagerWalFrames(pPager, pList, pPager-&gt;dbSize, 1);</span>
<span class='curline'><a href='../S/185.html#L47009'>pPager</a>           47009 libdb/sqlite3.c         sqlite3PcacheCleanAll(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47037'>pPager</a>           47037 libdb/sqlite3.c       assert( isOpen(pPager-&gt;jfd) </span>
<span class='curline'><a href='../S/185.html#L47038'>pPager</a>           47038 libdb/sqlite3.c            || pPager-&gt;journalMode==PAGER_JOURNALMODE_OFF </span>
<span class='curline'><a href='../S/185.html#L47039'>pPager</a>           47039 libdb/sqlite3.c            || pPager-&gt;journalMode==PAGER_JOURNALMODE_WAL </span>
<span class='curline'><a href='../S/185.html#L47041'>pPager</a>           47041 libdb/sqlite3.c       if( !zMaster &amp;&amp; isOpen(pPager-&gt;jfd) </span>
<span class='curline'><a href='../S/185.html#L47042'>pPager</a>           47042 libdb/sqlite3.c        &amp;&amp; pPager-&gt;journalOff==jrnlBufferSize(pPager) </span>
<span class='curline'><a href='../S/185.html#L47043'>pPager</a>           47043 libdb/sqlite3.c        &amp;&amp; pPager-&gt;dbSize&gt;=pPager-&gt;dbOrigSize</span>
<span class='curline'><a href='../S/185.html#L47044'>pPager</a>           47044 libdb/sqlite3.c        &amp;&amp; (0==(pPg = sqlite3PcacheDirtyList(pPager-&gt;pPCache)) || 0==pPg-&gt;pDirty)</span>
<span class='curline'><a href='../S/185.html#L47052'>pPager</a>           47052 libdb/sqlite3.c         rc = pager_incr_changecounter(pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L47054'>pPager</a>           47054 libdb/sqlite3.c         rc = sqlite3JournalCreate(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L47056'>pPager</a>           47056 libdb/sqlite3.c           rc = pager_incr_changecounter(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L47060'>pPager</a>           47060 libdb/sqlite3.c       rc = pager_incr_changecounter(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L47068'>pPager</a>           47068 libdb/sqlite3.c       rc = writeMasterJournal(pPager, zMaster);</span>
<span class='curline'><a href='../S/185.html#L47082'>pPager</a>           47082 libdb/sqlite3.c       rc = syncJournal(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L47085'>pPager</a>           47085 libdb/sqlite3.c       rc = pager_write_pagelist(pPager,sqlite3PcacheDirtyList(pPager-&gt;pPCache));</span>
<span class='curline'><a href='../S/185.html#L47090'>pPager</a>           47090 libdb/sqlite3.c       sqlite3PcacheCleanAll(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47098'>pPager</a>           47098 libdb/sqlite3.c       if( pPager-&gt;dbSize&gt;pPager-&gt;dbFileSize ){</span>
<span class='curline'><a href='../S/185.html#L47099'>pPager</a>           47099 libdb/sqlite3.c         Pgno nNew = pPager-&gt;dbSize - (pPager-&gt;dbSize==PAGER_MJ_PGNO(pPager));</span>
<span class='curline'><a href='../S/185.html#L47100'>pPager</a>           47100 libdb/sqlite3.c         assert( pPager-&gt;eState==PAGER_WRITER_DBMOD );</span>
<span class='curline'><a href='../S/185.html#L47101'>pPager</a>           47101 libdb/sqlite3.c         rc = pager_truncate(pPager, nNew);</span>
<span class='curline'><a href='../S/185.html#L47107'>pPager</a>           47107 libdb/sqlite3.c         rc = sqlite3PagerSync(pPager, zMaster);</span>
<span class='curline'><a href='../S/185.html#L47109'>pPager</a>           47109 libdb/sqlite3.c       IOTRACE(("DBSYNC %p\n", pPager))</span>
<span class='curline'><a href='../S/185.html#L47114'>pPager</a>           47114 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; !pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L47115'>pPager</a>           47115 libdb/sqlite3.c     pPager-&gt;eState = PAGER_WRITER_FINISHED;</span>
<span class='curline'><a href='../S/185.html#L47136'>pPager</a>           47136 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerCommitPhaseTwo(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47142'>pPager</a>           47142 libdb/sqlite3.c   if( NEVER(pPager-&gt;errCode) ) return pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L47144'>pPager</a>           47144 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_LOCKED</span>
<span class='curline'><a href='../S/185.html#L47145'>pPager</a>           47145 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_FINISHED</span>
<span class='curline'><a href='../S/185.html#L47146'>pPager</a>           47146 libdb/sqlite3.c        || (pagerUseWal(pPager) &amp;&amp; pPager-&gt;eState==PAGER_WRITER_CACHEMOD)</span>
<span class='curline'><a href='../S/185.html#L47148'>pPager</a>           47148 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L47161'>pPager</a>           47161 libdb/sqlite3.c   if( pPager-&gt;eState==PAGER_WRITER_LOCKED </span>
<span class='curline'><a href='../S/185.html#L47162'>pPager</a>           47162 libdb/sqlite3.c    &amp;&amp; pPager-&gt;exclusiveMode </span>
<span class='curline'><a href='../S/185.html#L47163'>pPager</a>           47163 libdb/sqlite3.c    &amp;&amp; pPager-&gt;journalMode==PAGER_JOURNALMODE_PERSIST</span>
<span class='curline'><a href='../S/185.html#L47165'>pPager</a>           47165 libdb/sqlite3.c     assert( pPager-&gt;journalOff==JOURNAL_HDR_SZ(pPager) || !pPager-&gt;journalOff );</span>
<span class='curline'><a href='../S/185.html#L47166'>pPager</a>           47166 libdb/sqlite3.c     pPager-&gt;eState = PAGER_READER;</span>
<span class='curline'><a href='../S/185.html#L47170'>pPager</a>           47170 libdb/sqlite3.c   PAGERTRACE(("COMMIT %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L47171'>pPager</a>           47171 libdb/sqlite3.c   rc = pager_end_transaction(pPager, pPager-&gt;setMaster, 1);</span>
<span class='curline'><a href='../S/185.html#L47172'>pPager</a>           47172 libdb/sqlite3.c   return pager_error(pPager, rc);</span>
<span class='curline'><a href='../S/185.html#L47201'>pPager</a>           47201 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerRollback(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47203'>pPager</a>           47203 libdb/sqlite3.c   PAGERTRACE(("ROLLBACK %d\n", PAGERID(pPager)));</span>
<span class='curline'><a href='../S/185.html#L47209'>pPager</a>           47209 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L47210'>pPager</a>           47210 libdb/sqlite3.c   if( pPager-&gt;eState==PAGER_ERROR ) return pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L47211'>pPager</a>           47211 libdb/sqlite3.c   if( pPager-&gt;eState&lt;=PAGER_READER ) return SQLITE_OK;</span>
<span class='curline'><a href='../S/185.html#L47213'>pPager</a>           47213 libdb/sqlite3.c   if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L47215'>pPager</a>           47215 libdb/sqlite3.c     rc = sqlite3PagerSavepoint(pPager, SAVEPOINT_ROLLBACK, -1);</span>
<span class='curline'><a href='../S/185.html#L47216'>pPager</a>           47216 libdb/sqlite3.c     rc2 = pager_end_transaction(pPager, pPager-&gt;setMaster, 0);</span>
<span class='curline'><a href='../S/185.html#L47218'>pPager</a>           47218 libdb/sqlite3.c   }else if( !isOpen(pPager-&gt;jfd) || pPager-&gt;eState==PAGER_WRITER_LOCKED ){</span>
<span class='curline'><a href='../S/185.html#L47219'>pPager</a>           47219 libdb/sqlite3.c     int eState = pPager-&gt;eState;</span>
<span class='curline'><a href='../S/185.html#L47220'>pPager</a>           47220 libdb/sqlite3.c     rc = pager_end_transaction(pPager, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L47226'>pPager</a>           47226 libdb/sqlite3.c       pPager-&gt;errCode = SQLITE_ABORT;</span>
<span class='curline'><a href='../S/185.html#L47227'>pPager</a>           47227 libdb/sqlite3.c       pPager-&gt;eState = PAGER_ERROR;</span>
<span class='curline'><a href='../S/185.html#L47231'>pPager</a>           47231 libdb/sqlite3.c     rc = pager_playback(pPager, 0);</span>
<span class='curline'><a href='../S/185.html#L47234'>pPager</a>           47234 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_READER || rc!=SQLITE_OK );</span>
<span class='curline'><a href='../S/185.html#L47243'>pPager</a>           47243 libdb/sqlite3.c   return pager_error(pPager, rc);</span>
<span class='curline'><a href='../S/185.html#L47250'>pPager</a>           47250 libdb/sqlite3.c SQLITE_PRIVATE u8 sqlite3PagerIsreadonly(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47251'>pPager</a>           47251 libdb/sqlite3.c   return pPager-&gt;readOnly;</span>
<span class='curline'><a href='../S/185.html#L47257'>pPager</a>           47257 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerRefcount(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47258'>pPager</a>           47258 libdb/sqlite3.c   return sqlite3PcacheRefCount(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47265'>pPager</a>           47265 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerMemUsed(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47266'>pPager</a>           47266 libdb/sqlite3.c   int perPageSize = pPager-&gt;pageSize + pPager-&gt;nExtra + sizeof(PgHdr)</span>
<span class='curline'><a href='../S/185.html#L47268'>pPager</a>           47268 libdb/sqlite3.c   return perPageSize*sqlite3PcachePagecount(pPager-&gt;pPCache)</span>
<span class='curline'><a href='../S/185.html#L47269'>pPager</a>           47269 libdb/sqlite3.c            + sqlite3MallocSize(pPager)</span>
<span class='curline'><a href='../S/185.html#L47270'>pPager</a>           47270 libdb/sqlite3.c            + pPager-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L47284'>pPager</a>           47284 libdb/sqlite3.c SQLITE_PRIVATE int *sqlite3PagerStats(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47286'>pPager</a>           47286 libdb/sqlite3.c   a[0] = sqlite3PcacheRefCount(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47287'>pPager</a>           47287 libdb/sqlite3.c   a[1] = sqlite3PcachePagecount(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47288'>pPager</a>           47288 libdb/sqlite3.c   a[2] = sqlite3PcacheGetCachesize(pPager-&gt;pPCache);</span>
<span class='curline'><a href='../S/185.html#L47289'>pPager</a>           47289 libdb/sqlite3.c   a[3] = pPager-&gt;eState==PAGER_OPEN ? -1 : (int) pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L47290'>pPager</a>           47290 libdb/sqlite3.c   a[4] = pPager-&gt;eState;</span>
<span class='curline'><a href='../S/185.html#L47291'>pPager</a>           47291 libdb/sqlite3.c   a[5] = pPager-&gt;errCode;</span>
<span class='curline'><a href='../S/185.html#L47292'>pPager</a>           47292 libdb/sqlite3.c   a[6] = pPager-&gt;aStat[PAGER_STAT_HIT];</span>
<span class='curline'><a href='../S/185.html#L47293'>pPager</a>           47293 libdb/sqlite3.c   a[7] = pPager-&gt;aStat[PAGER_STAT_MISS];</span>
<span class='curline'><a href='../S/185.html#L47295'>pPager</a>           47295 libdb/sqlite3.c   a[9] = pPager-&gt;nRead;</span>
<span class='curline'><a href='../S/185.html#L47296'>pPager</a>           47296 libdb/sqlite3.c   a[10] = pPager-&gt;aStat[PAGER_STAT_WRITE];</span>
<span class='curline'><a href='../S/185.html#L47308'>pPager</a>           47308 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerCacheStat(Pager *pPager, int eStat, int reset, int *pnVal){</span>
<span class='curline'><a href='../S/185.html#L47319'>pPager</a>           47319 libdb/sqlite3.c   *pnVal += pPager-&gt;aStat[eStat - SQLITE_DBSTATUS_CACHE_HIT];</span>
<span class='curline'><a href='../S/185.html#L47321'>pPager</a>           47321 libdb/sqlite3.c     pPager-&gt;aStat[eStat - SQLITE_DBSTATUS_CACHE_HIT] = 0;</span>
<span class='curline'><a href='../S/185.html#L47328'>pPager</a>           47328 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerIsMemdb(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47342'>pPager</a>           47342 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerOpenSavepoint(Pager *pPager, int nSavepoint){</span>
<span class='curline'><a href='../S/185.html#L47344'>pPager</a>           47344 libdb/sqlite3.c   int nCurrent = pPager-&gt;nSavepoint;        /* Current number of savepoints */</span>
<span class='curline'><a href='../S/185.html#L47346'>pPager</a>           47346 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_WRITER_LOCKED );</span>
<span class='curline'><a href='../S/185.html#L47347'>pPager</a>           47347 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L47349'>pPager</a>           47349 libdb/sqlite3.c   if( nSavepoint&gt;nCurrent &amp;&amp; pPager-&gt;useJournal ){</span>
<span class='curline'><a href='../S/185.html#L47358'>pPager</a>           47358 libdb/sqlite3.c         pPager-&gt;aSavepoint, sizeof(PagerSavepoint)*nSavepoint</span>
<span class='curline'><a href='../S/185.html#L47364'>pPager</a>           47364 libdb/sqlite3.c     pPager-&gt;aSavepoint = aNew;</span>
<span class='curline'><a href='../S/185.html#L47368'>pPager</a>           47368 libdb/sqlite3.c       aNew[ii].nOrig = pPager-&gt;dbSize;</span>
<span class='curline'><a href='../S/185.html#L47369'>pPager</a>           47369 libdb/sqlite3.c       if( isOpen(pPager-&gt;jfd) &amp;&amp; pPager-&gt;journalOff&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L47370'>pPager</a>           47370 libdb/sqlite3.c         aNew[ii].iOffset = pPager-&gt;journalOff;</span>
<span class='curline'><a href='../S/185.html#L47372'>pPager</a>           47372 libdb/sqlite3.c         aNew[ii].iOffset = JOURNAL_HDR_SZ(pPager);</span>
<span class='curline'><a href='../S/185.html#L47374'>pPager</a>           47374 libdb/sqlite3.c       aNew[ii].iSubRec = pPager-&gt;nSubRec;</span>
<span class='curline'><a href='../S/185.html#L47375'>pPager</a>           47375 libdb/sqlite3.c       aNew[ii].pInSavepoint = sqlite3BitvecCreate(pPager-&gt;dbSize);</span>
<span class='curline'><a href='../S/185.html#L47379'>pPager</a>           47379 libdb/sqlite3.c       if( pagerUseWal(pPager) ){</span>
<span class='curline'><a href='../S/185.html#L47380'>pPager</a>           47380 libdb/sqlite3.c         sqlite3WalSavepoint(pPager-&gt;pWal, aNew[ii].aWalData);</span>
<span class='curline'><a href='../S/185.html#L47382'>pPager</a>           47382 libdb/sqlite3.c       pPager-&gt;nSavepoint = ii+1;</span>
<span class='curline'><a href='../S/185.html#L47384'>pPager</a>           47384 libdb/sqlite3.c     assert( pPager-&gt;nSavepoint==nSavepoint );</span>
<span class='curline'><a href='../S/185.html#L47385'>pPager</a>           47385 libdb/sqlite3.c     assertTruncateConstraint(pPager);</span>
<span class='curline'><a href='../S/185.html#L47421'>pPager</a>           47421 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSavepoint(Pager *pPager, int op, int iSavepoint){</span>
<span class='curline'><a href='../S/185.html#L47422'>pPager</a>           47422 libdb/sqlite3.c   int rc = pPager-&gt;errCode;       /* Return code */</span>
<span class='curline'><a href='../S/185.html#L47427'>pPager</a>           47427 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; iSavepoint&lt;pPager-&gt;nSavepoint ){</span>
<span class='curline'><a href='../S/185.html#L47436'>pPager</a>           47436 libdb/sqlite3.c     for(ii=nNew; ii&lt;pPager-&gt;nSavepoint; ii++){</span>
<span class='curline'><a href='../S/185.html#L47437'>pPager</a>           47437 libdb/sqlite3.c       sqlite3BitvecDestroy(pPager-&gt;aSavepoint[ii].pInSavepoint);</span>
<span class='curline'><a href='../S/185.html#L47439'>pPager</a>           47439 libdb/sqlite3.c     pPager-&gt;nSavepoint = nNew;</span>
<span class='curline'><a href='../S/185.html#L47444'>pPager</a>           47444 libdb/sqlite3.c       if( nNew==0 &amp;&amp; isOpen(pPager-&gt;sjfd) ){</span>
<span class='curline'><a href='../S/185.html#L47446'>pPager</a>           47446 libdb/sqlite3.c         if( sqlite3IsMemJournal(pPager-&gt;sjfd) ){</span>
<span class='curline'><a href='../S/185.html#L47447'>pPager</a>           47447 libdb/sqlite3.c           rc = sqlite3OsTruncate(pPager-&gt;sjfd, 0);</span>
<span class='curline'><a href='../S/185.html#L47450'>pPager</a>           47450 libdb/sqlite3.c         pPager-&gt;nSubRec = 0;</span>
<span class='curline'><a href='../S/185.html#L47458'>pPager</a>           47458 libdb/sqlite3.c     else if( pagerUseWal(pPager) || isOpen(pPager-&gt;jfd) ){</span>
<span class='curline'><a href='../S/185.html#L47459'>pPager</a>           47459 libdb/sqlite3.c       PagerSavepoint *pSavepoint = (nNew==0)?0:&amp;pPager-&gt;aSavepoint[nNew-1];</span>
<span class='curline'><a href='../S/185.html#L47460'>pPager</a>           47460 libdb/sqlite3.c       rc = pagerPlaybackSavepoint(pPager, pSavepoint);</span>
<span class='curline'><a href='../S/185.html#L47478'>pPager</a>           47478 libdb/sqlite3.c SQLITE_PRIVATE const char *sqlite3PagerFilename(Pager *pPager, int nullIfMemDb){</span>
<span class='curline'><a href='../S/185.html#L47479'>pPager</a>           47479 libdb/sqlite3.c   return (nullIfMemDb &amp;&amp; pPager-&gt;memDb) ? "" : pPager-&gt;zFilename;</span>
<span class='curline'><a href='../S/185.html#L47485'>pPager</a>           47485 libdb/sqlite3.c SQLITE_PRIVATE const sqlite3_vfs *sqlite3PagerVfs(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47486'>pPager</a>           47486 libdb/sqlite3.c   return pPager-&gt;pVfs;</span>
<span class='curline'><a href='../S/185.html#L47494'>pPager</a>           47494 libdb/sqlite3.c SQLITE_PRIVATE sqlite3_file *sqlite3PagerFile(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47495'>pPager</a>           47495 libdb/sqlite3.c   return pPager-&gt;fd;</span>
<span class='curline'><a href='../S/185.html#L47501'>pPager</a>           47501 libdb/sqlite3.c SQLITE_PRIVATE const char *sqlite3PagerJournalname(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47502'>pPager</a>           47502 libdb/sqlite3.c   return pPager-&gt;zJournal;</span>
<span class='curline'><a href='../S/185.html#L47509'>pPager</a>           47509 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerNosync(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47510'>pPager</a>           47510 libdb/sqlite3.c   return pPager-&gt;noSync;</span>
<span class='curline'><a href='../S/185.html#L47518'>pPager</a>           47518 libdb/sqlite3.c   Pager *pPager,</span>
<span class='curline'><a href='../S/185.html#L47524'>pPager</a>           47524 libdb/sqlite3.c   if( pPager-&gt;xCodecFree ) pPager-&gt;xCodecFree(pPager-&gt;pCodec);</span>
<span class='curline'><a href='../S/185.html#L47525'>pPager</a>           47525 libdb/sqlite3.c   pPager-&gt;xCodec = pPager-&gt;memDb ? 0 : xCodec;</span>
<span class='curline'><a href='../S/185.html#L47526'>pPager</a>           47526 libdb/sqlite3.c   pPager-&gt;xCodecSizeChng = xCodecSizeChng;</span>
<span class='curline'><a href='../S/185.html#L47527'>pPager</a>           47527 libdb/sqlite3.c   pPager-&gt;xCodecFree = xCodecFree;</span>
<span class='curline'><a href='../S/185.html#L47528'>pPager</a>           47528 libdb/sqlite3.c   pPager-&gt;pCodec = pCodec;</span>
<span class='curline'><a href='../S/185.html#L47529'>pPager</a>           47529 libdb/sqlite3.c   pagerReportSize(pPager);</span>
<span class='curline'><a href='../S/185.html#L47531'>pPager</a>           47531 libdb/sqlite3.c SQLITE_PRIVATE void *sqlite3PagerGetCodec(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47532'>pPager</a>           47532 libdb/sqlite3.c   return pPager-&gt;pCodec;</span>
<span class='curline'><a href='../S/185.html#L47544'>pPager</a>           47544 libdb/sqlite3.c   CODEC2(pPg-&gt;pPager, pPg-&gt;pData, pPg-&gt;pgno, 6, return 0, aData);</span>
<span class='curline'><a href='../S/185.html#L47551'>pPager</a>           47551 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerState(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47552'>pPager</a>           47552 libdb/sqlite3.c   return pPager-&gt;eState;</span>
<span class='curline'><a href='../S/185.html#L47582'>pPager</a>           47582 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerMovepage(Pager *pPager, DbPage *pPg, Pgno pgno, int isCommit){</span>
<span class='curline'><a href='../S/185.html#L47589'>pPager</a>           47589 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_WRITER_CACHEMOD</span>
<span class='curline'><a href='../S/185.html#L47590'>pPager</a>           47590 libdb/sqlite3.c        || pPager-&gt;eState==PAGER_WRITER_DBMOD</span>
<span class='curline'><a href='../S/185.html#L47592'>pPager</a>           47592 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L47628'>pPager</a>           47628 libdb/sqlite3.c       PAGERID(pPager), pPg-&gt;pgno, (pPg-&gt;flags&amp;PGHDR_NEED_SYNC)?1:0, pgno));</span>
<span class='curline'><a href='../S/185.html#L47629'>pPager</a>           47629 libdb/sqlite3.c   IOTRACE(("MOVE %p %d %d\n", pPager, pPg-&gt;pgno, pgno))</span>
<span class='curline'><a href='../S/185.html#L47640'>pPager</a>           47640 libdb/sqlite3.c     assert( pPager-&gt;journalMode==PAGER_JOURNALMODE_OFF ||</span>
<span class='curline'><a href='../S/185.html#L47641'>pPager</a>           47641 libdb/sqlite3.c             pageInJournal(pPager, pPg) || pPg-&gt;pgno&gt;pPager-&gt;dbOrigSize );</span>
<span class='curline'><a href='../S/185.html#L47651'>pPager</a>           47651 libdb/sqlite3.c   pPgOld = sqlite3PagerLookup(pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L47658'>pPager</a>           47658 libdb/sqlite3.c       sqlite3PcacheMove(pPgOld, pPager-&gt;dbSize+1);</span>
<span class='curline'><a href='../S/185.html#L47694'>pPager</a>           47694 libdb/sqlite3.c     rc = sqlite3PagerGet(pPager, needSyncPgno, &amp;pPgHdr);</span>
<span class='curline'><a href='../S/185.html#L47696'>pPager</a>           47696 libdb/sqlite3.c       if( needSyncPgno&lt;=pPager-&gt;dbOrigSize ){</span>
<span class='curline'><a href='../S/185.html#L47697'>pPager</a>           47697 libdb/sqlite3.c         assert( pPager-&gt;pTmpSpace!=0 );</span>
<span class='curline'><a href='../S/185.html#L47698'>pPager</a>           47698 libdb/sqlite3.c         sqlite3BitvecClear(pPager-&gt;pInJournal, needSyncPgno, pPager-&gt;pTmpSpace);</span>
<span class='curline'><a href='../S/185.html#L47715'>pPager</a>           47715 libdb/sqlite3.c   assert( pPg-&gt;nRef&gt;0 || pPg-&gt;pPager-&gt;memDb );</span>
<span class='curline'><a href='../S/185.html#L47737'>pPager</a>           47737 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerLockingMode(Pager *pPager, int eMode){</span>
<span class='curline'><a href='../S/185.html#L47743'>pPager</a>           47743 libdb/sqlite3.c   assert( pPager-&gt;exclusiveMode || 0==sqlite3WalHeapMemory(pPager-&gt;pWal) );</span>
<span class='curline'><a href='../S/185.html#L47744'>pPager</a>           47744 libdb/sqlite3.c   if( eMode&gt;=0 &amp;&amp; !pPager-&gt;tempFile &amp;&amp; !sqlite3WalHeapMemory(pPager-&gt;pWal) ){</span>
<span class='curline'><a href='../S/185.html#L47745'>pPager</a>           47745 libdb/sqlite3.c     pPager-&gt;exclusiveMode = (u8)eMode;</span>
<span class='curline'><a href='../S/185.html#L47747'>pPager</a>           47747 libdb/sqlite3.c   return (int)pPager-&gt;exclusiveMode;</span>
<span class='curline'><a href='../S/185.html#L47770'>pPager</a>           47770 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerSetJournalMode(Pager *pPager, int eMode){</span>
<span class='curline'><a href='../S/185.html#L47771'>pPager</a>           47771 libdb/sqlite3.c   u8 eOld = pPager-&gt;journalMode;    /* Prior journalmode */</span>
<span class='curline'><a href='../S/185.html#L47776'>pPager</a>           47776 libdb/sqlite3.c   print_pager_state(pPager);</span>
<span class='curline'><a href='../S/185.html#L47792'>pPager</a>           47792 libdb/sqlite3.c   assert( pPager-&gt;tempFile==0 || eMode!=PAGER_JOURNALMODE_WAL );</span>
<span class='curline'><a href='../S/185.html#L47807'>pPager</a>           47807 libdb/sqlite3.c     assert( pPager-&gt;eState!=PAGER_ERROR );</span>
<span class='curline'><a href='../S/185.html#L47808'>pPager</a>           47808 libdb/sqlite3.c     pPager-&gt;journalMode = (u8)eMode;</span>
<span class='curline'><a href='../S/185.html#L47821'>pPager</a>           47821 libdb/sqlite3.c     assert( isOpen(pPager-&gt;fd) || pPager-&gt;exclusiveMode );</span>
<span class='curline'><a href='../S/185.html#L47822'>pPager</a>           47822 libdb/sqlite3.c     if( !pPager-&gt;exclusiveMode &amp;&amp; (eOld &amp; 5)==1 &amp;&amp; (eMode &amp; 1)==0 ){</span>
<span class='curline'><a href='../S/185.html#L47832'>pPager</a>           47832 libdb/sqlite3.c       sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L47833'>pPager</a>           47833 libdb/sqlite3.c       if( pPager-&gt;eLock&gt;=RESERVED_LOCK ){</span>
<span class='curline'><a href='../S/185.html#L47834'>pPager</a>           47834 libdb/sqlite3.c         sqlite3OsDelete(pPager-&gt;pVfs, pPager-&gt;zJournal, 0);</span>
<span class='curline'><a href='../S/185.html#L47837'>pPager</a>           47837 libdb/sqlite3.c         int state = pPager-&gt;eState;</span>
<span class='curline'><a href='../S/185.html#L47840'>pPager</a>           47840 libdb/sqlite3.c           rc = sqlite3PagerSharedLock(pPager);</span>
<span class='curline'><a href='../S/185.html#L47842'>pPager</a>           47842 libdb/sqlite3.c         if( pPager-&gt;eState==PAGER_READER ){</span>
<span class='curline'><a href='../S/185.html#L47844'>pPager</a>           47844 libdb/sqlite3.c           rc = pagerLockDb(pPager, RESERVED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L47847'>pPager</a>           47847 libdb/sqlite3.c           sqlite3OsDelete(pPager-&gt;pVfs, pPager-&gt;zJournal, 0);</span>
<span class='curline'><a href='../S/185.html#L47850'>pPager</a>           47850 libdb/sqlite3.c           pagerUnlockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L47852'>pPager</a>           47852 libdb/sqlite3.c           pager_unlock(pPager);</span>
<span class='curline'><a href='../S/185.html#L47854'>pPager</a>           47854 libdb/sqlite3.c         assert( state==pPager-&gt;eState );</span>
<span class='curline'><a href='../S/185.html#L47860'>pPager</a>           47860 libdb/sqlite3.c   return (int)pPager-&gt;journalMode;</span>
<span class='curline'><a href='../S/185.html#L47866'>pPager</a>           47866 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerGetJournalMode(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47867'>pPager</a>           47867 libdb/sqlite3.c   return (int)pPager-&gt;journalMode;</span>
<span class='curline'><a href='../S/185.html#L47875'>pPager</a>           47875 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerOkToChangeJournalMode(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47876'>pPager</a>           47876 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L47877'>pPager</a>           47877 libdb/sqlite3.c   if( pPager-&gt;eState&gt;=PAGER_WRITER_CACHEMOD ) return 0;</span>
<span class='curline'><a href='../S/185.html#L47878'>pPager</a>           47878 libdb/sqlite3.c   if( NEVER(isOpen(pPager-&gt;jfd) &amp;&amp; pPager-&gt;journalOff&gt;0) ) return 0;</span>
<span class='curline'><a href='../S/185.html#L47888'>pPager</a>           47888 libdb/sqlite3.c SQLITE_PRIVATE i64 sqlite3PagerJournalSizeLimit(Pager *pPager, i64 iLimit){</span>
<span class='curline'><a href='../S/185.html#L47890'>pPager</a>           47890 libdb/sqlite3.c     pPager-&gt;journalSizeLimit = iLimit;</span>
<span class='curline'><a href='../S/185.html#L47891'>pPager</a>           47891 libdb/sqlite3.c     sqlite3WalLimit(pPager-&gt;pWal, iLimit);</span>
<span class='curline'><a href='../S/185.html#L47893'>pPager</a>           47893 libdb/sqlite3.c   return pPager-&gt;journalSizeLimit;</span>
<span class='curline'><a href='../S/185.html#L47902'>pPager</a>           47902 libdb/sqlite3.c SQLITE_PRIVATE sqlite3_backup **sqlite3PagerBackupPtr(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47903'>pPager</a>           47903 libdb/sqlite3.c   return &amp;pPager-&gt;pBackup;</span>
<span class='curline'><a href='../S/185.html#L47910'>pPager</a>           47910 libdb/sqlite3.c SQLITE_PRIVATE void sqlite3PagerClearCache(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47911'>pPager</a>           47911 libdb/sqlite3.c   if( !MEMDB &amp;&amp; pPager-&gt;tempFile==0 ) pager_reset(pPager);</span>
<span class='curline'><a href='../S/185.html#L47923'>pPager</a>           47923 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerCheckpoint(Pager *pPager, int eMode, int *pnLog, int *pnCkpt){</span>
<span class='curline'><a href='../S/185.html#L47925'>pPager</a>           47925 libdb/sqlite3.c   if( pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/185.html#L47926'>pPager</a>           47926 libdb/sqlite3.c     rc = sqlite3WalCheckpoint(pPager-&gt;pWal, eMode,</span>
<span class='curline'><a href='../S/185.html#L47927'>pPager</a>           47927 libdb/sqlite3.c         pPager-&gt;xBusyHandler, pPager-&gt;pBusyHandlerArg,</span>
<span class='curline'><a href='../S/185.html#L47928'>pPager</a>           47928 libdb/sqlite3.c         pPager-&gt;ckptSyncFlags, pPager-&gt;pageSize, (u8 *)pPager-&gt;pTmpSpace,</span>
<span class='curline'><a href='../S/185.html#L47935'>pPager</a>           47935 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerWalCallback(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47936'>pPager</a>           47936 libdb/sqlite3.c   return sqlite3WalCallback(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L47943'>pPager</a>           47943 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerWalSupported(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47944'>pPager</a>           47944 libdb/sqlite3.c   const sqlite3_io_methods *pMethods = pPager-&gt;fd-&gt;pMethods;</span>
<span class='curline'><a href='../S/185.html#L47945'>pPager</a>           47945 libdb/sqlite3.c   return pPager-&gt;exclusiveMode || (pMethods-&gt;iVersion&gt;=2 &amp;&amp; pMethods-&gt;xShmMap);</span>
<span class='curline'><a href='../S/185.html#L47952'>pPager</a>           47952 libdb/sqlite3.c static int pagerExclusiveLock(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47955'>pPager</a>           47955 libdb/sqlite3.c   assert( pPager-&gt;eLock==SHARED_LOCK || pPager-&gt;eLock==EXCLUSIVE_LOCK );</span>
<span class='curline'><a href='../S/185.html#L47956'>pPager</a>           47956 libdb/sqlite3.c   rc = pagerLockDb(pPager, EXCLUSIVE_LOCK);</span>
<span class='curline'><a href='../S/185.html#L47960'>pPager</a>           47960 libdb/sqlite3.c     pagerUnlockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L47972'>pPager</a>           47972 libdb/sqlite3.c static int pagerOpenWal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L47975'>pPager</a>           47975 libdb/sqlite3.c   assert( pPager-&gt;pWal==0 &amp;&amp; pPager-&gt;tempFile==0 );</span>
<span class='curline'><a href='../S/185.html#L47976'>pPager</a>           47976 libdb/sqlite3.c   assert( pPager-&gt;eLock==SHARED_LOCK || pPager-&gt;eLock==EXCLUSIVE_LOCK );</span>
<span class='curline'><a href='../S/185.html#L47983'>pPager</a>           47983 libdb/sqlite3.c   if( pPager-&gt;exclusiveMode ){</span>
<span class='curline'><a href='../S/185.html#L47984'>pPager</a>           47984 libdb/sqlite3.c     rc = pagerExclusiveLock(pPager);</span>
<span class='curline'><a href='../S/185.html#L47991'>pPager</a>           47991 libdb/sqlite3.c     rc = sqlite3WalOpen(pPager-&gt;pVfs,</span>
<span class='curline'><a href='../S/185.html#L47992'>pPager</a>           47992 libdb/sqlite3.c         pPager-&gt;fd, pPager-&gt;zWal, pPager-&gt;exclusiveMode,</span>
<span class='curline'><a href='../S/185.html#L47993'>pPager</a>           47993 libdb/sqlite3.c         pPager-&gt;journalSizeLimit, &amp;pPager-&gt;pWal</span>
<span class='curline'><a href='../S/185.html#L47996'>pPager</a>           47996 libdb/sqlite3.c   pagerFixMaplimit(pPager);</span>
<span class='curline'><a href='../S/185.html#L48018'>pPager</a>           48018 libdb/sqlite3.c   Pager *pPager,                  /* Pager object */</span>
<span class='curline'><a href='../S/185.html#L48023'>pPager</a>           48023 libdb/sqlite3.c   assert( assert_pager_state(pPager) );</span>
<span class='curline'><a href='../S/185.html#L48024'>pPager</a>           48024 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_OPEN   || pbOpen );</span>
<span class='curline'><a href='../S/185.html#L48025'>pPager</a>           48025 libdb/sqlite3.c   assert( pPager-&gt;eState==PAGER_READER || !pbOpen );</span>
<span class='curline'><a href='../S/185.html#L48027'>pPager</a>           48027 libdb/sqlite3.c   assert( pbOpen!=0 || (!pPager-&gt;tempFile &amp;&amp; !pPager-&gt;pWal) );</span>
<span class='curline'><a href='../S/185.html#L48029'>pPager</a>           48029 libdb/sqlite3.c   if( !pPager-&gt;tempFile &amp;&amp; !pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/185.html#L48030'>pPager</a>           48030 libdb/sqlite3.c     if( !sqlite3PagerWalSupported(pPager) ) return SQLITE_CANTOPEN;</span>
<span class='curline'><a href='../S/185.html#L48033'>pPager</a>           48033 libdb/sqlite3.c     sqlite3OsClose(pPager-&gt;jfd);</span>
<span class='curline'><a href='../S/185.html#L48035'>pPager</a>           48035 libdb/sqlite3.c     rc = pagerOpenWal(pPager);</span>
<span class='curline'><a href='../S/185.html#L48037'>pPager</a>           48037 libdb/sqlite3.c       pPager-&gt;journalMode = PAGER_JOURNALMODE_WAL;</span>
<span class='curline'><a href='../S/185.html#L48038'>pPager</a>           48038 libdb/sqlite3.c       pPager-&gt;eState = PAGER_OPEN;</span>
<span class='curline'><a href='../S/185.html#L48056'>pPager</a>           48056 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerCloseWal(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L48059'>pPager</a>           48059 libdb/sqlite3.c   assert( pPager-&gt;journalMode==PAGER_JOURNALMODE_WAL );</span>
<span class='curline'><a href='../S/185.html#L48065'>pPager</a>           48065 libdb/sqlite3.c   if( !pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/185.html#L48067'>pPager</a>           48067 libdb/sqlite3.c     rc = pagerLockDb(pPager, SHARED_LOCK);</span>
<span class='curline'><a href='../S/185.html#L48070'>pPager</a>           48070 libdb/sqlite3.c           pPager-&gt;pVfs, pPager-&gt;zWal, SQLITE_ACCESS_EXISTS, &amp;logexists</span>
<span class='curline'><a href='../S/185.html#L48074'>pPager</a>           48074 libdb/sqlite3.c       rc = pagerOpenWal(pPager);</span>
<span class='curline'><a href='../S/185.html#L48081'>pPager</a>           48081 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; pPager-&gt;pWal ){</span>
<span class='curline'><a href='../S/185.html#L48082'>pPager</a>           48082 libdb/sqlite3.c     rc = pagerExclusiveLock(pPager);</span>
<span class='curline'><a href='../S/185.html#L48084'>pPager</a>           48084 libdb/sqlite3.c       rc = sqlite3WalClose(pPager-&gt;pWal, pPager-&gt;ckptSyncFlags,</span>
<span class='curline'><a href='../S/185.html#L48085'>pPager</a>           48085 libdb/sqlite3.c                            pPager-&gt;pageSize, (u8*)pPager-&gt;pTmpSpace);</span>
<span class='curline'><a href='../S/185.html#L48086'>pPager</a>           48086 libdb/sqlite3.c       pPager-&gt;pWal = 0;</span>
<span class='curline'><a href='../S/185.html#L48087'>pPager</a>           48087 libdb/sqlite3.c       pagerFixMaplimit(pPager);</span>
<span class='curline'><a href='../S/185.html#L48103'>pPager</a>           48103 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3PagerWalFramesize(Pager *pPager){</span>
<span class='curline'><a href='../S/185.html#L48104'>pPager</a>           48104 libdb/sqlite3.c   assert( pPager-&gt;eState&gt;=PAGER_READER );</span>
<span class='curline'><a href='../S/185.html#L48105'>pPager</a>           48105 libdb/sqlite3.c   return sqlite3WalFramesize(pPager-&gt;pWal);</span>
<span class='curline'><a href='../S/185.html#L51634'>pPager</a>           51634 libdb/sqlite3.c   Pager *pPager;        /* The page cache */</span>
<span class='curline'><a href='../S/185.html#L51880'>pPager</a>           51880 libdb/sqlite3.c   Pager *pPager;    /* The associated pager.  Also accessible by pBt-&gt;pPager */</span>
<span class='curline'><a href='../S/185.html#L53050'>pPager</a>           53050 libdb/sqlite3.c   rc = sqlite3PagerGet(pBt-&gt;pPager, iPtrmap, &amp;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L53093'>pPager</a>           53093 libdb/sqlite3.c   rc = sqlite3PagerGet(pBt-&gt;pPager, iPtrmap, &amp;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L53347'>pPager</a>           53347 libdb/sqlite3.c   temp = sqlite3PagerTempSpace(pPage-&gt;pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L53839'>pPager</a>           53839 libdb/sqlite3.c   rc = sqlite3PagerAcquire(pBt-&gt;pPager, pgno, (DbPage**)&amp;pDbPage, flags);</span>
<span class='curline'><a href='../S/185.html#L53853'>pPager</a>           53853 libdb/sqlite3.c   pDbPage = sqlite3PagerLookup(pBt-&gt;pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L54073'>pPager</a>           54073 libdb/sqlite3.c         if( 0==strcmp(zFullPathname, sqlite3PagerFilename(pBt-&gt;pPager, 0))</span>
<span class='curline'><a href='../S/185.html#L54074'>pPager</a>           54074 libdb/sqlite3.c                  &amp;&amp; sqlite3PagerVfs(pBt-&gt;pPager)==pVfs ){</span>
<span class='curline'><a href='../S/185.html#L54123'>pPager</a>           54123 libdb/sqlite3.c     rc = sqlite3PagerOpen(pVfs, &amp;pBt-&gt;pPager, zFilename,</span>
<span class='curline'><a href='../S/185.html#L54126'>pPager</a>           54126 libdb/sqlite3.c       sqlite3PagerSetMmapLimit(pBt-&gt;pPager, db-&gt;szMmap);</span>
<span class='curline'><a href='../S/185.html#L54127'>pPager</a>           54127 libdb/sqlite3.c       rc = sqlite3PagerReadFileheader(pBt-&gt;pPager,sizeof(zDbHeader),zDbHeader);</span>
<span class='curline'><a href='../S/185.html#L54134'>pPager</a>           54134 libdb/sqlite3.c     sqlite3PagerSetBusyhandler(pBt-&gt;pPager, btreeInvokeBusyHandler, pBt);</span>
<span class='curline'><a href='../S/185.html#L54139'>pPager</a>           54139 libdb/sqlite3.c     if( sqlite3PagerIsreadonly(pBt-&gt;pPager) ) pBt-&gt;btsFlags |= BTS_READ_ONLY;</span>
<span class='curline'><a href='../S/185.html#L54168'>pPager</a>           54168 libdb/sqlite3.c     rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize, nReserve);</span>
<span class='curline'><a href='../S/185.html#L54231'>pPager</a>           54231 libdb/sqlite3.c     if( pBt &amp;&amp; pBt-&gt;pPager ){</span>
<span class='curline'><a href='../S/185.html#L54232'>pPager</a>           54232 libdb/sqlite3.c       sqlite3PagerClose(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54243'>pPager</a>           54243 libdb/sqlite3.c       sqlite3PagerSetCachesize(p-&gt;pBt-&gt;pPager, SQLITE_DEFAULT_CACHE_SIZE);</span>
<span class='curline'><a href='../S/185.html#L54373'>pPager</a>           54373 libdb/sqlite3.c     sqlite3PagerClose(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54412'>pPager</a>           54412 libdb/sqlite3.c   sqlite3PagerSetCachesize(pBt-&gt;pPager, mxPage);</span>
<span class='curline'><a href='../S/185.html#L54426'>pPager</a>           54426 libdb/sqlite3.c   sqlite3PagerSetMmapLimit(pBt-&gt;pPager, szMmap);</span>
<span class='curline'><a href='../S/185.html#L54448'>pPager</a>           54448 libdb/sqlite3.c   sqlite3PagerSetFlags(pBt-&gt;pPager, pgFlags);</span>
<span class='curline'><a href='../S/185.html#L54463'>pPager</a>           54463 libdb/sqlite3.c   assert( pBt &amp;&amp; pBt-&gt;pPager );</span>
<span class='curline'><a href='../S/185.html#L54464'>pPager</a>           54464 libdb/sqlite3.c   rc = sqlite3PagerNosync(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54509'>pPager</a>           54509 libdb/sqlite3.c   rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize, nReserve);</span>
<span class='curline'><a href='../S/185.html#L54563'>pPager</a>           54563 libdb/sqlite3.c   n = sqlite3PagerMaxPageCount(p-&gt;pBt-&gt;pPager, mxPage);</span>
<span class='curline'><a href='../S/185.html#L54652'>pPager</a>           54652 libdb/sqlite3.c   rc = sqlite3PagerSharedLock(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54661'>pPager</a>           54661 libdb/sqlite3.c   sqlite3PagerPagecount(pBt-&gt;pPager, &amp;nPageFile);</span>
<span class='curline'><a href='../S/185.html#L54699'>pPager</a>           54699 libdb/sqlite3.c       rc = sqlite3PagerOpenWal(pBt-&gt;pPager, &amp;isOpen);</span>
<span class='curline'><a href='../S/185.html#L54738'>pPager</a>           54738 libdb/sqlite3.c       rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize,</span>
<span class='curline'><a href='../S/185.html#L54828'>pPager</a>           54828 libdb/sqlite3.c     assert( sqlite3PagerRefcount(pBt-&gt;pPager)==1 );</span>
<span class='curline'><a href='../S/185.html#L54997'>pPager</a>           54997 libdb/sqlite3.c         rc = sqlite3PagerBegin(pBt-&gt;pPager,wrflag&gt;1,sqlite3TempInMemory(p-&gt;db));</span>
<span class='curline'><a href='../S/185.html#L55057'>pPager</a>           55057 libdb/sqlite3.c     rc = sqlite3PagerOpenSavepoint(pBt-&gt;pPager, p-&gt;db-&gt;nSavepoint);</span>
<span class='curline'><a href='../S/185.html#L55192'>pPager</a>           55192 libdb/sqlite3.c   Pager *pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L55203'>pPager</a>           55203 libdb/sqlite3.c   rc = sqlite3PagerMovepage(pPager, pDbPage-&gt;pDbPage, iFreePage, isCommit);</span>
<span class='curline'><a href='../S/185.html#L55441'>pPager</a>           55441 libdb/sqlite3.c   Pager *pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L55442'>pPager</a>           55442 libdb/sqlite3.c   VVA_ONLY( int nRef = sqlite3PagerRefcount(pPager) );</span>
<span class='curline'><a href='../S/185.html#L55480'>pPager</a>           55480 libdb/sqlite3.c       sqlite3PagerRollback(pPager);</span>
<span class='curline'><a href='../S/185.html#L55484'>pPager</a>           55484 libdb/sqlite3.c   assert( nRef&gt;=sqlite3PagerRefcount(pPager) );</span>
<span class='curline'><a href='../S/185.html#L55532'>pPager</a>           55532 libdb/sqlite3.c       sqlite3PagerTruncateImage(pBt-&gt;pPager, pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L55535'>pPager</a>           55535 libdb/sqlite3.c     rc = sqlite3PagerCommitPhaseOne(pBt-&gt;pPager, zMaster, 0);</span>
<span class='curline'><a href='../S/185.html#L55621'>pPager</a>           55621 libdb/sqlite3.c     rc = sqlite3PagerCommitPhaseTwo(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L55712'>pPager</a>           55712 libdb/sqlite3.c     rc2 = sqlite3PagerRollback(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L55723'>pPager</a>           55723 libdb/sqlite3.c       if( nPage==0 ) sqlite3PagerPagecount(pBt-&gt;pPager, &amp;nPage);</span>
<span class='curline'><a href='../S/185.html#L55770'>pPager</a>           55770 libdb/sqlite3.c   rc = sqlite3PagerOpenSavepoint(pBt-&gt;pPager, iStatement);</span>
<span class='curline'><a href='../S/185.html#L55794'>pPager</a>           55794 libdb/sqlite3.c     rc = sqlite3PagerSavepoint(pBt-&gt;pPager, op, iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L56359'>pPager</a>           56359 libdb/sqlite3.c          &amp;&amp; (fd = sqlite3PagerFile(pBt-&gt;pPager))-&gt;pMethods     /* (3) */</span>
<span class='curline'><a href='../S/185.html#L56375'>pPager</a>           56375 libdb/sqlite3.c           rc = sqlite3PagerAcquire(pBt-&gt;pPager, nextPage, &amp;pDbPage,</span>
<span class='curline'><a href='../S/185.html#L60067'>pPager</a>           60067 libdb/sqlite3.c   return p-&gt;pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L60196'>pPager</a>           60196 libdb/sqlite3.c     if( sqlite3PagerGet(pCheck-&gt;pPager, (Pgno)iPage, &amp;pOvflPage) ){</span>
<span class='curline'><a href='../S/185.html#L60513'>pPager</a>           60513 libdb/sqlite3.c   nRef = sqlite3PagerRefcount(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L60515'>pPager</a>           60515 libdb/sqlite3.c   sCheck.pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L60587'>pPager</a>           60587 libdb/sqlite3.c   if( NEVER(nRef != sqlite3PagerRefcount(pBt-&gt;pPager)) ){</span>
<span class='curline'><a href='../S/185.html#L60590'>pPager</a>           60590 libdb/sqlite3.c       nRef, sqlite3PagerRefcount(pBt-&gt;pPager)</span>
<span class='curline'><a href='../S/185.html#L60617'>pPager</a>           60617 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L60618'>pPager</a>           60618 libdb/sqlite3.c   return sqlite3PagerFilename(p-&gt;pBt-&gt;pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L60630'>pPager</a>           60630 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L60631'>pPager</a>           60631 libdb/sqlite3.c   return sqlite3PagerJournalname(p-&gt;pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L60659'>pPager</a>           60659 libdb/sqlite3.c       rc = sqlite3PagerCheckpoint(pBt-&gt;pPager, eMode, pnLog, pnCkpt);</span>
<span class='curline'><a href='../S/185.html#L74732'>pPager</a>           74732 libdb/sqlite3.c   Pager *pPager;                  /* Pager associated with pBt */</span>
<span class='curline'><a href='../S/185.html#L74752'>pPager</a>           74752 libdb/sqlite3.c   pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L74753'>pPager</a>           74753 libdb/sqlite3.c   eOld = sqlite3PagerGetJournalMode(pPager);</span>
<span class='curline'><a href='../S/185.html#L74755'>pPager</a>           74755 libdb/sqlite3.c   if( !sqlite3PagerOkToChangeJournalMode(pPager) ) eNew = eOld;</span>
<span class='curline'><a href='../S/185.html#L74758'>pPager</a>           74758 libdb/sqlite3.c   zFilename = sqlite3PagerFilename(pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L74765'>pPager</a>           74765 libdb/sqlite3.c        || !sqlite3PagerWalSupported(pPager))   /* No shared-memory support */</span>
<span class='curline'><a href='../S/185.html#L74788'>pPager</a>           74788 libdb/sqlite3.c         rc = sqlite3PagerCloseWal(pPager);</span>
<span class='curline'><a href='../S/185.html#L74790'>pPager</a>           74790 libdb/sqlite3.c           sqlite3PagerSetJournalMode(pPager, eNew);</span>
<span class='curline'><a href='../S/185.html#L74795'>pPager</a>           74795 libdb/sqlite3.c         sqlite3PagerSetJournalMode(pPager, PAGER_JOURNALMODE_OFF);</span>
<span class='curline'><a href='../S/185.html#L74812'>pPager</a>           74812 libdb/sqlite3.c   eNew = sqlite3PagerSetJournalMode(pPager, eNew);</span>
<span class='curline'><a href='../S/185.html#L87806'>pPager</a>           87806 libdb/sqlite3.c     Pager *pPager;</span>
<span class='curline'><a href='../S/185.html#L87815'>pPager</a>           87815 libdb/sqlite3.c     pPager = sqlite3BtreePager(aNew-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L87816'>pPager</a>           87816 libdb/sqlite3.c     sqlite3PagerLockingMode(pPager, db-&gt;dfltLockMode);</span>
<span class='curline'><a href='../S/185.html#L101704'>pPager</a>           101704 libdb/sqlite3.c       Pager *pPager;</span>
<span class='curline'><a href='../S/185.html#L101717'>pPager</a>           101717 libdb/sqlite3.c           pPager = sqlite3BtreePager(db-&gt;aDb[ii].pBt);</span>
<span class='curline'><a href='../S/185.html#L101718'>pPager</a>           101718 libdb/sqlite3.c           sqlite3PagerLockingMode(pPager, eMode);</span>
<span class='curline'><a href='../S/185.html#L101722'>pPager</a>           101722 libdb/sqlite3.c       pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L101723'>pPager</a>           101723 libdb/sqlite3.c       eMode = sqlite3PagerLockingMode(pPager, eMode);</span>
<span class='curline'><a href='../S/185.html#L101788'>pPager</a>           101788 libdb/sqlite3.c     Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L101794'>pPager</a>           101794 libdb/sqlite3.c     iLimit = sqlite3PagerJournalSizeLimit(pPager, iLimit);</span>
<span class='curline'><a href='../S/185.html#L102065'>pPager</a>           102065 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L102067'>pPager</a>           102067 libdb/sqlite3.c       sqlite3_file *pFile = sqlite3PagerFile(pPager);</span>
<span class='curline'><a href='../S/185.html#L102079'>pPager</a>           102079 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L102080'>pPager</a>           102080 libdb/sqlite3.c       sqlite3_file *pFile = sqlite3PagerFile(pPager);</span>
<span class='curline'><a href='../S/185.html#L125526'>pPager</a>           125526 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L125527'>pPager</a>           125527 libdb/sqlite3.c       sqlite3PagerShrink(pPager);</span>
<span class='curline'><a href='../S/185.html#L127971'>pPager</a>           127971 libdb/sqlite3.c     Pager *pPager;</span>
<span class='curline'><a href='../S/185.html#L127974'>pPager</a>           127974 libdb/sqlite3.c     pPager = sqlite3BtreePager(pBtree);</span>
<span class='curline'><a href='../S/185.html#L127975'>pPager</a>           127975 libdb/sqlite3.c     assert( pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L127976'>pPager</a>           127976 libdb/sqlite3.c     fd = sqlite3PagerFile(pPager);</span>
</pre>
</body>
</html>
