<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pBt</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/185.html#L9126'>pBt</a>              9126 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3BtreeSetVersion(Btree *pBt, int iVersion);</span>
<span class='curline'><a href='../S/185.html#L9128'>pBt</a>              9128 libdb/sqlite3.c SQLITE_PRIVATE int sqlite3BtreeIsReadonly(Btree *pBt);</span>
<span class='curline'><a href='../S/185.html#L10420'>pBt</a>              10420 libdb/sqlite3.c   Btree *pBt;          /* The B*Tree structure for this database file */</span>
<span class='curline'><a href='../S/185.html#L14088'>pBt</a>              14088 libdb/sqlite3.c   Btree *pBt;           /* Separate file holding temporary table */</span>
<span class='curline'><a href='../S/185.html#L14638'>pBt</a>              14638 libdb/sqlite3.c         Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L14639'>pBt</a>              14639 libdb/sqlite3.c         if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L14640'>pBt</a>              14640 libdb/sqlite3.c           Pager *pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L14729'>pBt</a>              14729 libdb/sqlite3.c         if( db-&gt;aDb[i].pBt ){</span>
<span class='curline'><a href='../S/185.html#L14730'>pBt</a>              14730 libdb/sqlite3.c           Pager *pPager = sqlite3BtreePager(db-&gt;aDb[i].pBt);</span>
<span class='curline'><a href='../S/185.html#L16981'>pBt</a>              16981 libdb/sqlite3.c   void **pBt;</span>
<span class='curline'><a href='../S/185.html#L16995'>pBt</a>              16995 libdb/sqlite3.c     pBt = (void**)&amp;z[mem.nTitle];</span>
<span class='curline'><a href='../S/185.html#L16996'>pBt</a>              16996 libdb/sqlite3.c     pHdr = (struct MemBlockHdr*)&amp;pBt[mem.nBacktrace];</span>
<span class='curline'><a href='../S/185.html#L17012'>pBt</a>              17012 libdb/sqlite3.c       memcpy(pBt, &amp;aAddr[1], pHdr-&gt;nBacktrace*sizeof(void*));</span>
<span class='curline'><a href='../S/185.html#L17013'>pBt</a>              17013 libdb/sqlite3.c       assert(pBt[0]);</span>
<span class='curline'><a href='../S/185.html#L17040'>pBt</a>              17040 libdb/sqlite3.c   void **pBt;</span>
<span class='curline'><a href='../S/185.html#L17045'>pBt</a>              17045 libdb/sqlite3.c   pBt = (void**)pHdr;</span>
<span class='curline'><a href='../S/185.html#L17046'>pBt</a>              17046 libdb/sqlite3.c   pBt -= pHdr-&gt;nBacktraceSlots;</span>
<span class='curline'><a href='../S/185.html#L17062'>pBt</a>              17062 libdb/sqlite3.c   z = (char*)pBt;</span>
<span class='curline'><a href='../S/185.html#L17203'>pBt</a>              17203 libdb/sqlite3.c     void **pBt = (void**)pHdr;</span>
<span class='curline'><a href='../S/185.html#L17204'>pBt</a>              17204 libdb/sqlite3.c     pBt -= pHdr-&gt;nBacktraceSlots;</span>
<span class='curline'><a href='../S/185.html#L17205'>pBt</a>              17205 libdb/sqlite3.c     mem.xBacktrace((int)pHdr-&gt;iSize, pHdr-&gt;nBacktrace-1, &amp;pBt[1]);</span>
<span class='curline'><a href='../S/185.html#L17216'>pBt</a>              17216 libdb/sqlite3.c   void **pBt;</span>
<span class='curline'><a href='../S/185.html#L17231'>pBt</a>              17231 libdb/sqlite3.c       pBt = (void**)pHdr;</span>
<span class='curline'><a href='../S/185.html#L17232'>pBt</a>              17232 libdb/sqlite3.c       pBt -= pHdr-&gt;nBacktraceSlots;</span>
<span class='curline'><a href='../S/185.html#L17233'>pBt</a>              17233 libdb/sqlite3.c       backtrace_symbols_fd(pBt, pHdr-&gt;nBacktrace, fileno(out));</span>
<span class='curline'><a href='../S/185.html#L51448'>pBt</a>              51448 libdb/sqlite3.c #define MX_CELL_SIZE(pBt)  ((int)(pBt-&gt;pageSize-8))</span>
<span class='curline'><a href='../S/185.html#L51455'>pBt</a>              51455 libdb/sqlite3.c #define MX_CELL(pBt) ((pBt-&gt;pageSize-8)/6)</span>
<span class='curline'><a href='../S/185.html#L51518'>pBt</a>              51518 libdb/sqlite3.c   BtShared *pBt;       /* Pointer to BtShared that this page is part of */</span>
<span class='curline'><a href='../S/185.html#L51574'>pBt</a>              51574 libdb/sqlite3.c   BtShared *pBt;     /* Sharable content of this btree */</span>
<span class='curline'><a href='../S/185.html#L51721'>pBt</a>              51721 libdb/sqlite3.c   BtShared *pBt;            /* The BtShared this cursor points to */</span>
<span class='curline'><a href='../S/185.html#L51787'>pBt</a>              51787 libdb/sqlite3.c # define PENDING_BYTE_PAGE(pBt) PAGER_MJ_PGNO(pBt)</span>
<span class='curline'><a href='../S/185.html#L51804'>pBt</a>              51804 libdb/sqlite3.c #define PTRMAP_PAGENO(pBt, pgno) ptrmapPageno(pBt, pgno)</span>
<span class='curline'><a href='../S/185.html#L51806'>pBt</a>              51806 libdb/sqlite3.c #define PTRMAP_ISPAGE(pBt, pgno) (PTRMAP_PAGENO((pBt),(pgno))==(pgno))</span>
<span class='curline'><a href='../S/185.html#L51849'>pBt</a>              51849 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;inTransaction!=TRANS_NONE || p-&gt;pBt-&gt;nTransaction==0 ); \</span>
<span class='curline'><a href='../S/185.html#L51850'>pBt</a>              51850 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;inTransaction&gt;=p-&gt;inTrans ); </span>
<span class='curline'><a href='../S/185.html#L51861'>pBt</a>              51861 libdb/sqlite3.c #define ISAUTOVACUUM (pBt-&gt;autoVacuum)</span>
<span class='curline'><a href='../S/185.html#L51879'>pBt</a>              51879 libdb/sqlite3.c   BtShared *pBt;    /* The tree being checked out */</span>
<span class='curline'><a href='../S/185.html#L51911'>pBt</a>              51911 libdb/sqlite3.c   assert( sqlite3_mutex_notheld(p-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L51914'>pBt</a>              51914 libdb/sqlite3.c   sqlite3_mutex_enter(p-&gt;pBt-&gt;mutex);</span>
<span class='curline'><a href='../S/185.html#L51915'>pBt</a>              51915 libdb/sqlite3.c   p-&gt;pBt-&gt;db = p-&gt;db;</span>
<span class='curline'><a href='../S/185.html#L51924'>pBt</a>              51924 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L51926'>pBt</a>              51926 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L51928'>pBt</a>              51928 libdb/sqlite3.c   assert( p-&gt;db==pBt-&gt;db );</span>
<span class='curline'><a href='../S/185.html#L51930'>pBt</a>              51930 libdb/sqlite3.c   sqlite3_mutex_leave(pBt-&gt;mutex);</span>
<span class='curline'><a href='../S/185.html#L51958'>pBt</a>              51958 libdb/sqlite3.c   assert( p-&gt;pNext==0 || p-&gt;pNext-&gt;pBt&gt;p-&gt;pBt );</span>
<span class='curline'><a href='../S/185.html#L51959'>pBt</a>              51959 libdb/sqlite3.c   assert( p-&gt;pPrev==0 || p-&gt;pPrev-&gt;pBt&lt;p-&gt;pBt );</span>
<span class='curline'><a href='../S/185.html#L51973'>pBt</a>              51973 libdb/sqlite3.c   assert( (p-&gt;locked==0 &amp;&amp; p-&gt;sharable) || p-&gt;pBt-&gt;db==p-&gt;db );</span>
<span class='curline'><a href='../S/185.html#L51994'>pBt</a>              51994 libdb/sqlite3.c   if( sqlite3_mutex_try(p-&gt;pBt-&gt;mutex)==SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L51995'>pBt</a>              51995 libdb/sqlite3.c     p-&gt;pBt-&gt;db = p-&gt;db;</span>
<span class='curline'><a href='../S/185.html#L52007'>pBt</a>              52007 libdb/sqlite3.c     assert( pLater-&gt;pNext==0 || pLater-&gt;pNext-&gt;pBt&gt;pLater-&gt;pBt );</span>
<span class='curline'><a href='../S/185.html#L52044'>pBt</a>              52044 libdb/sqlite3.c   assert( p-&gt;sharable==0 || p-&gt;locked==0 || p-&gt;db==p-&gt;pBt-&gt;db );</span>
<span class='curline'><a href='../S/185.html#L52045'>pBt</a>              52045 libdb/sqlite3.c   assert( p-&gt;sharable==0 || p-&gt;locked==0 || sqlite3_mutex_held(p-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L52087'>pBt</a>              52087 libdb/sqlite3.c     p = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L52096'>pBt</a>              52096 libdb/sqlite3.c     p = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L52123'>pBt</a>              52123 libdb/sqlite3.c     p = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L52125'>pBt</a>              52125 libdb/sqlite3.c          (p-&gt;wantToLock==0 || !sqlite3_mutex_held(p-&gt;pBt-&gt;mutex)) ){</span>
<span class='curline'><a href='../S/185.html#L52152'>pBt</a>              52152 libdb/sqlite3.c   p = db-&gt;aDb[iDb].pBt;</span>
<span class='curline'><a href='../S/185.html#L52170'>pBt</a>              52170 libdb/sqlite3.c   p-&gt;pBt-&gt;db = p-&gt;db;</span>
<span class='curline'><a href='../S/185.html#L52175'>pBt</a>              52175 libdb/sqlite3.c     Btree *p = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L52177'>pBt</a>              52177 libdb/sqlite3.c       p-&gt;pBt-&gt;db = p-&gt;db;</span>
<span class='curline'><a href='../S/185.html#L52330'>pBt</a>              52330 libdb/sqlite3.c   Schema *pSchema = (Schema *)pBtree-&gt;pBt-&gt;pSchema;</span>
<span class='curline'><a href='../S/185.html#L52372'>pBt</a>              52372 libdb/sqlite3.c   for(pLock=pBtree-&gt;pBt-&gt;pLock; pLock; pLock=pLock-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52407'>pBt</a>              52407 libdb/sqlite3.c   for(p=pBtree-&gt;pBt-&gt;pCursor; p; p=p-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52426'>pBt</a>              52426 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L52438'>pBt</a>              52438 libdb/sqlite3.c   assert( eLock==READ_LOCK || (p==pBt-&gt;pWriter &amp;&amp; p-&gt;inTrans==TRANS_WRITE) );</span>
<span class='curline'><a href='../S/185.html#L52439'>pBt</a>              52439 libdb/sqlite3.c   assert( eLock==READ_LOCK || pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L52449'>pBt</a>              52449 libdb/sqlite3.c   if( pBt-&gt;pWriter!=p &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_EXCLUSIVE)!=0 ){</span>
<span class='curline'><a href='../S/185.html#L52450'>pBt</a>              52450 libdb/sqlite3.c     sqlite3ConnectionBlocked(p-&gt;db, pBt-&gt;pWriter-&gt;db);</span>
<span class='curline'><a href='../S/185.html#L52454'>pBt</a>              52454 libdb/sqlite3.c   for(pIter=pBt-&gt;pLock; pIter; pIter=pIter-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52469'>pBt</a>              52469 libdb/sqlite3.c         assert( p==pBt-&gt;pWriter );</span>
<span class='curline'><a href='../S/185.html#L52470'>pBt</a>              52470 libdb/sqlite3.c         pBt-&gt;btsFlags |= BTS_PENDING;</span>
<span class='curline'><a href='../S/185.html#L52498'>pBt</a>              52498 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L52518'>pBt</a>              52518 libdb/sqlite3.c   for(pIter=pBt-&gt;pLock; pIter; pIter=pIter-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52535'>pBt</a>              52535 libdb/sqlite3.c     pLock-&gt;pNext = pBt-&gt;pLock;</span>
<span class='curline'><a href='../S/185.html#L52536'>pBt</a>              52536 libdb/sqlite3.c     pBt-&gt;pLock = pLock;</span>
<span class='curline'><a href='../S/185.html#L52562'>pBt</a>              52562 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L52563'>pBt</a>              52563 libdb/sqlite3.c   BtLock **ppIter = &amp;pBt-&gt;pLock;</span>
<span class='curline'><a href='../S/185.html#L52571'>pBt</a>              52571 libdb/sqlite3.c     assert( (pBt-&gt;btsFlags &amp; BTS_EXCLUSIVE)==0 || pBt-&gt;pWriter==pLock-&gt;pBtree );</span>
<span class='curline'><a href='../S/185.html#L52584'>pBt</a>              52584 libdb/sqlite3.c   assert( (pBt-&gt;btsFlags &amp; BTS_PENDING)==0 || pBt-&gt;pWriter );</span>
<span class='curline'><a href='../S/185.html#L52585'>pBt</a>              52585 libdb/sqlite3.c   if( pBt-&gt;pWriter==p ){</span>
<span class='curline'><a href='../S/185.html#L52586'>pBt</a>              52586 libdb/sqlite3.c     pBt-&gt;pWriter = 0;</span>
<span class='curline'><a href='../S/185.html#L52587'>pBt</a>              52587 libdb/sqlite3.c     pBt-&gt;btsFlags &amp;= ~(BTS_EXCLUSIVE|BTS_PENDING);</span>
<span class='curline'><a href='../S/185.html#L52588'>pBt</a>              52588 libdb/sqlite3.c   }else if( pBt-&gt;nTransaction==2 ){</span>
<span class='curline'><a href='../S/185.html#L52598'>pBt</a>              52598 libdb/sqlite3.c     pBt-&gt;btsFlags &amp;= ~BTS_PENDING;</span>
<span class='curline'><a href='../S/185.html#L52606'>pBt</a>              52606 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L52607'>pBt</a>              52607 libdb/sqlite3.c   if( pBt-&gt;pWriter==p ){</span>
<span class='curline'><a href='../S/185.html#L52609'>pBt</a>              52609 libdb/sqlite3.c     pBt-&gt;pWriter = 0;</span>
<span class='curline'><a href='../S/185.html#L52610'>pBt</a>              52610 libdb/sqlite3.c     pBt-&gt;btsFlags &amp;= ~(BTS_EXCLUSIVE|BTS_PENDING);</span>
<span class='curline'><a href='../S/185.html#L52611'>pBt</a>              52611 libdb/sqlite3.c     for(pLock=pBt-&gt;pLock; pLock; pLock=pLock-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52629'>pBt</a>              52629 libdb/sqlite3.c   return sqlite3_mutex_held(p-&gt;pBt-&gt;mutex);</span>
<span class='curline'><a href='../S/185.html#L52643'>pBt</a>              52643 libdb/sqlite3.c static void invalidateAllOverflowCache(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L52645'>pBt</a>              52645 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L52646'>pBt</a>              52646 libdb/sqlite3.c   for(p=pBt-&gt;pCursor; p; p=p-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52671'>pBt</a>              52671 libdb/sqlite3.c   BtShared *pBt = pBtree-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L52673'>pBt</a>              52673 libdb/sqlite3.c   for(p=pBt-&gt;pCursor; p; p=p-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L52722'>pBt</a>              52722 libdb/sqlite3.c static int btreeSetHasContent(BtShared *pBt, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L52724'>pBt</a>              52724 libdb/sqlite3.c   if( !pBt-&gt;pHasContent ){</span>
<span class='curline'><a href='../S/185.html#L52725'>pBt</a>              52725 libdb/sqlite3.c     assert( pgno&lt;=pBt-&gt;nPage );</span>
<span class='curline'><a href='../S/185.html#L52726'>pBt</a>              52726 libdb/sqlite3.c     pBt-&gt;pHasContent = sqlite3BitvecCreate(pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L52727'>pBt</a>              52727 libdb/sqlite3.c     if( !pBt-&gt;pHasContent ){</span>
<span class='curline'><a href='../S/185.html#L52731'>pBt</a>              52731 libdb/sqlite3.c   if( rc==SQLITE_OK &amp;&amp; pgno&lt;=sqlite3BitvecSize(pBt-&gt;pHasContent) ){</span>
<span class='curline'><a href='../S/185.html#L52732'>pBt</a>              52732 libdb/sqlite3.c     rc = sqlite3BitvecSet(pBt-&gt;pHasContent, pgno);</span>
<span class='curline'><a href='../S/185.html#L52744'>pBt</a>              52744 libdb/sqlite3.c static int btreeGetHasContent(BtShared *pBt, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L52745'>pBt</a>              52745 libdb/sqlite3.c   Bitvec *p = pBt-&gt;pHasContent;</span>
<span class='curline'><a href='../S/185.html#L52753'>pBt</a>              52753 libdb/sqlite3.c static void btreeClearHasContent(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L52754'>pBt</a>              52754 libdb/sqlite3.c   sqlite3BitvecDestroy(pBt-&gt;pHasContent);</span>
<span class='curline'><a href='../S/185.html#L52755'>pBt</a>              52755 libdb/sqlite3.c   pBt-&gt;pHasContent = 0;</span>
<span class='curline'><a href='../S/185.html#L52833'>pBt</a>              52833 libdb/sqlite3.c static int saveAllCursors(BtShared *pBt, Pgno iRoot, BtCursor *pExcept){</span>
<span class='curline'><a href='../S/185.html#L52835'>pBt</a>              52835 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L52836'>pBt</a>              52836 libdb/sqlite3.c   assert( pExcept==0 || pExcept-&gt;pBt==pBt );</span>
<span class='curline'><a href='../S/185.html#L52837'>pBt</a>              52837 libdb/sqlite3.c   for(p=pBt-&gt;pCursor; p; p=p-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L53007'>pBt</a>              53007 libdb/sqlite3.c static Pgno ptrmapPageno(BtShared *pBt, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L53010'>pBt</a>              53010 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53012'>pBt</a>              53012 libdb/sqlite3.c   nPagesPerMapPage = (pBt-&gt;usableSize/5)+1;</span>
<span class='curline'><a href='../S/185.html#L53015'>pBt</a>              53015 libdb/sqlite3.c   if( ret==PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L53031'>pBt</a>              53031 libdb/sqlite3.c static void ptrmapPut(BtShared *pBt, Pgno key, u8 eType, Pgno parent, int *pRC){</span>
<span class='curline'><a href='../S/185.html#L53040'>pBt</a>              53040 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53042'>pBt</a>              53042 libdb/sqlite3.c   assert( 0==PTRMAP_ISPAGE(pBt, PENDING_BYTE_PAGE(pBt)) );</span>
<span class='curline'><a href='../S/185.html#L53044'>pBt</a>              53044 libdb/sqlite3.c   assert( pBt-&gt;autoVacuum );</span>
<span class='curline'><a href='../S/185.html#L53049'>pBt</a>              53049 libdb/sqlite3.c   iPtrmap = PTRMAP_PAGENO(pBt, key);</span>
<span class='curline'><a href='../S/185.html#L53050'>pBt</a>              53050 libdb/sqlite3.c   rc = sqlite3PagerGet(pBt-&gt;pPager, iPtrmap, &amp;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L53060'>pBt</a>              53060 libdb/sqlite3.c   assert( offset &lt;= (int)pBt-&gt;usableSize-5 );</span>
<span class='curline'><a href='../S/185.html#L53083'>pBt</a>              53083 libdb/sqlite3.c static int ptrmapGet(BtShared *pBt, Pgno key, u8 *pEType, Pgno *pPgno){</span>
<span class='curline'><a href='../S/185.html#L53090'>pBt</a>              53090 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53092'>pBt</a>              53092 libdb/sqlite3.c   iPtrmap = PTRMAP_PAGENO(pBt, key);</span>
<span class='curline'><a href='../S/185.html#L53093'>pBt</a>              53093 libdb/sqlite3.c   rc = sqlite3PagerGet(pBt-&gt;pPager, iPtrmap, &amp;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L53104'>pBt</a>              53104 libdb/sqlite3.c   assert( offset &lt;= (int)pBt-&gt;usableSize-5 );</span>
<span class='curline'><a href='../S/185.html#L53138'>pBt</a>              53138 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53166'>pBt</a>              53166 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53213'>pBt</a>              53213 libdb/sqlite3.c     surplus = minLocal + (nPayload - minLocal)%(pPage-&gt;pBt-&gt;usableSize - 4);</span>
<span class='curline'><a href='../S/185.html#L53282'>pBt</a>              53282 libdb/sqlite3.c     nSize = minLocal + (nSize - minLocal) % (pPage-&gt;pBt-&gt;usableSize - 4);</span>
<span class='curline'><a href='../S/185.html#L53315'>pBt</a>              53315 libdb/sqlite3.c     ptrmapPut(pPage-&gt;pBt, ovfl, PTRMAP_OVERFLOW1, pPage-&gt;pgno, pRC);</span>
<span class='curline'><a href='../S/185.html#L53343'>pBt</a>              53343 libdb/sqlite3.c   assert( pPage-&gt;pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L53344'>pBt</a>              53344 libdb/sqlite3.c   assert( pPage-&gt;pBt-&gt;usableSize &lt;= SQLITE_MAX_PAGE_SIZE );</span>
<span class='curline'><a href='../S/185.html#L53346'>pBt</a>              53346 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53347'>pBt</a>              53347 libdb/sqlite3.c   temp = sqlite3PagerTempSpace(pPage-&gt;pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L53353'>pBt</a>              53353 libdb/sqlite3.c   usableSize = pPage-&gt;pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L53426'>pBt</a>              53426 libdb/sqlite3.c   assert( pPage-&gt;pBt );</span>
<span class='curline'><a href='../S/185.html#L53427'>pBt</a>              53427 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53431'>pBt</a>              53431 libdb/sqlite3.c   usableSize = pPage-&gt;pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L53506'>pBt</a>              53506 libdb/sqlite3.c   assert( top+nByte &lt;= (int)pPage-&gt;pBt-&gt;usableSize );</span>
<span class='curline'><a href='../S/185.html#L53530'>pBt</a>              53530 libdb/sqlite3.c   u32 iLast = pPage-&gt;pBt-&gt;usableSize-4; /* Largest possible freeblock offset */</span>
<span class='curline'><a href='../S/185.html#L53534'>pBt</a>              53534 libdb/sqlite3.c   assert( pPage-&gt;pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L53537'>pBt</a>              53537 libdb/sqlite3.c   assert( iEnd &lt;= pPage-&gt;pBt-&gt;usableSize );</span>
<span class='curline'><a href='../S/185.html#L53538'>pBt</a>              53538 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53544'>pBt</a>              53544 libdb/sqlite3.c   if( pPage-&gt;pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE ){</span>
<span class='curline'><a href='../S/185.html#L53623'>pBt</a>              53623 libdb/sqlite3.c   BtShared *pBt;     /* A copy of pPage-&gt;pBt */</span>
<span class='curline'><a href='../S/185.html#L53626'>pBt</a>              53626 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53630'>pBt</a>              53630 libdb/sqlite3.c   pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L53635'>pBt</a>              53635 libdb/sqlite3.c     pPage-&gt;maxLocal = pBt-&gt;maxLeaf;</span>
<span class='curline'><a href='../S/185.html#L53636'>pBt</a>              53636 libdb/sqlite3.c     pPage-&gt;minLocal = pBt-&gt;minLeaf;</span>
<span class='curline'><a href='../S/185.html#L53641'>pBt</a>              53641 libdb/sqlite3.c     pPage-&gt;maxLocal = pBt-&gt;maxLocal;</span>
<span class='curline'><a href='../S/185.html#L53642'>pBt</a>              53642 libdb/sqlite3.c     pPage-&gt;minLocal = pBt-&gt;minLocal;</span>
<span class='curline'><a href='../S/185.html#L53646'>pBt</a>              53646 libdb/sqlite3.c   pPage-&gt;max1bytePayload = pBt-&gt;max1bytePayload;</span>
<span class='curline'><a href='../S/185.html#L53661'>pBt</a>              53661 libdb/sqlite3.c   assert( pPage-&gt;pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L53662'>pBt</a>              53662 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53671'>pBt</a>              53671 libdb/sqlite3.c     BtShared *pBt;        /* The main btree structure */</span>
<span class='curline'><a href='../S/185.html#L53679'>pBt</a>              53679 libdb/sqlite3.c     pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L53684'>pBt</a>              53684 libdb/sqlite3.c     assert( pBt-&gt;pageSize&gt;=512 &amp;&amp; pBt-&gt;pageSize&lt;=65536 );</span>
<span class='curline'><a href='../S/185.html#L53685'>pBt</a>              53685 libdb/sqlite3.c     pPage-&gt;maskPage = (u16)(pBt-&gt;pageSize - 1);</span>
<span class='curline'><a href='../S/185.html#L53687'>pBt</a>              53687 libdb/sqlite3.c     usableSize = pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L53693'>pBt</a>              53693 libdb/sqlite3.c     if( pPage-&gt;nCell&gt;MX_CELL(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L53697'>pBt</a>              53697 libdb/sqlite3.c     testcase( pPage-&gt;nCell==MX_CELL(pBt) );</span>
<span class='curline'><a href='../S/185.html#L53773'>pBt</a>              53773 libdb/sqlite3.c   BtShared *pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L53781'>pBt</a>              53781 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53782'>pBt</a>              53782 libdb/sqlite3.c   if( pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE ){</span>
<span class='curline'><a href='../S/185.html#L53783'>pBt</a>              53783 libdb/sqlite3.c     memset(&amp;data[hdr], 0, pBt-&gt;usableSize - hdr);</span>
<span class='curline'><a href='../S/185.html#L53789'>pBt</a>              53789 libdb/sqlite3.c   put2byte(&amp;data[hdr+5], pBt-&gt;usableSize);</span>
<span class='curline'><a href='../S/185.html#L53790'>pBt</a>              53790 libdb/sqlite3.c   pPage-&gt;nFree = (u16)(pBt-&gt;usableSize - first);</span>
<span class='curline'><a href='../S/185.html#L53793'>pBt</a>              53793 libdb/sqlite3.c   pPage-&gt;aDataEnd = &amp;data[pBt-&gt;usableSize];</span>
<span class='curline'><a href='../S/185.html#L53796'>pBt</a>              53796 libdb/sqlite3.c   assert( pBt-&gt;pageSize&gt;=512 &amp;&amp; pBt-&gt;pageSize&lt;=65536 );</span>
<span class='curline'><a href='../S/185.html#L53797'>pBt</a>              53797 libdb/sqlite3.c   pPage-&gt;maskPage = (u16)(pBt-&gt;pageSize - 1);</span>
<span class='curline'><a href='../S/185.html#L53807'>pBt</a>              53807 libdb/sqlite3.c static MemPage *btreePageFromDbPage(DbPage *pDbPage, Pgno pgno, BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L53811'>pBt</a>              53811 libdb/sqlite3.c   pPage-&gt;pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L53829'>pBt</a>              53829 libdb/sqlite3.c   BtShared *pBt,       /* The btree */</span>
<span class='curline'><a href='../S/185.html#L53838'>pBt</a>              53838 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53839'>pBt</a>              53839 libdb/sqlite3.c   rc = sqlite3PagerAcquire(pBt-&gt;pPager, pgno, (DbPage**)&amp;pDbPage, flags);</span>
<span class='curline'><a href='../S/185.html#L53841'>pBt</a>              53841 libdb/sqlite3.c   *ppPage = btreePageFromDbPage(pDbPage, pgno, pBt);</span>
<span class='curline'><a href='../S/185.html#L53850'>pBt</a>              53850 libdb/sqlite3.c static MemPage *btreePageLookup(BtShared *pBt, Pgno pgno){</span>
<span class='curline'><a href='../S/185.html#L53852'>pBt</a>              53852 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53853'>pBt</a>              53853 libdb/sqlite3.c   pDbPage = sqlite3PagerLookup(pBt-&gt;pPager, pgno);</span>
<span class='curline'><a href='../S/185.html#L53855'>pBt</a>              53855 libdb/sqlite3.c     return btreePageFromDbPage(pDbPage, pgno, pBt);</span>
<span class='curline'><a href='../S/185.html#L53864'>pBt</a>              53864 libdb/sqlite3.c static Pgno btreePagecount(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L53865'>pBt</a>              53865 libdb/sqlite3.c   return pBt-&gt;nPage;</span>
<span class='curline'><a href='../S/185.html#L53869'>pBt</a>              53869 libdb/sqlite3.c   assert( ((p-&gt;pBt-&gt;nPage)&amp;0x8000000)==0 );</span>
<span class='curline'><a href='../S/185.html#L53870'>pBt</a>              53870 libdb/sqlite3.c   return btreePagecount(p-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L53882'>pBt</a>              53882 libdb/sqlite3.c   BtShared *pBt,                  /* The database file */</span>
<span class='curline'><a href='../S/185.html#L53888'>pBt</a>              53888 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53891'>pBt</a>              53891 libdb/sqlite3.c   if( pgno&gt;btreePagecount(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L53894'>pBt</a>              53894 libdb/sqlite3.c     rc = btreeGetPage(pBt, pgno, ppPage, bReadonly);</span>
<span class='curline'><a href='../S/185.html#L53915'>pBt</a>              53915 libdb/sqlite3.c     assert( pPage-&gt;pBt );</span>
<span class='curline'><a href='../S/185.html#L53919'>pBt</a>              53919 libdb/sqlite3.c     assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53937'>pBt</a>              53937 libdb/sqlite3.c     assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53955'>pBt</a>              53955 libdb/sqlite3.c   BtShared *pBt = (BtShared*)pArg;</span>
<span class='curline'><a href='../S/185.html#L53956'>pBt</a>              53956 libdb/sqlite3.c   assert( pBt-&gt;db );</span>
<span class='curline'><a href='../S/185.html#L53957'>pBt</a>              53957 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;db-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L53958'>pBt</a>              53958 libdb/sqlite3.c   return sqlite3InvokeBusyHandler(&amp;pBt-&gt;db-&gt;busyHandler);</span>
<span class='curline'><a href='../S/185.html#L53990'>pBt</a>              53990 libdb/sqlite3.c   BtShared *pBt = 0;             /* Shared part of btree structure */</span>
<span class='curline'><a href='../S/185.html#L54071'>pBt</a>              54071 libdb/sqlite3.c       for(pBt=GLOBAL(BtShared*,sqlite3SharedCacheList); pBt; pBt=pBt-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L54072'>pBt</a>              54072 libdb/sqlite3.c         assert( pBt-&gt;nRef&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L54073'>pBt</a>              54073 libdb/sqlite3.c         if( 0==strcmp(zFullPathname, sqlite3PagerFilename(pBt-&gt;pPager, 0))</span>
<span class='curline'><a href='../S/185.html#L54074'>pBt</a>              54074 libdb/sqlite3.c                  &amp;&amp; sqlite3PagerVfs(pBt-&gt;pPager)==pVfs ){</span>
<span class='curline'><a href='../S/185.html#L54077'>pBt</a>              54077 libdb/sqlite3.c             Btree *pExisting = db-&gt;aDb[iDb].pBt;</span>
<span class='curline'><a href='../S/185.html#L54078'>pBt</a>              54078 libdb/sqlite3.c             if( pExisting &amp;&amp; pExisting-&gt;pBt==pBt ){</span>
<span class='curline'><a href='../S/185.html#L54086'>pBt</a>              54086 libdb/sqlite3.c           p-&gt;pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L54087'>pBt</a>              54087 libdb/sqlite3.c           pBt-&gt;nRef++;</span>
<span class='curline'><a href='../S/185.html#L54106'>pBt</a>              54106 libdb/sqlite3.c   if( pBt==0 ){</span>
<span class='curline'><a href='../S/185.html#L54118'>pBt</a>              54118 libdb/sqlite3.c     pBt = sqlite3MallocZero( sizeof(*pBt) );</span>
<span class='curline'><a href='../S/185.html#L54119'>pBt</a>              54119 libdb/sqlite3.c     if( pBt==0 ){</span>
<span class='curline'><a href='../S/185.html#L54123'>pBt</a>              54123 libdb/sqlite3.c     rc = sqlite3PagerOpen(pVfs, &amp;pBt-&gt;pPager, zFilename,</span>
<span class='curline'><a href='../S/185.html#L54126'>pBt</a>              54126 libdb/sqlite3.c       sqlite3PagerSetMmapLimit(pBt-&gt;pPager, db-&gt;szMmap);</span>
<span class='curline'><a href='../S/185.html#L54127'>pBt</a>              54127 libdb/sqlite3.c       rc = sqlite3PagerReadFileheader(pBt-&gt;pPager,sizeof(zDbHeader),zDbHeader);</span>
<span class='curline'><a href='../S/185.html#L54132'>pBt</a>              54132 libdb/sqlite3.c     pBt-&gt;openFlags = (u8)flags;</span>
<span class='curline'><a href='../S/185.html#L54133'>pBt</a>              54133 libdb/sqlite3.c     pBt-&gt;db = db;</span>
<span class='curline'><a href='../S/185.html#L54134'>pBt</a>              54134 libdb/sqlite3.c     sqlite3PagerSetBusyhandler(pBt-&gt;pPager, btreeInvokeBusyHandler, pBt);</span>
<span class='curline'><a href='../S/185.html#L54135'>pBt</a>              54135 libdb/sqlite3.c     p-&gt;pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L54137'>pBt</a>              54137 libdb/sqlite3.c     pBt-&gt;pCursor = 0;</span>
<span class='curline'><a href='../S/185.html#L54138'>pBt</a>              54138 libdb/sqlite3.c     pBt-&gt;pPage1 = 0;</span>
<span class='curline'><a href='../S/185.html#L54139'>pBt</a>              54139 libdb/sqlite3.c     if( sqlite3PagerIsreadonly(pBt-&gt;pPager) ) pBt-&gt;btsFlags |= BTS_READ_ONLY;</span>
<span class='curline'><a href='../S/185.html#L54141'>pBt</a>              54141 libdb/sqlite3.c     pBt-&gt;btsFlags |= BTS_SECURE_DELETE;</span>
<span class='curline'><a href='../S/185.html#L54143'>pBt</a>              54143 libdb/sqlite3.c     pBt-&gt;pageSize = (zDbHeader[16]&lt;&lt;8) | (zDbHeader[17]&lt;&lt;16);</span>
<span class='curline'><a href='../S/185.html#L54144'>pBt</a>              54144 libdb/sqlite3.c     if( pBt-&gt;pageSize&lt;512 || pBt-&gt;pageSize&gt;SQLITE_MAX_PAGE_SIZE</span>
<span class='curline'><a href='../S/185.html#L54145'>pBt</a>              54145 libdb/sqlite3.c          || ((pBt-&gt;pageSize-1)&amp;pBt-&gt;pageSize)!=0 ){</span>
<span class='curline'><a href='../S/185.html#L54146'>pBt</a>              54146 libdb/sqlite3.c       pBt-&gt;pageSize = 0;</span>
<span class='curline'><a href='../S/185.html#L54155'>pBt</a>              54155 libdb/sqlite3.c         pBt-&gt;autoVacuum = (SQLITE_DEFAULT_AUTOVACUUM ? 1 : 0);</span>
<span class='curline'><a href='../S/185.html#L54156'>pBt</a>              54156 libdb/sqlite3.c         pBt-&gt;incrVacuum = (SQLITE_DEFAULT_AUTOVACUUM==2 ? 1 : 0);</span>
<span class='curline'><a href='../S/185.html#L54162'>pBt</a>              54162 libdb/sqlite3.c       pBt-&gt;btsFlags |= BTS_PAGESIZE_FIXED;</span>
<span class='curline'><a href='../S/185.html#L54164'>pBt</a>              54164 libdb/sqlite3.c       pBt-&gt;autoVacuum = (get4byte(&amp;zDbHeader[36 + 4*4])?1:0);</span>
<span class='curline'><a href='../S/185.html#L54165'>pBt</a>              54165 libdb/sqlite3.c       pBt-&gt;incrVacuum = (get4byte(&amp;zDbHeader[36 + 7*4])?1:0);</span>
<span class='curline'><a href='../S/185.html#L54168'>pBt</a>              54168 libdb/sqlite3.c     rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize, nReserve);</span>
<span class='curline'><a href='../S/185.html#L54170'>pBt</a>              54170 libdb/sqlite3.c     pBt-&gt;usableSize = pBt-&gt;pageSize - nReserve;</span>
<span class='curline'><a href='../S/185.html#L54171'>pBt</a>              54171 libdb/sqlite3.c     assert( (pBt-&gt;pageSize &amp; 7)==0 );  /* 8-byte alignment of pageSize */</span>
<span class='curline'><a href='../S/185.html#L54178'>pBt</a>              54178 libdb/sqlite3.c       pBt-&gt;nRef = 1;</span>
<span class='curline'><a href='../S/185.html#L54181'>pBt</a>              54181 libdb/sqlite3.c         pBt-&gt;mutex = sqlite3MutexAlloc(SQLITE_MUTEX_FAST);</span>
<span class='curline'><a href='../S/185.html#L54182'>pBt</a>              54182 libdb/sqlite3.c         if( pBt-&gt;mutex==0 ){</span>
<span class='curline'><a href='../S/185.html#L54189'>pBt</a>              54189 libdb/sqlite3.c       pBt-&gt;pNext = GLOBAL(BtShared*,sqlite3SharedCacheList);</span>
<span class='curline'><a href='../S/185.html#L54190'>pBt</a>              54190 libdb/sqlite3.c       GLOBAL(BtShared*,sqlite3SharedCacheList) = pBt;</span>
<span class='curline'><a href='../S/185.html#L54205'>pBt</a>              54205 libdb/sqlite3.c       if( (pSib = db-&gt;aDb[i].pBt)!=0 &amp;&amp; pSib-&gt;sharable ){</span>
<span class='curline'><a href='../S/185.html#L54207'>pBt</a>              54207 libdb/sqlite3.c         if( p-&gt;pBt&lt;pSib-&gt;pBt ){</span>
<span class='curline'><a href='../S/185.html#L54212'>pBt</a>              54212 libdb/sqlite3.c           while( pSib-&gt;pNext &amp;&amp; pSib-&gt;pNext-&gt;pBt&lt;p-&gt;pBt ){</span>
<span class='curline'><a href='../S/185.html#L54231'>pBt</a>              54231 libdb/sqlite3.c     if( pBt &amp;&amp; pBt-&gt;pPager ){</span>
<span class='curline'><a href='../S/185.html#L54232'>pBt</a>              54232 libdb/sqlite3.c       sqlite3PagerClose(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54234'>pBt</a>              54234 libdb/sqlite3.c     sqlite3_free(pBt);</span>
<span class='curline'><a href='../S/185.html#L54243'>pBt</a>              54243 libdb/sqlite3.c       sqlite3PagerSetCachesize(p-&gt;pBt-&gt;pPager, SQLITE_DEFAULT_CACHE_SIZE);</span>
<span class='curline'><a href='../S/185.html#L54259'>pBt</a>              54259 libdb/sqlite3.c static int removeFromSharingList(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54265'>pBt</a>              54265 libdb/sqlite3.c   assert( sqlite3_mutex_notheld(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L54268'>pBt</a>              54268 libdb/sqlite3.c   pBt-&gt;nRef--;</span>
<span class='curline'><a href='../S/185.html#L54269'>pBt</a>              54269 libdb/sqlite3.c   if( pBt-&gt;nRef&lt;=0 ){</span>
<span class='curline'><a href='../S/185.html#L54270'>pBt</a>              54270 libdb/sqlite3.c     if( GLOBAL(BtShared*,sqlite3SharedCacheList)==pBt ){</span>
<span class='curline'><a href='../S/185.html#L54271'>pBt</a>              54271 libdb/sqlite3.c       GLOBAL(BtShared*,sqlite3SharedCacheList) = pBt-&gt;pNext;</span>
<span class='curline'><a href='../S/185.html#L54274'>pBt</a>              54274 libdb/sqlite3.c       while( ALWAYS(pList) &amp;&amp; pList-&gt;pNext!=pBt ){</span>
<span class='curline'><a href='../S/185.html#L54278'>pBt</a>              54278 libdb/sqlite3.c         pList-&gt;pNext = pBt-&gt;pNext;</span>
<span class='curline'><a href='../S/185.html#L54282'>pBt</a>              54282 libdb/sqlite3.c       sqlite3_mutex_free(pBt-&gt;mutex);</span>
<span class='curline'><a href='../S/185.html#L54298'>pBt</a>              54298 libdb/sqlite3.c static void allocateTempSpace(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54299'>pBt</a>              54299 libdb/sqlite3.c   if( !pBt-&gt;pTmpSpace ){</span>
<span class='curline'><a href='../S/185.html#L54300'>pBt</a>              54300 libdb/sqlite3.c     pBt-&gt;pTmpSpace = sqlite3PageMalloc( pBt-&gt;pageSize );</span>
<span class='curline'><a href='../S/185.html#L54317'>pBt</a>              54317 libdb/sqlite3.c     if( pBt-&gt;pTmpSpace ){</span>
<span class='curline'><a href='../S/185.html#L54318'>pBt</a>              54318 libdb/sqlite3.c       memset(pBt-&gt;pTmpSpace, 0, 8);</span>
<span class='curline'><a href='../S/185.html#L54319'>pBt</a>              54319 libdb/sqlite3.c       pBt-&gt;pTmpSpace += 4;</span>
<span class='curline'><a href='../S/185.html#L54327'>pBt</a>              54327 libdb/sqlite3.c static void freeTempSpace(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54328'>pBt</a>              54328 libdb/sqlite3.c   if( pBt-&gt;pTmpSpace ){</span>
<span class='curline'><a href='../S/185.html#L54329'>pBt</a>              54329 libdb/sqlite3.c     pBt-&gt;pTmpSpace -= 4;</span>
<span class='curline'><a href='../S/185.html#L54330'>pBt</a>              54330 libdb/sqlite3.c     sqlite3PageFree(pBt-&gt;pTmpSpace);</span>
<span class='curline'><a href='../S/185.html#L54331'>pBt</a>              54331 libdb/sqlite3.c     pBt-&gt;pTmpSpace = 0;</span>
<span class='curline'><a href='../S/185.html#L54339'>pBt</a>              54339 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54345'>pBt</a>              54345 libdb/sqlite3.c   pCur = pBt-&gt;pCursor;</span>
<span class='curline'><a href='../S/185.html#L54366'>pBt</a>              54366 libdb/sqlite3.c   if( !p-&gt;sharable || removeFromSharingList(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L54372'>pBt</a>              54372 libdb/sqlite3.c     assert( !pBt-&gt;pCursor );</span>
<span class='curline'><a href='../S/185.html#L54373'>pBt</a>              54373 libdb/sqlite3.c     sqlite3PagerClose(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54374'>pBt</a>              54374 libdb/sqlite3.c     if( pBt-&gt;xFreeSchema &amp;&amp; pBt-&gt;pSchema ){</span>
<span class='curline'><a href='../S/185.html#L54375'>pBt</a>              54375 libdb/sqlite3.c       pBt-&gt;xFreeSchema(pBt-&gt;pSchema);</span>
<span class='curline'><a href='../S/185.html#L54377'>pBt</a>              54377 libdb/sqlite3.c     sqlite3DbFree(0, pBt-&gt;pSchema);</span>
<span class='curline'><a href='../S/185.html#L54378'>pBt</a>              54378 libdb/sqlite3.c     freeTempSpace(pBt);</span>
<span class='curline'><a href='../S/185.html#L54379'>pBt</a>              54379 libdb/sqlite3.c     sqlite3_free(pBt);</span>
<span class='curline'><a href='../S/185.html#L54409'>pBt</a>              54409 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54412'>pBt</a>              54412 libdb/sqlite3.c   sqlite3PagerSetCachesize(pBt-&gt;pPager, mxPage);</span>
<span class='curline'><a href='../S/185.html#L54423'>pBt</a>              54423 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54426'>pBt</a>              54426 libdb/sqlite3.c   sqlite3PagerSetMmapLimit(pBt-&gt;pPager, szMmap);</span>
<span class='curline'><a href='../S/185.html#L54445'>pBt</a>              54445 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54448'>pBt</a>              54448 libdb/sqlite3.c   sqlite3PagerSetFlags(pBt-&gt;pPager, pgFlags);</span>
<span class='curline'><a href='../S/185.html#L54459'>pBt</a>              54459 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54463'>pBt</a>              54463 libdb/sqlite3.c   assert( pBt &amp;&amp; pBt-&gt;pPager );</span>
<span class='curline'><a href='../S/185.html#L54464'>pBt</a>              54464 libdb/sqlite3.c   rc = sqlite3PagerNosync(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54491'>pBt</a>              54491 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54494'>pBt</a>              54494 libdb/sqlite3.c   if( pBt-&gt;btsFlags &amp; BTS_PAGESIZE_FIXED ){</span>
<span class='curline'><a href='../S/185.html#L54499'>pBt</a>              54499 libdb/sqlite3.c     nReserve = pBt-&gt;pageSize - pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L54505'>pBt</a>              54505 libdb/sqlite3.c     assert( !pBt-&gt;pPage1 &amp;&amp; !pBt-&gt;pCursor );</span>
<span class='curline'><a href='../S/185.html#L54506'>pBt</a>              54506 libdb/sqlite3.c     pBt-&gt;pageSize = (u32)pageSize;</span>
<span class='curline'><a href='../S/185.html#L54507'>pBt</a>              54507 libdb/sqlite3.c     freeTempSpace(pBt);</span>
<span class='curline'><a href='../S/185.html#L54509'>pBt</a>              54509 libdb/sqlite3.c   rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize, nReserve);</span>
<span class='curline'><a href='../S/185.html#L54510'>pBt</a>              54510 libdb/sqlite3.c   pBt-&gt;usableSize = pBt-&gt;pageSize - (u16)nReserve;</span>
<span class='curline'><a href='../S/185.html#L54511'>pBt</a>              54511 libdb/sqlite3.c   if( iFix ) pBt-&gt;btsFlags |= BTS_PAGESIZE_FIXED;</span>
<span class='curline'><a href='../S/185.html#L54520'>pBt</a>              54520 libdb/sqlite3.c   return p-&gt;pBt-&gt;pageSize;</span>
<span class='curline'><a href='../S/185.html#L54536'>pBt</a>              54536 libdb/sqlite3.c   assert( sqlite3_mutex_held(p-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L54537'>pBt</a>              54537 libdb/sqlite3.c   return p-&gt;pBt-&gt;pageSize - p-&gt;pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L54550'>pBt</a>              54550 libdb/sqlite3.c   n = p-&gt;pBt-&gt;pageSize - p-&gt;pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L54563'>pBt</a>              54563 libdb/sqlite3.c   n = sqlite3PagerMaxPageCount(p-&gt;pBt-&gt;pPager, mxPage);</span>
<span class='curline'><a href='../S/185.html#L54578'>pBt</a>              54578 libdb/sqlite3.c     p-&gt;pBt-&gt;btsFlags &amp;= ~BTS_SECURE_DELETE;</span>
<span class='curline'><a href='../S/185.html#L54579'>pBt</a>              54579 libdb/sqlite3.c     if( newFlag ) p-&gt;pBt-&gt;btsFlags |= BTS_SECURE_DELETE;</span>
<span class='curline'><a href='../S/185.html#L54581'>pBt</a>              54581 libdb/sqlite3.c   b = (p-&gt;pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE)!=0;</span>
<span class='curline'><a href='../S/185.html#L54597'>pBt</a>              54597 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54602'>pBt</a>              54602 libdb/sqlite3.c   if( (pBt-&gt;btsFlags &amp; BTS_PAGESIZE_FIXED)!=0 &amp;&amp; (av ?1:0)!=pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L54605'>pBt</a>              54605 libdb/sqlite3.c     pBt-&gt;autoVacuum = av ?1:0;</span>
<span class='curline'><a href='../S/185.html#L54606'>pBt</a>              54606 libdb/sqlite3.c     pBt-&gt;incrVacuum = av==2 ?1:0;</span>
<span class='curline'><a href='../S/185.html#L54624'>pBt</a>              54624 libdb/sqlite3.c     (!p-&gt;pBt-&gt;autoVacuum)?BTREE_AUTOVACUUM_NONE:</span>
<span class='curline'><a href='../S/185.html#L54625'>pBt</a>              54625 libdb/sqlite3.c     (!p-&gt;pBt-&gt;incrVacuum)?BTREE_AUTOVACUUM_FULL:</span>
<span class='curline'><a href='../S/185.html#L54643'>pBt</a>              54643 libdb/sqlite3.c static int lockBtree(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54650'>pBt</a>              54650 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L54651'>pBt</a>              54651 libdb/sqlite3.c   assert( pBt-&gt;pPage1==0 );</span>
<span class='curline'><a href='../S/185.html#L54652'>pBt</a>              54652 libdb/sqlite3.c   rc = sqlite3PagerSharedLock(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L54654'>pBt</a>              54654 libdb/sqlite3.c   rc = btreeGetPage(pBt, 1, &amp;pPage1, 0);</span>
<span class='curline'><a href='../S/185.html#L54661'>pBt</a>              54661 libdb/sqlite3.c   sqlite3PagerPagecount(pBt-&gt;pPager, &amp;nPageFile);</span>
<span class='curline'><a href='../S/185.html#L54676'>pBt</a>              54676 libdb/sqlite3.c       pBt-&gt;btsFlags |= BTS_READ_ONLY;</span>
<span class='curline'><a href='../S/185.html#L54683'>pBt</a>              54683 libdb/sqlite3.c       pBt-&gt;btsFlags |= BTS_READ_ONLY;</span>
<span class='curline'><a href='../S/185.html#L54697'>pBt</a>              54697 libdb/sqlite3.c     if( page1[19]==2 &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_NO_WAL)==0 ){</span>
<span class='curline'><a href='../S/185.html#L54699'>pBt</a>              54699 libdb/sqlite3.c       rc = sqlite3PagerOpenWal(pBt-&gt;pPager, &amp;isOpen);</span>
<span class='curline'><a href='../S/185.html#L54727'>pBt</a>              54727 libdb/sqlite3.c     if( (u32)pageSize!=pBt-&gt;pageSize ){</span>
<span class='curline'><a href='../S/185.html#L54735'>pBt</a>              54735 libdb/sqlite3.c       pBt-&gt;usableSize = usableSize;</span>
<span class='curline'><a href='../S/185.html#L54736'>pBt</a>              54736 libdb/sqlite3.c       pBt-&gt;pageSize = pageSize;</span>
<span class='curline'><a href='../S/185.html#L54737'>pBt</a>              54737 libdb/sqlite3.c       freeTempSpace(pBt);</span>
<span class='curline'><a href='../S/185.html#L54738'>pBt</a>              54738 libdb/sqlite3.c       rc = sqlite3PagerSetPagesize(pBt-&gt;pPager, &amp;pBt-&gt;pageSize,</span>
<span class='curline'><a href='../S/185.html#L54742'>pBt</a>              54742 libdb/sqlite3.c     if( (pBt-&gt;db-&gt;flags &amp; SQLITE_RecoveryMode)==0 &amp;&amp; nPage&gt;nPageFile ){</span>
<span class='curline'><a href='../S/185.html#L54749'>pBt</a>              54749 libdb/sqlite3.c     pBt-&gt;pageSize = pageSize;</span>
<span class='curline'><a href='../S/185.html#L54750'>pBt</a>              54750 libdb/sqlite3.c     pBt-&gt;usableSize = usableSize;</span>
<span class='curline'><a href='../S/185.html#L54752'>pBt</a>              54752 libdb/sqlite3.c     pBt-&gt;autoVacuum = (get4byte(&amp;page1[36 + 4*4])?1:0);</span>
<span class='curline'><a href='../S/185.html#L54753'>pBt</a>              54753 libdb/sqlite3.c     pBt-&gt;incrVacuum = (get4byte(&amp;page1[36 + 7*4])?1:0);</span>
<span class='curline'><a href='../S/185.html#L54770'>pBt</a>              54770 libdb/sqlite3.c   pBt-&gt;maxLocal = (u16)((pBt-&gt;usableSize-12)*64/255 - 23);</span>
<span class='curline'><a href='../S/185.html#L54771'>pBt</a>              54771 libdb/sqlite3.c   pBt-&gt;minLocal = (u16)((pBt-&gt;usableSize-12)*32/255 - 23);</span>
<span class='curline'><a href='../S/185.html#L54772'>pBt</a>              54772 libdb/sqlite3.c   pBt-&gt;maxLeaf = (u16)(pBt-&gt;usableSize - 35);</span>
<span class='curline'><a href='../S/185.html#L54773'>pBt</a>              54773 libdb/sqlite3.c   pBt-&gt;minLeaf = (u16)((pBt-&gt;usableSize-12)*32/255 - 23);</span>
<span class='curline'><a href='../S/185.html#L54774'>pBt</a>              54774 libdb/sqlite3.c   if( pBt-&gt;maxLocal&gt;127 ){</span>
<span class='curline'><a href='../S/185.html#L54775'>pBt</a>              54775 libdb/sqlite3.c     pBt-&gt;max1bytePayload = 127;</span>
<span class='curline'><a href='../S/185.html#L54777'>pBt</a>              54777 libdb/sqlite3.c     pBt-&gt;max1bytePayload = (u8)pBt-&gt;maxLocal;</span>
<span class='curline'><a href='../S/185.html#L54779'>pBt</a>              54779 libdb/sqlite3.c   assert( pBt-&gt;maxLeaf + 23 &lt;= MX_CELL_SIZE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L54780'>pBt</a>              54780 libdb/sqlite3.c   pBt-&gt;pPage1 = pPage1;</span>
<span class='curline'><a href='../S/185.html#L54781'>pBt</a>              54781 libdb/sqlite3.c   pBt-&gt;nPage = nPage;</span>
<span class='curline'><a href='../S/185.html#L54786'>pBt</a>              54786 libdb/sqlite3.c   pBt-&gt;pPage1 = 0;</span>
<span class='curline'><a href='../S/185.html#L54803'>pBt</a>              54803 libdb/sqlite3.c static int countValidCursors(BtShared *pBt, int wrOnly){</span>
<span class='curline'><a href='../S/185.html#L54806'>pBt</a>              54806 libdb/sqlite3.c   for(pCur=pBt-&gt;pCursor; pCur; pCur=pCur-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L54822'>pBt</a>              54822 libdb/sqlite3.c static void unlockBtreeIfUnused(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54823'>pBt</a>              54823 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L54824'>pBt</a>              54824 libdb/sqlite3.c   assert( countValidCursors(pBt,0)==0 || pBt-&gt;inTransaction&gt;TRANS_NONE );</span>
<span class='curline'><a href='../S/185.html#L54825'>pBt</a>              54825 libdb/sqlite3.c   if( pBt-&gt;inTransaction==TRANS_NONE &amp;&amp; pBt-&gt;pPage1!=0 ){</span>
<span class='curline'><a href='../S/185.html#L54826'>pBt</a>              54826 libdb/sqlite3.c     MemPage *pPage1 = pBt-&gt;pPage1;</span>
<span class='curline'><a href='../S/185.html#L54828'>pBt</a>              54828 libdb/sqlite3.c     assert( sqlite3PagerRefcount(pBt-&gt;pPager)==1 );</span>
<span class='curline'><a href='../S/185.html#L54829'>pBt</a>              54829 libdb/sqlite3.c     pBt-&gt;pPage1 = 0;</span>
<span class='curline'><a href='../S/185.html#L54839'>pBt</a>              54839 libdb/sqlite3.c static int newDatabase(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L54844'>pBt</a>              54844 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L54845'>pBt</a>              54845 libdb/sqlite3.c   if( pBt-&gt;nPage&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L54848'>pBt</a>              54848 libdb/sqlite3.c   pP1 = pBt-&gt;pPage1;</span>
<span class='curline'><a href='../S/185.html#L54855'>pBt</a>              54855 libdb/sqlite3.c   data[16] = (u8)((pBt-&gt;pageSize&gt;&gt;8)&amp;0xff);</span>
<span class='curline'><a href='../S/185.html#L54856'>pBt</a>              54856 libdb/sqlite3.c   data[17] = (u8)((pBt-&gt;pageSize&gt;&gt;16)&amp;0xff);</span>
<span class='curline'><a href='../S/185.html#L54859'>pBt</a>              54859 libdb/sqlite3.c   assert( pBt-&gt;usableSize&lt;=pBt-&gt;pageSize &amp;&amp; pBt-&gt;usableSize+255&gt;=pBt-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L54860'>pBt</a>              54860 libdb/sqlite3.c   data[20] = (u8)(pBt-&gt;pageSize - pBt-&gt;usableSize);</span>
<span class='curline'><a href='../S/185.html#L54866'>pBt</a>              54866 libdb/sqlite3.c   pBt-&gt;btsFlags |= BTS_PAGESIZE_FIXED;</span>
<span class='curline'><a href='../S/185.html#L54868'>pBt</a>              54868 libdb/sqlite3.c   assert( pBt-&gt;autoVacuum==1 || pBt-&gt;autoVacuum==0 );</span>
<span class='curline'><a href='../S/185.html#L54869'>pBt</a>              54869 libdb/sqlite3.c   assert( pBt-&gt;incrVacuum==1 || pBt-&gt;incrVacuum==0 );</span>
<span class='curline'><a href='../S/185.html#L54870'>pBt</a>              54870 libdb/sqlite3.c   put4byte(&amp;data[36 + 4*4], pBt-&gt;autoVacuum);</span>
<span class='curline'><a href='../S/185.html#L54871'>pBt</a>              54871 libdb/sqlite3.c   put4byte(&amp;data[36 + 7*4], pBt-&gt;incrVacuum);</span>
<span class='curline'><a href='../S/185.html#L54873'>pBt</a>              54873 libdb/sqlite3.c   pBt-&gt;nPage = 1;</span>
<span class='curline'><a href='../S/185.html#L54886'>pBt</a>              54886 libdb/sqlite3.c   p-&gt;pBt-&gt;nPage = 0;</span>
<span class='curline'><a href='../S/185.html#L54887'>pBt</a>              54887 libdb/sqlite3.c   rc = newDatabase(p-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L54929'>pBt</a>              54929 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L54942'>pBt</a>              54942 libdb/sqlite3.c   assert( pBt-&gt;inTransaction==TRANS_WRITE || IfNotOmitAV(pBt-&gt;bDoTruncate)==0 );</span>
<span class='curline'><a href='../S/185.html#L54945'>pBt</a>              54945 libdb/sqlite3.c   if( (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)!=0 &amp;&amp; wrflag ){</span>
<span class='curline'><a href='../S/185.html#L54955'>pBt</a>              54955 libdb/sqlite3.c   if( (wrflag &amp;&amp; pBt-&gt;inTransaction==TRANS_WRITE)</span>
<span class='curline'><a href='../S/185.html#L54956'>pBt</a>              54956 libdb/sqlite3.c    || (pBt-&gt;btsFlags &amp; BTS_PENDING)!=0</span>
<span class='curline'><a href='../S/185.html#L54958'>pBt</a>              54958 libdb/sqlite3.c     pBlock = pBt-&gt;pWriter-&gt;db;</span>
<span class='curline'><a href='../S/185.html#L54961'>pBt</a>              54961 libdb/sqlite3.c     for(pIter=pBt-&gt;pLock; pIter; pIter=pIter-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L54981'>pBt</a>              54981 libdb/sqlite3.c   pBt-&gt;btsFlags &amp;= ~BTS_INITIALLY_EMPTY;</span>
<span class='curline'><a href='../S/185.html#L54982'>pBt</a>              54982 libdb/sqlite3.c   if( pBt-&gt;nPage==0 ) pBt-&gt;btsFlags |= BTS_INITIALLY_EMPTY;</span>
<span class='curline'><a href='../S/185.html#L54991'>pBt</a>              54991 libdb/sqlite3.c     while( pBt-&gt;pPage1==0 &amp;&amp; SQLITE_OK==(rc = lockBtree(pBt)) );</span>
<span class='curline'><a href='../S/185.html#L54994'>pBt</a>              54994 libdb/sqlite3.c       if( (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)!=0 ){</span>
<span class='curline'><a href='../S/185.html#L54997'>pBt</a>              54997 libdb/sqlite3.c         rc = sqlite3PagerBegin(pBt-&gt;pPager,wrflag&gt;1,sqlite3TempInMemory(p-&gt;db));</span>
<span class='curline'><a href='../S/185.html#L54999'>pBt</a>              54999 libdb/sqlite3.c           rc = newDatabase(pBt);</span>
<span class='curline'><a href='../S/185.html#L55005'>pBt</a>              55005 libdb/sqlite3.c       unlockBtreeIfUnused(pBt);</span>
<span class='curline'><a href='../S/185.html#L55007'>pBt</a>              55007 libdb/sqlite3.c   }while( (rc&amp;0xFF)==SQLITE_BUSY &amp;&amp; pBt-&gt;inTransaction==TRANS_NONE &amp;&amp;</span>
<span class='curline'><a href='../S/185.html#L55008'>pBt</a>              55008 libdb/sqlite3.c           btreeInvokeBusyHandler(pBt) );</span>
<span class='curline'><a href='../S/185.html#L55012'>pBt</a>              55012 libdb/sqlite3.c       pBt-&gt;nTransaction++;</span>
<span class='curline'><a href='../S/185.html#L55017'>pBt</a>              55017 libdb/sqlite3.c         p-&gt;lock.pNext = pBt-&gt;pLock;</span>
<span class='curline'><a href='../S/185.html#L55018'>pBt</a>              55018 libdb/sqlite3.c         pBt-&gt;pLock = &amp;p-&gt;lock;</span>
<span class='curline'><a href='../S/185.html#L55023'>pBt</a>              55023 libdb/sqlite3.c     if( p-&gt;inTrans&gt;pBt-&gt;inTransaction ){</span>
<span class='curline'><a href='../S/185.html#L55024'>pBt</a>              55024 libdb/sqlite3.c       pBt-&gt;inTransaction = p-&gt;inTrans;</span>
<span class='curline'><a href='../S/185.html#L55027'>pBt</a>              55027 libdb/sqlite3.c       MemPage *pPage1 = pBt-&gt;pPage1;</span>
<span class='curline'><a href='../S/185.html#L55029'>pBt</a>              55029 libdb/sqlite3.c       assert( !pBt-&gt;pWriter );</span>
<span class='curline'><a href='../S/185.html#L55030'>pBt</a>              55030 libdb/sqlite3.c       pBt-&gt;pWriter = p;</span>
<span class='curline'><a href='../S/185.html#L55031'>pBt</a>              55031 libdb/sqlite3.c       pBt-&gt;btsFlags &amp;= ~BTS_EXCLUSIVE;</span>
<span class='curline'><a href='../S/185.html#L55032'>pBt</a>              55032 libdb/sqlite3.c       if( wrflag&gt;1 ) pBt-&gt;btsFlags |= BTS_EXCLUSIVE;</span>
<span class='curline'><a href='../S/185.html#L55041'>pBt</a>              55041 libdb/sqlite3.c       if( pBt-&gt;nPage!=get4byte(&amp;pPage1-&gt;aData[28]) ){</span>
<span class='curline'><a href='../S/185.html#L55044'>pBt</a>              55044 libdb/sqlite3.c           put4byte(&amp;pPage1-&gt;aData[28], pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L55057'>pBt</a>              55057 libdb/sqlite3.c     rc = sqlite3PagerOpenSavepoint(pBt-&gt;pPager, p-&gt;db-&gt;nSavepoint);</span>
<span class='curline'><a href='../S/185.html#L55076'>pBt</a>              55076 libdb/sqlite3.c   BtShared *pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55080'>pBt</a>              55080 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L55094'>pBt</a>              55094 libdb/sqlite3.c       ptrmapPut(pBt, childPgno, PTRMAP_BTREE, pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L55100'>pBt</a>              55100 libdb/sqlite3.c     ptrmapPut(pBt, childPgno, PTRMAP_BTREE, pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L55123'>pBt</a>              55123 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L55183'>pBt</a>              55183 libdb/sqlite3.c   BtShared *pBt,           /* Btree */</span>
<span class='curline'><a href='../S/185.html#L55192'>pBt</a>              55192 libdb/sqlite3.c   Pager *pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L55197'>pBt</a>              55197 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L55198'>pBt</a>              55198 libdb/sqlite3.c   assert( pDbPage-&gt;pBt==pBt );</span>
<span class='curline'><a href='../S/185.html#L55225'>pBt</a>              55225 libdb/sqlite3.c       ptrmapPut(pBt, nextOvfl, PTRMAP_OVERFLOW2, iFreePage, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L55237'>pBt</a>              55237 libdb/sqlite3.c     rc = btreeGetPage(pBt, iPtrPage, &amp;pPtrPage, 0);</span>
<span class='curline'><a href='../S/185.html#L55249'>pBt</a>              55249 libdb/sqlite3.c       ptrmapPut(pBt, iFreePage, eType, iPtrPage, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L55275'>pBt</a>              55275 libdb/sqlite3.c static int incrVacuumStep(BtShared *pBt, Pgno nFin, Pgno iLastPg, int bCommit){</span>
<span class='curline'><a href='../S/185.html#L55279'>pBt</a>              55279 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L55282'>pBt</a>              55282 libdb/sqlite3.c   if( !PTRMAP_ISPAGE(pBt, iLastPg) &amp;&amp; iLastPg!=PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L55286'>pBt</a>              55286 libdb/sqlite3.c     nFreeList = get4byte(&amp;pBt-&gt;pPage1-&gt;aData[36]);</span>
<span class='curline'><a href='../S/185.html#L55291'>pBt</a>              55291 libdb/sqlite3.c     rc = ptrmapGet(pBt, iLastPg, &amp;eType, &amp;iPtrPage);</span>
<span class='curline'><a href='../S/185.html#L55308'>pBt</a>              55308 libdb/sqlite3.c         rc = allocateBtreePage(pBt, &amp;pFreePg, &amp;iFreePg, iLastPg, BTALLOC_EXACT);</span>
<span class='curline'><a href='../S/185.html#L55321'>pBt</a>              55321 libdb/sqlite3.c       rc = btreeGetPage(pBt, iLastPg, &amp;pLastPg, 0);</span>
<span class='curline'><a href='../S/185.html#L55339'>pBt</a>              55339 libdb/sqlite3.c         rc = allocateBtreePage(pBt, &amp;pFreePg, &amp;iFreePg, iNear, eMode);</span>
<span class='curline'><a href='../S/185.html#L55348'>pBt</a>              55348 libdb/sqlite3.c       rc = relocatePage(pBt, pLastPg, eType, iPtrPage, iFreePg, bCommit);</span>
<span class='curline'><a href='../S/185.html#L55359'>pBt</a>              55359 libdb/sqlite3.c     }while( iLastPg==PENDING_BYTE_PAGE(pBt) || PTRMAP_ISPAGE(pBt, iLastPg) );</span>
<span class='curline'><a href='../S/185.html#L55360'>pBt</a>              55360 libdb/sqlite3.c     pBt-&gt;bDoTruncate = 1;</span>
<span class='curline'><a href='../S/185.html#L55361'>pBt</a>              55361 libdb/sqlite3.c     pBt-&gt;nPage = iLastPg;</span>
<span class='curline'><a href='../S/185.html#L55371'>pBt</a>              55371 libdb/sqlite3.c static Pgno finalDbSize(BtShared *pBt, Pgno nOrig, Pgno nFree){</span>
<span class='curline'><a href='../S/185.html#L55376'>pBt</a>              55376 libdb/sqlite3.c   nEntry = pBt-&gt;usableSize/5;</span>
<span class='curline'><a href='../S/185.html#L55377'>pBt</a>              55377 libdb/sqlite3.c   nPtrmap = (nFree-nOrig+PTRMAP_PAGENO(pBt, nOrig)+nEntry)/nEntry;</span>
<span class='curline'><a href='../S/185.html#L55379'>pBt</a>              55379 libdb/sqlite3.c   if( nOrig&gt;PENDING_BYTE_PAGE(pBt) &amp;&amp; nFin&lt;PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L55382'>pBt</a>              55382 libdb/sqlite3.c   while( PTRMAP_ISPAGE(pBt, nFin) || nFin==PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L55399'>pBt</a>              55399 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55402'>pBt</a>              55402 libdb/sqlite3.c   assert( pBt-&gt;inTransaction==TRANS_WRITE &amp;&amp; p-&gt;inTrans==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L55403'>pBt</a>              55403 libdb/sqlite3.c   if( !pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L55406'>pBt</a>              55406 libdb/sqlite3.c     Pgno nOrig = btreePagecount(pBt);</span>
<span class='curline'><a href='../S/185.html#L55407'>pBt</a>              55407 libdb/sqlite3.c     Pgno nFree = get4byte(&amp;pBt-&gt;pPage1-&gt;aData[36]);</span>
<span class='curline'><a href='../S/185.html#L55408'>pBt</a>              55408 libdb/sqlite3.c     Pgno nFin = finalDbSize(pBt, nOrig, nFree);</span>
<span class='curline'><a href='../S/185.html#L55413'>pBt</a>              55413 libdb/sqlite3.c       rc = saveAllCursors(pBt, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L55415'>pBt</a>              55415 libdb/sqlite3.c         invalidateAllOverflowCache(pBt);</span>
<span class='curline'><a href='../S/185.html#L55416'>pBt</a>              55416 libdb/sqlite3.c         rc = incrVacuumStep(pBt, nFin, nOrig, 0);</span>
<span class='curline'><a href='../S/185.html#L55419'>pBt</a>              55419 libdb/sqlite3.c         rc = sqlite3PagerWrite(pBt-&gt;pPage1-&gt;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L55420'>pBt</a>              55420 libdb/sqlite3.c         put4byte(&amp;pBt-&gt;pPage1-&gt;aData[28], pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L55439'>pBt</a>              55439 libdb/sqlite3.c static int autoVacuumCommit(BtShared *pBt){</span>
<span class='curline'><a href='../S/185.html#L55441'>pBt</a>              55441 libdb/sqlite3.c   Pager *pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L55444'>pBt</a>              55444 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L55445'>pBt</a>              55445 libdb/sqlite3.c   invalidateAllOverflowCache(pBt);</span>
<span class='curline'><a href='../S/185.html#L55446'>pBt</a>              55446 libdb/sqlite3.c   assert(pBt-&gt;autoVacuum);</span>
<span class='curline'><a href='../S/185.html#L55447'>pBt</a>              55447 libdb/sqlite3.c   if( !pBt-&gt;incrVacuum ){</span>
<span class='curline'><a href='../S/185.html#L55453'>pBt</a>              55453 libdb/sqlite3.c     nOrig = btreePagecount(pBt);</span>
<span class='curline'><a href='../S/185.html#L55454'>pBt</a>              55454 libdb/sqlite3.c     if( PTRMAP_ISPAGE(pBt, nOrig) || nOrig==PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L55462'>pBt</a>              55462 libdb/sqlite3.c     nFree = get4byte(&amp;pBt-&gt;pPage1-&gt;aData[36]);</span>
<span class='curline'><a href='../S/185.html#L55463'>pBt</a>              55463 libdb/sqlite3.c     nFin = finalDbSize(pBt, nOrig, nFree);</span>
<span class='curline'><a href='../S/185.html#L55466'>pBt</a>              55466 libdb/sqlite3.c       rc = saveAllCursors(pBt, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L55469'>pBt</a>              55469 libdb/sqlite3.c       rc = incrVacuumStep(pBt, nFin, iFree, 1);</span>
<span class='curline'><a href='../S/185.html#L55472'>pBt</a>              55472 libdb/sqlite3.c       rc = sqlite3PagerWrite(pBt-&gt;pPage1-&gt;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L55473'>pBt</a>              55473 libdb/sqlite3.c       put4byte(&amp;pBt-&gt;pPage1-&gt;aData[32], 0);</span>
<span class='curline'><a href='../S/185.html#L55474'>pBt</a>              55474 libdb/sqlite3.c       put4byte(&amp;pBt-&gt;pPage1-&gt;aData[36], 0);</span>
<span class='curline'><a href='../S/185.html#L55475'>pBt</a>              55475 libdb/sqlite3.c       put4byte(&amp;pBt-&gt;pPage1-&gt;aData[28], nFin);</span>
<span class='curline'><a href='../S/185.html#L55476'>pBt</a>              55476 libdb/sqlite3.c       pBt-&gt;bDoTruncate = 1;</span>
<span class='curline'><a href='../S/185.html#L55477'>pBt</a>              55477 libdb/sqlite3.c       pBt-&gt;nPage = nFin;</span>
<span class='curline'><a href='../S/185.html#L55521'>pBt</a>              55521 libdb/sqlite3.c     BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55524'>pBt</a>              55524 libdb/sqlite3.c     if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L55525'>pBt</a>              55525 libdb/sqlite3.c       rc = autoVacuumCommit(pBt);</span>
<span class='curline'><a href='../S/185.html#L55531'>pBt</a>              55531 libdb/sqlite3.c     if( pBt-&gt;bDoTruncate ){</span>
<span class='curline'><a href='../S/185.html#L55532'>pBt</a>              55532 libdb/sqlite3.c       sqlite3PagerTruncateImage(pBt-&gt;pPager, pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L55535'>pBt</a>              55535 libdb/sqlite3.c     rc = sqlite3PagerCommitPhaseOne(pBt-&gt;pPager, zMaster, 0);</span>
<span class='curline'><a href='../S/185.html#L55546'>pBt</a>              55546 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55551'>pBt</a>              55551 libdb/sqlite3.c   pBt-&gt;bDoTruncate = 0;</span>
<span class='curline'><a href='../S/185.html#L55566'>pBt</a>              55566 libdb/sqlite3.c       pBt-&gt;nTransaction--;</span>
<span class='curline'><a href='../S/185.html#L55567'>pBt</a>              55567 libdb/sqlite3.c       if( 0==pBt-&gt;nTransaction ){</span>
<span class='curline'><a href='../S/185.html#L55568'>pBt</a>              55568 libdb/sqlite3.c         pBt-&gt;inTransaction = TRANS_NONE;</span>
<span class='curline'><a href='../S/185.html#L55575'>pBt</a>              55575 libdb/sqlite3.c     unlockBtreeIfUnused(pBt);</span>
<span class='curline'><a href='../S/185.html#L55618'>pBt</a>              55618 libdb/sqlite3.c     BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55619'>pBt</a>              55619 libdb/sqlite3.c     assert( pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L55620'>pBt</a>              55620 libdb/sqlite3.c     assert( pBt-&gt;nTransaction&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L55621'>pBt</a>              55621 libdb/sqlite3.c     rc = sqlite3PagerCommitPhaseTwo(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L55626'>pBt</a>              55626 libdb/sqlite3.c     pBt-&gt;inTransaction = TRANS_READ;</span>
<span class='curline'><a href='../S/185.html#L55627'>pBt</a>              55627 libdb/sqlite3.c     btreeClearHasContent(pBt);</span>
<span class='curline'><a href='../S/185.html#L55670'>pBt</a>              55670 libdb/sqlite3.c   for(p=pBtree-&gt;pBt-&gt;pCursor; p; p=p-&gt;pNext){</span>
<span class='curline'><a href='../S/185.html#L55694'>pBt</a>              55694 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55699'>pBt</a>              55699 libdb/sqlite3.c     rc = tripCode = saveAllCursors(pBt, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L55711'>pBt</a>              55711 libdb/sqlite3.c     assert( TRANS_WRITE==pBt-&gt;inTransaction );</span>
<span class='curline'><a href='../S/185.html#L55712'>pBt</a>              55712 libdb/sqlite3.c     rc2 = sqlite3PagerRollback(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L55720'>pBt</a>              55720 libdb/sqlite3.c     if( btreeGetPage(pBt, 1, &amp;pPage1, 0)==SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L55723'>pBt</a>              55723 libdb/sqlite3.c       if( nPage==0 ) sqlite3PagerPagecount(pBt-&gt;pPager, &amp;nPage);</span>
<span class='curline'><a href='../S/185.html#L55724'>pBt</a>              55724 libdb/sqlite3.c       testcase( pBt-&gt;nPage!=nPage );</span>
<span class='curline'><a href='../S/185.html#L55725'>pBt</a>              55725 libdb/sqlite3.c       pBt-&gt;nPage = nPage;</span>
<span class='curline'><a href='../S/185.html#L55728'>pBt</a>              55728 libdb/sqlite3.c     assert( countValidCursors(pBt, 1)==0 );</span>
<span class='curline'><a href='../S/185.html#L55729'>pBt</a>              55729 libdb/sqlite3.c     pBt-&gt;inTransaction = TRANS_READ;</span>
<span class='curline'><a href='../S/185.html#L55730'>pBt</a>              55730 libdb/sqlite3.c     btreeClearHasContent(pBt);</span>
<span class='curline'><a href='../S/185.html#L55758'>pBt</a>              55758 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55761'>pBt</a>              55761 libdb/sqlite3.c   assert( (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)==0 );</span>
<span class='curline'><a href='../S/185.html#L55764'>pBt</a>              55764 libdb/sqlite3.c   assert( pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L55770'>pBt</a>              55770 libdb/sqlite3.c   rc = sqlite3PagerOpenSavepoint(pBt-&gt;pPager, iStatement);</span>
<span class='curline'><a href='../S/185.html#L55790'>pBt</a>              55790 libdb/sqlite3.c     BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55794'>pBt</a>              55794 libdb/sqlite3.c     rc = sqlite3PagerSavepoint(pBt-&gt;pPager, op, iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L55796'>pBt</a>              55796 libdb/sqlite3.c       if( iSavepoint&lt;0 &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_INITIALLY_EMPTY)!=0 ){</span>
<span class='curline'><a href='../S/185.html#L55797'>pBt</a>              55797 libdb/sqlite3.c         pBt-&gt;nPage = 0;</span>
<span class='curline'><a href='../S/185.html#L55799'>pBt</a>              55799 libdb/sqlite3.c       rc = newDatabase(pBt);</span>
<span class='curline'><a href='../S/185.html#L55800'>pBt</a>              55800 libdb/sqlite3.c       pBt-&gt;nPage = get4byte(28 + pBt-&gt;pPage1-&gt;aData);</span>
<span class='curline'><a href='../S/185.html#L55805'>pBt</a>              55805 libdb/sqlite3.c       assert( pBt-&gt;nPage&gt;0 );</span>
<span class='curline'><a href='../S/185.html#L55851'>pBt</a>              55851 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;                /* Shared b-tree handle */</span>
<span class='curline'><a href='../S/185.html#L55866'>pBt</a>              55866 libdb/sqlite3.c   assert( pBt-&gt;pPage1 &amp;&amp; pBt-&gt;pPage1-&gt;aData );</span>
<span class='curline'><a href='../S/185.html#L55868'>pBt</a>              55868 libdb/sqlite3.c   if( NEVER(wrFlag &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)!=0) ){</span>
<span class='curline'><a href='../S/185.html#L55872'>pBt</a>              55872 libdb/sqlite3.c     allocateTempSpace(pBt);</span>
<span class='curline'><a href='../S/185.html#L55873'>pBt</a>              55873 libdb/sqlite3.c     if( pBt-&gt;pTmpSpace==0 ) return SQLITE_NOMEM;</span>
<span class='curline'><a href='../S/185.html#L55875'>pBt</a>              55875 libdb/sqlite3.c   if( iTable==1 &amp;&amp; btreePagecount(pBt)==0 ){</span>
<span class='curline'><a href='../S/185.html#L55886'>pBt</a>              55886 libdb/sqlite3.c   pCur-&gt;pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L55889'>pBt</a>              55889 libdb/sqlite3.c   pCur-&gt;pNext = pBt-&gt;pCursor;</span>
<span class='curline'><a href='../S/185.html#L55893'>pBt</a>              55893 libdb/sqlite3.c   pBt-&gt;pCursor = pCur;</span>
<span class='curline'><a href='../S/185.html#L55943'>pBt</a>              55943 libdb/sqlite3.c     BtShared *pBt = pCur-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L55949'>pBt</a>              55949 libdb/sqlite3.c       pBt-&gt;pCursor = pCur-&gt;pNext;</span>
<span class='curline'><a href='../S/185.html#L55957'>pBt</a>              55957 libdb/sqlite3.c     unlockBtreeIfUnused(pBt);</span>
<span class='curline'><a href='../S/185.html#L56090'>pBt</a>              56090 libdb/sqlite3.c   BtShared *pBt,               /* The database file */</span>
<span class='curline'><a href='../S/185.html#L56099'>pBt</a>              56099 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L56109'>pBt</a>              56109 libdb/sqlite3.c   if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L56114'>pBt</a>              56114 libdb/sqlite3.c     while( PTRMAP_ISPAGE(pBt, iGuess) || iGuess==PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L56118'>pBt</a>              56118 libdb/sqlite3.c     if( iGuess&lt;=btreePagecount(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L56119'>pBt</a>              56119 libdb/sqlite3.c       rc = ptrmapGet(pBt, iGuess, &amp;eType, &amp;pgno);</span>
<span class='curline'><a href='../S/185.html#L56130'>pBt</a>              56130 libdb/sqlite3.c     rc = btreeGetPage(pBt, ovfl, &amp;pPage, (ppPage==0) ? PAGER_GET_READONLY : 0);</span>
<span class='curline'><a href='../S/185.html#L56219'>pBt</a>              56219 libdb/sqlite3.c   BtShared *pBt = pCur-&gt;pBt;                  /* Btree this cursor belongs to */</span>
<span class='curline'><a href='../S/185.html#L56238'>pBt</a>              56238 libdb/sqlite3.c   if( &amp;aPayload[pCur-&gt;info.nLocal] &gt; &amp;pPage-&gt;aData[pBt-&gt;usableSize] ){</span>
<span class='curline'><a href='../S/185.html#L56258'>pBt</a>              56258 libdb/sqlite3.c     const u32 ovflSize = pBt-&gt;usableSize - 4;  /* Bytes content per ovfl page */</span>
<span class='curline'><a href='../S/185.html#L56325'>pBt</a>              56325 libdb/sqlite3.c           rc = getOverflowPage(pBt, nextPage, 0, &amp;nextPage);</span>
<span class='curline'><a href='../S/185.html#L56358'>pBt</a>              56358 libdb/sqlite3.c          &amp;&amp; pBt-&gt;inTransaction==TRANS_READ                     /* (4) */</span>
<span class='curline'><a href='../S/185.html#L56359'>pBt</a>              56359 libdb/sqlite3.c          &amp;&amp; (fd = sqlite3PagerFile(pBt-&gt;pPager))-&gt;pMethods     /* (3) */</span>
<span class='curline'><a href='../S/185.html#L56360'>pBt</a>              56360 libdb/sqlite3.c          &amp;&amp; pBt-&gt;pPage1-&gt;aData[19]==0x01                       /* (5) */</span>
<span class='curline'><a href='../S/185.html#L56367'>pBt</a>              56367 libdb/sqlite3.c           rc = sqlite3OsRead(fd, aWrite, a+4, (i64)pBt-&gt;pageSize*(nextPage-1));</span>
<span class='curline'><a href='../S/185.html#L56375'>pBt</a>              56375 libdb/sqlite3.c           rc = sqlite3PagerAcquire(pBt-&gt;pPager, nextPage, &amp;pDbPage,</span>
<span class='curline'><a href='../S/185.html#L56516'>pBt</a>              56516 libdb/sqlite3.c   BtShared *pBt = pCur-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L56525'>pBt</a>              56525 libdb/sqlite3.c   rc = getAndInitPage(pBt, newPgno, &amp;pNewPage,</span>
<span class='curline'><a href='../S/185.html#L56637'>pBt</a>              56637 libdb/sqlite3.c     rc = getAndInitPage(pCur-&gt;pBtree-&gt;pBt, pCur-&gt;pgnoRoot, &amp;pCur-&gt;apPage[0],</span>
<span class='curline'><a href='../S/185.html#L57278'>pBt</a>              57278 libdb/sqlite3.c   BtShared *pBt,         /* The btree */</span>
<span class='curline'><a href='../S/185.html#L57292'>pBt</a>              57292 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L57293'>pBt</a>              57293 libdb/sqlite3.c   assert( eMode==BTALLOC_ANY || (nearby&gt;0 &amp;&amp; IfNotOmitAV(pBt-&gt;autoVacuum)) );</span>
<span class='curline'><a href='../S/185.html#L57294'>pBt</a>              57294 libdb/sqlite3.c   pPage1 = pBt-&gt;pPage1;</span>
<span class='curline'><a href='../S/185.html#L57295'>pBt</a>              57295 libdb/sqlite3.c   mxPage = btreePagecount(pBt);</span>
<span class='curline'><a href='../S/185.html#L57315'>pBt</a>              57315 libdb/sqlite3.c         assert( pBt-&gt;autoVacuum );</span>
<span class='curline'><a href='../S/185.html#L57316'>pBt</a>              57316 libdb/sqlite3.c         rc = ptrmapGet(pBt, nearby, &amp;eType, 0);</span>
<span class='curline'><a href='../S/185.html#L57350'>pBt</a>              57350 libdb/sqlite3.c         rc = btreeGetPage(pBt, iTrunk, &amp;pTrunk, 0);</span>
<span class='curline'><a href='../S/185.html#L57374'>pBt</a>              57374 libdb/sqlite3.c       }else if( k&gt;(u32)(pBt-&gt;usableSize/4 - 2) ){</span>
<span class='curline'><a href='../S/185.html#L57414'>pBt</a>              57414 libdb/sqlite3.c           rc = btreeGetPage(pBt, iNewTrunk, &amp;pNewTrunk, 0);</span>
<span class='curline'><a href='../S/185.html#L57493'>pBt</a>              57493 libdb/sqlite3.c           noContent = !btreeGetHasContent(pBt, *pPgno)? PAGER_GET_NOCONTENT : 0;</span>
<span class='curline'><a href='../S/185.html#L57494'>pBt</a>              57494 libdb/sqlite3.c           rc = btreeGetPage(pBt, *pPgno, ppPage, noContent);</span>
<span class='curline'><a href='../S/185.html#L57526'>pBt</a>              57526 libdb/sqlite3.c     int bNoContent = (0==IfNotOmitAV(pBt-&gt;bDoTruncate))? PAGER_GET_NOCONTENT:0;</span>
<span class='curline'><a href='../S/185.html#L57528'>pBt</a>              57528 libdb/sqlite3.c     rc = sqlite3PagerWrite(pBt-&gt;pPage1-&gt;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L57530'>pBt</a>              57530 libdb/sqlite3.c     pBt-&gt;nPage++;</span>
<span class='curline'><a href='../S/185.html#L57531'>pBt</a>              57531 libdb/sqlite3.c     if( pBt-&gt;nPage==PENDING_BYTE_PAGE(pBt) ) pBt-&gt;nPage++;</span>
<span class='curline'><a href='../S/185.html#L57534'>pBt</a>              57534 libdb/sqlite3.c     if( pBt-&gt;autoVacuum &amp;&amp; PTRMAP_ISPAGE(pBt, pBt-&gt;nPage) ){</span>
<span class='curline'><a href='../S/185.html#L57540'>pBt</a>              57540 libdb/sqlite3.c       TRACE(("ALLOCATE: %d from end of file (pointer-map page)\n", pBt-&gt;nPage));</span>
<span class='curline'><a href='../S/185.html#L57541'>pBt</a>              57541 libdb/sqlite3.c       assert( pBt-&gt;nPage!=PENDING_BYTE_PAGE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L57542'>pBt</a>              57542 libdb/sqlite3.c       rc = btreeGetPage(pBt, pBt-&gt;nPage, &amp;pPg, bNoContent);</span>
<span class='curline'><a href='../S/185.html#L57548'>pBt</a>              57548 libdb/sqlite3.c       pBt-&gt;nPage++;</span>
<span class='curline'><a href='../S/185.html#L57549'>pBt</a>              57549 libdb/sqlite3.c       if( pBt-&gt;nPage==PENDING_BYTE_PAGE(pBt) ){ pBt-&gt;nPage++; }</span>
<span class='curline'><a href='../S/185.html#L57552'>pBt</a>              57552 libdb/sqlite3.c     put4byte(28 + (u8*)pBt-&gt;pPage1-&gt;aData, pBt-&gt;nPage);</span>
<span class='curline'><a href='../S/185.html#L57553'>pBt</a>              57553 libdb/sqlite3.c     *pPgno = pBt-&gt;nPage;</span>
<span class='curline'><a href='../S/185.html#L57555'>pBt</a>              57555 libdb/sqlite3.c     assert( *pPgno!=PENDING_BYTE_PAGE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L57556'>pBt</a>              57556 libdb/sqlite3.c     rc = btreeGetPage(pBt, *pPgno, ppPage, bNoContent);</span>
<span class='curline'><a href='../S/185.html#L57565'>pBt</a>              57565 libdb/sqlite3.c   assert( *pPgno!=PENDING_BYTE_PAGE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L57596'>pBt</a>              57596 libdb/sqlite3.c static int freePage2(BtShared *pBt, MemPage *pMemPage, Pgno iPage){</span>
<span class='curline'><a href='../S/185.html#L57599'>pBt</a>              57599 libdb/sqlite3.c   MemPage *pPage1 = pBt-&gt;pPage1;      /* Local reference to page 1 */</span>
<span class='curline'><a href='../S/185.html#L57604'>pBt</a>              57604 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L57612'>pBt</a>              57612 libdb/sqlite3.c     pPage = btreePageLookup(pBt, iPage);</span>
<span class='curline'><a href='../S/185.html#L57621'>pBt</a>              57621 libdb/sqlite3.c   if( pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE ){</span>
<span class='curline'><a href='../S/185.html#L57625'>pBt</a>              57625 libdb/sqlite3.c     if( (!pPage &amp;&amp; ((rc = btreeGetPage(pBt, iPage, &amp;pPage, 0))!=0) )</span>
<span class='curline'><a href='../S/185.html#L57630'>pBt</a>              57630 libdb/sqlite3.c     memset(pPage-&gt;aData, 0, pPage-&gt;pBt-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L57637'>pBt</a>              57637 libdb/sqlite3.c     ptrmapPut(pBt, iPage, PTRMAP_FREEPAGE, 0, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L57652'>pBt</a>              57652 libdb/sqlite3.c     rc = btreeGetPage(pBt, iTrunk, &amp;pTrunk, 0);</span>
<span class='curline'><a href='../S/185.html#L57658'>pBt</a>              57658 libdb/sqlite3.c     assert( pBt-&gt;usableSize&gt;32 );</span>
<span class='curline'><a href='../S/185.html#L57659'>pBt</a>              57659 libdb/sqlite3.c     if( nLeaf &gt; (u32)pBt-&gt;usableSize/4 - 2 ){</span>
<span class='curline'><a href='../S/185.html#L57663'>pBt</a>              57663 libdb/sqlite3.c     if( nLeaf &lt; (u32)pBt-&gt;usableSize/4 - 8 ){</span>
<span class='curline'><a href='../S/185.html#L57682'>pBt</a>              57682 libdb/sqlite3.c         if( pPage &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE)==0 ){</span>
<span class='curline'><a href='../S/185.html#L57685'>pBt</a>              57685 libdb/sqlite3.c         rc = btreeSetHasContent(pBt, iPage);</span>
<span class='curline'><a href='../S/185.html#L57698'>pBt</a>              57698 libdb/sqlite3.c   if( pPage==0 &amp;&amp; SQLITE_OK!=(rc = btreeGetPage(pBt, iPage, &amp;pPage, 0)) ){</span>
<span class='curline'><a href='../S/185.html#L57720'>pBt</a>              57720 libdb/sqlite3.c     *pRC = freePage2(pPage-&gt;pBt, pPage, pPage-&gt;pgno);</span>
<span class='curline'><a href='../S/185.html#L57734'>pBt</a>              57734 libdb/sqlite3.c   BtShared *pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L57741'>pBt</a>              57741 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L57751'>pBt</a>              57751 libdb/sqlite3.c   assert( pBt-&gt;usableSize &gt; 4 );</span>
<span class='curline'><a href='../S/185.html#L57752'>pBt</a>              57752 libdb/sqlite3.c   ovflPageSize = pBt-&gt;usableSize - 4;</span>
<span class='curline'><a href='../S/185.html#L57758'>pBt</a>              57758 libdb/sqlite3.c     if( ovflPgno&lt;2 || ovflPgno&gt;btreePagecount(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L57765'>pBt</a>              57765 libdb/sqlite3.c       rc = getOverflowPage(pBt, ovflPgno, &amp;pOvfl, &amp;iNext);</span>
<span class='curline'><a href='../S/185.html#L57769'>pBt</a>              57769 libdb/sqlite3.c     if( ( pOvfl || ((pOvfl = btreePageLookup(pBt, ovflPgno))!=0) )</span>
<span class='curline'><a href='../S/185.html#L57784'>pBt</a>              57784 libdb/sqlite3.c       rc = freePage2(pBt, pOvfl, ovflPgno);</span>
<span class='curline'><a href='../S/185.html#L57824'>pBt</a>              57824 libdb/sqlite3.c   BtShared *pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L57828'>pBt</a>              57828 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L57832'>pBt</a>              57832 libdb/sqlite3.c   assert( pCell&lt;pPage-&gt;aData || pCell&gt;=&amp;pPage-&gt;aData[pBt-&gt;pageSize]</span>
<span class='curline'><a href='../S/185.html#L57869'>pBt</a>              57869 libdb/sqlite3.c     n = mn + (nPayload - mn) % (pPage-&gt;pBt-&gt;usableSize - 4);</span>
<span class='curline'><a href='../S/185.html#L57908'>pBt</a>              57908 libdb/sqlite3.c       if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L57912'>pBt</a>              57912 libdb/sqlite3.c           PTRMAP_ISPAGE(pBt, pgnoOvfl) || pgnoOvfl==PENDING_BYTE_PAGE(pBt) </span>
<span class='curline'><a href='../S/185.html#L57916'>pBt</a>              57916 libdb/sqlite3.c       rc = allocateBtreePage(pBt, &amp;pOvfl, &amp;pgnoOvfl, pgnoOvfl, 0);</span>
<span class='curline'><a href='../S/185.html#L57928'>pBt</a>              57928 libdb/sqlite3.c       if( pBt-&gt;autoVacuum &amp;&amp; rc==SQLITE_OK ){</span>
<span class='curline'><a href='../S/185.html#L57930'>pBt</a>              57930 libdb/sqlite3.c         ptrmapPut(pBt, pgnoOvfl, eType, pgnoPtrmap, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L57947'>pBt</a>              57947 libdb/sqlite3.c       assert( pPrior&lt;pPage-&gt;aData || pPrior&gt;=&amp;pPage-&gt;aData[pBt-&gt;pageSize]</span>
<span class='curline'><a href='../S/185.html#L57956'>pBt</a>              57956 libdb/sqlite3.c       spaceLeft = pBt-&gt;usableSize - 4;</span>
<span class='curline'><a href='../S/185.html#L57967'>pBt</a>              57967 libdb/sqlite3.c     assert( pPayload&lt;pPage-&gt;aData || pPayload&gt;=&amp;pPage-&gt;aData[pBt-&gt;pageSize]</span>
<span class='curline'><a href='../S/185.html#L58011'>pBt</a>              58011 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L58017'>pBt</a>              58017 libdb/sqlite3.c   testcase( pc+sz==pPage-&gt;pBt-&gt;usableSize );</span>
<span class='curline'><a href='../S/185.html#L58018'>pBt</a>              58018 libdb/sqlite3.c   if( pc &lt; (u32)get2byte(&amp;data[hdr+5]) || pc+sz &gt; pPage-&gt;pBt-&gt;usableSize ){</span>
<span class='curline'><a href='../S/185.html#L58064'>pBt</a>              58064 libdb/sqlite3.c   assert( MX_CELL(pPage-&gt;pBt)&lt;=10921 );</span>
<span class='curline'><a href='../S/185.html#L58065'>pBt</a>              58065 libdb/sqlite3.c   assert( pPage-&gt;nCell&lt;=MX_CELL(pPage-&gt;pBt) || CORRUPT_DB );</span>
<span class='curline'><a href='../S/185.html#L58068'>pBt</a>              58068 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L58103'>pBt</a>              58103 libdb/sqlite3.c     assert( idx+sz &lt;= (int)pPage-&gt;pBt-&gt;usableSize );</span>
<span class='curline'><a href='../S/185.html#L58114'>pBt</a>              58114 libdb/sqlite3.c     if( pPage-&gt;pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L58139'>pBt</a>              58139 libdb/sqlite3.c   const int nUsable = pPage-&gt;pBt-&gt;usableSize; /* Usable size of page */</span>
<span class='curline'><a href='../S/185.html#L58142'>pBt</a>              58142 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L58143'>pBt</a>              58143 libdb/sqlite3.c   assert( nCell&gt;=0 &amp;&amp; nCell&lt;=(int)MX_CELL(pPage-&gt;pBt)</span>
<span class='curline'><a href='../S/185.html#L58144'>pBt</a>              58144 libdb/sqlite3.c             &amp;&amp; (int)MX_CELL(pPage-&gt;pBt)&lt;=10921);</span>
<span class='curline'><a href='../S/185.html#L58207'>pBt</a>              58207 libdb/sqlite3.c   BtShared *const pBt = pPage-&gt;pBt;    /* B-Tree Database */</span>
<span class='curline'><a href='../S/185.html#L58212'>pBt</a>              58212 libdb/sqlite3.c   assert( sqlite3_mutex_held(pPage-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L58223'>pBt</a>              58223 libdb/sqlite3.c   rc = allocateBtreePage(pBt, &amp;pNew, &amp;pgnoNew, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L58247'>pBt</a>              58247 libdb/sqlite3.c       ptrmapPut(pBt, pgnoNew, PTRMAP_BTREE, pParent-&gt;pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L58299'>pBt</a>              58299 libdb/sqlite3.c     BtShared *pBt = pPage-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L58310'>pBt</a>              58310 libdb/sqlite3.c         ptrmapGet(pBt, ovfl, &amp;e, &amp;n);</span>
<span class='curline'><a href='../S/185.html#L58315'>pBt</a>              58315 libdb/sqlite3.c         ptrmapGet(pBt, child, &amp;e, &amp;n);</span>
<span class='curline'><a href='../S/185.html#L58321'>pBt</a>              58321 libdb/sqlite3.c       ptrmapGet(pBt, child, &amp;e, &amp;n);</span>
<span class='curline'><a href='../S/185.html#L58348'>pBt</a>              58348 libdb/sqlite3.c     BtShared * const pBt = pFrom-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L58359'>pBt</a>              58359 libdb/sqlite3.c     assert( get2byte(&amp;aFrom[iFromHdr+5]) &lt;= (int)pBt-&gt;usableSize );</span>
<span class='curline'><a href='../S/185.html#L58363'>pBt</a>              58363 libdb/sqlite3.c     memcpy(&amp;aTo[iData], &amp;aFrom[iData], pBt-&gt;usableSize-iData);</span>
<span class='curline'><a href='../S/185.html#L58437'>pBt</a>              58437 libdb/sqlite3.c   BtShared *pBt;               /* The whole database */</span>
<span class='curline'><a href='../S/185.html#L58465'>pBt</a>              58465 libdb/sqlite3.c   pBt = pParent-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L58466'>pBt</a>              58466 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L58519'>pBt</a>              58519 libdb/sqlite3.c     rc = getAndInitPage(pBt, pgno, &amp;apOld[i], 0);</span>
<span class='curline'><a href='../S/185.html#L58549'>pBt</a>              58549 libdb/sqlite3.c       if( pBt-&gt;btsFlags &amp; BTS_SECURE_DELETE ){</span>
<span class='curline'><a href='../S/185.html#L58553'>pBt</a>              58553 libdb/sqlite3.c         if( (iOff+szNew[i])&gt;(int)pBt-&gt;usableSize ){</span>
<span class='curline'><a href='../S/185.html#L58573'>pBt</a>              58573 libdb/sqlite3.c   k = pBt-&gt;pageSize + ROUND8(sizeof(MemPage));</span>
<span class='curline'><a href='../S/185.html#L58577'>pBt</a>              58577 libdb/sqlite3.c      + pBt-&gt;pageSize                               /* aSpace1 */</span>
<span class='curline'><a href='../S/185.html#L58613'>pBt</a>              58613 libdb/sqlite3.c     MemPage *pOld = apCopy[i] = (MemPage*)&amp;aSpace1[pBt-&gt;pageSize + k*i];</span>
<span class='curline'><a href='../S/185.html#L58616'>pBt</a>              58616 libdb/sqlite3.c     memcpy(pOld-&gt;aData, apOld[i]-&gt;aData, pBt-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L58644'>pBt</a>              58644 libdb/sqlite3.c       assert( sz&lt;=pBt-&gt;maxLocal+23 );</span>
<span class='curline'><a href='../S/185.html#L58645'>pBt</a>              58645 libdb/sqlite3.c       assert( iSpace1 &lt;= (int)pBt-&gt;pageSize );</span>
<span class='curline'><a href='../S/185.html#L58683'>pBt</a>              58683 libdb/sqlite3.c   usableSpace = pBt-&gt;usableSize - 12 + leafCorrection;</span>
<span class='curline'><a href='../S/185.html#L58769'>pBt</a>              58769 libdb/sqlite3.c       rc = allocateBtreePage(pBt, &amp;pNew, &amp;pgno, (bBulk ? 1 : pgno), 0);</span>
<span class='curline'><a href='../S/185.html#L58776'>pBt</a>              58776 libdb/sqlite3.c         ptrmapPut(pBt, pNew-&gt;pgno, PTRMAP_BTREE, pParent-&gt;pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L58896'>pBt</a>              58896 libdb/sqlite3.c       assert( sz&lt;=pBt-&gt;maxLocal+23 );</span>
<span class='curline'><a href='../S/185.html#L58897'>pBt</a>              58897 libdb/sqlite3.c       assert( iOvflSpace &lt;= (int)pBt-&gt;pageSize );</span>
<span class='curline'><a href='../S/185.html#L59017'>pBt</a>              59017 libdb/sqlite3.c           ptrmapPut(pBt, get4byte(apCell[i]), PTRMAP_BTREE, pNew-&gt;pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L59028'>pBt</a>              59028 libdb/sqlite3.c         ptrmapPut(pBt, key, PTRMAP_BTREE, apNew[i]-&gt;pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L59088'>pBt</a>              59088 libdb/sqlite3.c   BtShared *pBt = pRoot-&gt;pBt;    /* The BTree */</span>
<span class='curline'><a href='../S/185.html#L59091'>pBt</a>              59091 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L59099'>pBt</a>              59099 libdb/sqlite3.c     rc = allocateBtreePage(pBt,&amp;pChild,&amp;pgnoChild,pRoot-&gt;pgno,0);</span>
<span class='curline'><a href='../S/185.html#L59102'>pBt</a>              59102 libdb/sqlite3.c       ptrmapPut(pBt, pgnoChild, PTRMAP_BTREE, pRoot-&gt;pgno, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L59143'>pBt</a>              59143 libdb/sqlite3.c   const int nMin = pCur-&gt;pBt-&gt;usableSize * 2 / 3;</span>
<span class='curline'><a href='../S/185.html#L59222'>pBt</a>              59222 libdb/sqlite3.c           u8 *pSpace = sqlite3PageMalloc(pCur-&gt;pBt-&gt;pageSize);</span>
<span class='curline'><a href='../S/185.html#L59290'>pBt</a>              59290 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59301'>pBt</a>              59301 libdb/sqlite3.c               &amp;&amp; pBt-&gt;inTransaction==TRANS_WRITE</span>
<span class='curline'><a href='../S/185.html#L59302'>pBt</a>              59302 libdb/sqlite3.c               &amp;&amp; (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)==0 );</span>
<span class='curline'><a href='../S/185.html#L59323'>pBt</a>              59323 libdb/sqlite3.c   rc = saveAllCursors(pBt, pCur-&gt;pgnoRoot, pCur);</span>
<span class='curline'><a href='../S/185.html#L59354'>pBt</a>              59354 libdb/sqlite3.c   newCell = pBt-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L59359'>pBt</a>              59359 libdb/sqlite3.c   assert( szNew &lt;= MX_CELL_SIZE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L59428'>pBt</a>              59428 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;              </span>
<span class='curline'><a href='../S/185.html#L59437'>pBt</a>              59437 libdb/sqlite3.c   assert( pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L59438'>pBt</a>              59438 libdb/sqlite3.c   assert( (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)==0 );</span>
<span class='curline'><a href='../S/185.html#L59472'>pBt</a>              59472 libdb/sqlite3.c   rc = saveAllCursors(pBt, pCur-&gt;pgnoRoot, pCur);</span>
<span class='curline'><a href='../S/185.html#L59500'>pBt</a>              59500 libdb/sqlite3.c     assert( MX_CELL_SIZE(pBt) &gt;= nCell );</span>
<span class='curline'><a href='../S/185.html#L59501'>pBt</a>              59501 libdb/sqlite3.c     pTmp = pBt-&gt;pTmpSpace;</span>
<span class='curline'><a href='../S/185.html#L59550'>pBt</a>              59550 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59557'>pBt</a>              59557 libdb/sqlite3.c   assert( pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L59558'>pBt</a>              59558 libdb/sqlite3.c   assert( (pBt-&gt;btsFlags &amp; BTS_READ_ONLY)==0 );</span>
<span class='curline'><a href='../S/185.html#L59561'>pBt</a>              59561 libdb/sqlite3.c   rc = allocateBtreePage(pBt, &amp;pRoot, &amp;pgnoRoot, 1, 0);</span>
<span class='curline'><a href='../S/185.html#L59566'>pBt</a>              59566 libdb/sqlite3.c   if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L59575'>pBt</a>              59575 libdb/sqlite3.c     invalidateAllOverflowCache(pBt);</span>
<span class='curline'><a href='../S/185.html#L59587'>pBt</a>              59587 libdb/sqlite3.c     while( pgnoRoot==PTRMAP_PAGENO(pBt, pgnoRoot) ||</span>
<span class='curline'><a href='../S/185.html#L59588'>pBt</a>              59588 libdb/sqlite3.c         pgnoRoot==PENDING_BYTE_PAGE(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L59597'>pBt</a>              59597 libdb/sqlite3.c     rc = allocateBtreePage(pBt, &amp;pPageMove, &amp;pgnoMove, pgnoRoot, BTALLOC_EXACT);</span>
<span class='curline'><a href='../S/185.html#L59615'>pBt</a>              59615 libdb/sqlite3.c       rc = saveAllCursors(pBt, 0, 0);</span>
<span class='curline'><a href='../S/185.html#L59622'>pBt</a>              59622 libdb/sqlite3.c       rc = btreeGetPage(pBt, pgnoRoot, &amp;pRoot, 0);</span>
<span class='curline'><a href='../S/185.html#L59626'>pBt</a>              59626 libdb/sqlite3.c       rc = ptrmapGet(pBt, pgnoRoot, &amp;eType, &amp;iPtrPage);</span>
<span class='curline'><a href='../S/185.html#L59636'>pBt</a>              59636 libdb/sqlite3.c       rc = relocatePage(pBt, pRoot, eType, iPtrPage, pgnoMove, 0);</span>
<span class='curline'><a href='../S/185.html#L59643'>pBt</a>              59643 libdb/sqlite3.c       rc = btreeGetPage(pBt, pgnoRoot, &amp;pRoot, 0);</span>
<span class='curline'><a href='../S/185.html#L59657'>pBt</a>              59657 libdb/sqlite3.c     ptrmapPut(pBt, pgnoRoot, PTRMAP_ROOTPAGE, 0, &amp;rc);</span>
<span class='curline'><a href='../S/185.html#L59667'>pBt</a>              59667 libdb/sqlite3.c     assert( sqlite3PagerIswriteable(pBt-&gt;pPage1-&gt;pDbPage) );</span>
<span class='curline'><a href='../S/185.html#L59675'>pBt</a>              59675 libdb/sqlite3.c     rc = allocateBtreePage(pBt, &amp;pRoot, &amp;pgnoRoot, 1, 0);</span>
<span class='curline'><a href='../S/185.html#L59687'>pBt</a>              59687 libdb/sqlite3.c   assert( (pBt-&gt;openFlags &amp; BTREE_SINGLE)==0 || pgnoRoot==2 );</span>
<span class='curline'><a href='../S/185.html#L59704'>pBt</a>              59704 libdb/sqlite3.c   BtShared *pBt,           /* The BTree that contains the table */</span>
<span class='curline'><a href='../S/185.html#L59716'>pBt</a>              59716 libdb/sqlite3.c   assert( sqlite3_mutex_held(pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L59717'>pBt</a>              59717 libdb/sqlite3.c   if( pgno&gt;btreePagecount(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L59721'>pBt</a>              59721 libdb/sqlite3.c   rc = getAndInitPage(pBt, pgno, &amp;pPage, 0);</span>
<span class='curline'><a href='../S/185.html#L59727'>pBt</a>              59727 libdb/sqlite3.c       rc = clearDatabasePage(pBt, get4byte(pCell), 1, pnChange);</span>
<span class='curline'><a href='../S/185.html#L59734'>pBt</a>              59734 libdb/sqlite3.c     rc = clearDatabasePage(pBt, get4byte(&amp;pPage-&gt;aData[hdr+8]), 1, pnChange);</span>
<span class='curline'><a href='../S/185.html#L59766'>pBt</a>              59766 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59770'>pBt</a>              59770 libdb/sqlite3.c   rc = saveAllCursors(pBt, (Pgno)iTable, 0);</span>
<span class='curline'><a href='../S/185.html#L59777'>pBt</a>              59777 libdb/sqlite3.c     rc = clearDatabasePage(pBt, (Pgno)iTable, 0, pnChange);</span>
<span class='curline'><a href='../S/185.html#L59815'>pBt</a>              59815 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59828'>pBt</a>              59828 libdb/sqlite3.c   if( NEVER(pBt-&gt;pCursor) ){</span>
<span class='curline'><a href='../S/185.html#L59829'>pBt</a>              59829 libdb/sqlite3.c     sqlite3ConnectionBlocked(p-&gt;db, pBt-&gt;pCursor-&gt;pBtree-&gt;db);</span>
<span class='curline'><a href='../S/185.html#L59833'>pBt</a>              59833 libdb/sqlite3.c   rc = btreeGetPage(pBt, (Pgno)iTable, &amp;pPage, 0);</span>
<span class='curline'><a href='../S/185.html#L59848'>pBt</a>              59848 libdb/sqlite3.c     if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L59868'>pBt</a>              59868 libdb/sqlite3.c         rc = btreeGetPage(pBt, maxRootPgno, &amp;pMove, 0);</span>
<span class='curline'><a href='../S/185.html#L59872'>pBt</a>              59872 libdb/sqlite3.c         rc = relocatePage(pBt, pMove, PTRMAP_ROOTPAGE, 0, iTable, 0);</span>
<span class='curline'><a href='../S/185.html#L59878'>pBt</a>              59878 libdb/sqlite3.c         rc = btreeGetPage(pBt, maxRootPgno, &amp;pMove, 0);</span>
<span class='curline'><a href='../S/185.html#L59893'>pBt</a>              59893 libdb/sqlite3.c       while( maxRootPgno==PENDING_BYTE_PAGE(pBt)</span>
<span class='curline'><a href='../S/185.html#L59894'>pBt</a>              59894 libdb/sqlite3.c              || PTRMAP_ISPAGE(pBt, maxRootPgno) ){</span>
<span class='curline'><a href='../S/185.html#L59897'>pBt</a>              59897 libdb/sqlite3.c       assert( maxRootPgno!=PENDING_BYTE_PAGE(pBt) );</span>
<span class='curline'><a href='../S/185.html#L59938'>pBt</a>              59938 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59943'>pBt</a>              59943 libdb/sqlite3.c   assert( pBt-&gt;pPage1 );</span>
<span class='curline'><a href='../S/185.html#L59946'>pBt</a>              59946 libdb/sqlite3.c   *pMeta = get4byte(&amp;pBt-&gt;pPage1-&gt;aData[36 + idx*4]);</span>
<span class='curline'><a href='../S/185.html#L59952'>pBt</a>              59952 libdb/sqlite3.c     pBt-&gt;btsFlags |= BTS_READ_ONLY;</span>
<span class='curline'><a href='../S/185.html#L59964'>pBt</a>              59964 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L59970'>pBt</a>              59970 libdb/sqlite3.c   assert( pBt-&gt;pPage1!=0 );</span>
<span class='curline'><a href='../S/185.html#L59971'>pBt</a>              59971 libdb/sqlite3.c   pP1 = pBt-&gt;pPage1-&gt;aData;</span>
<span class='curline'><a href='../S/185.html#L59972'>pBt</a>              59972 libdb/sqlite3.c   rc = sqlite3PagerWrite(pBt-&gt;pPage1-&gt;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L59977'>pBt</a>              59977 libdb/sqlite3.c       assert( pBt-&gt;autoVacuum || iMeta==0 );</span>
<span class='curline'><a href='../S/185.html#L59979'>pBt</a>              59979 libdb/sqlite3.c       pBt-&gt;incrVacuum = (u8)iMeta;</span>
<span class='curline'><a href='../S/185.html#L60067'>pBt</a>              60067 libdb/sqlite3.c   return p-&gt;pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L60158'>pBt</a>              60158 libdb/sqlite3.c   rc = ptrmapGet(pCheck-&gt;pBt, iChild, &amp;ePtrmapType, &amp;iPtrmapParent);</span>
<span class='curline'><a href='../S/185.html#L60204'>pBt</a>              60204 libdb/sqlite3.c       if( pCheck-&gt;pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L60208'>pBt</a>              60208 libdb/sqlite3.c       if( n&gt;(int)pCheck-&gt;pBt-&gt;usableSize/4-2 ){</span>
<span class='curline'><a href='../S/185.html#L60216'>pBt</a>              60216 libdb/sqlite3.c           if( pCheck-&gt;pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L60231'>pBt</a>              60231 libdb/sqlite3.c       if( pCheck-&gt;pBt-&gt;autoVacuum &amp;&amp; N&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L60273'>pBt</a>              60273 libdb/sqlite3.c   BtShared *pBt;</span>
<span class='curline'><a href='../S/185.html#L60284'>pBt</a>              60284 libdb/sqlite3.c   pBt = pCheck-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L60285'>pBt</a>              60285 libdb/sqlite3.c   usableSize = pBt-&gt;usableSize;</span>
<span class='curline'><a href='../S/185.html#L60290'>pBt</a>              60290 libdb/sqlite3.c   if( (rc = btreeGetPage(pBt, (Pgno)iPage, &amp;pPage, 0))!=0 ){</span>
<span class='curline'><a href='../S/185.html#L60337'>pBt</a>              60337 libdb/sqlite3.c      &amp;&amp; (&amp;pCell[info.iOverflow]&lt;=&amp;pPage-&gt;aData[pBt-&gt;usableSize])</span>
<span class='curline'><a href='../S/185.html#L60342'>pBt</a>              60342 libdb/sqlite3.c       if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L60354'>pBt</a>              60354 libdb/sqlite3.c       if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L60371'>pBt</a>              60371 libdb/sqlite3.c     if( pBt-&gt;autoVacuum ){</span>
<span class='curline'><a href='../S/185.html#L60420'>pBt</a>              60420 libdb/sqlite3.c   hit = sqlite3PageMalloc( pBt-&gt;pageSize );</span>
<span class='curline'><a href='../S/185.html#L60508'>pBt</a>              60508 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L60512'>pBt</a>              60512 libdb/sqlite3.c   assert( p-&gt;inTrans&gt;TRANS_NONE &amp;&amp; pBt-&gt;inTransaction&gt;TRANS_NONE );</span>
<span class='curline'><a href='../S/185.html#L60513'>pBt</a>              60513 libdb/sqlite3.c   nRef = sqlite3PagerRefcount(pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L60514'>pBt</a>              60514 libdb/sqlite3.c   sCheck.pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L60515'>pBt</a>              60515 libdb/sqlite3.c   sCheck.pPager = pBt-&gt;pPager;</span>
<span class='curline'><a href='../S/185.html#L60516'>pBt</a>              60516 libdb/sqlite3.c   sCheck.nPage = btreePagecount(sCheck.pBt);</span>
<span class='curline'><a href='../S/185.html#L60535'>pBt</a>              60535 libdb/sqlite3.c   i = PENDING_BYTE_PAGE(pBt);</span>
<span class='curline'><a href='../S/185.html#L60543'>pBt</a>              60543 libdb/sqlite3.c   checkList(&amp;sCheck, 1, get4byte(&amp;pBt-&gt;pPage1-&gt;aData[32]),</span>
<span class='curline'><a href='../S/185.html#L60544'>pBt</a>              60544 libdb/sqlite3.c             get4byte(&amp;pBt-&gt;pPage1-&gt;aData[36]));</span>
<span class='curline'><a href='../S/185.html#L60552'>pBt</a>              60552 libdb/sqlite3.c     if( pBt-&gt;autoVacuum &amp;&amp; aRoot[i]&gt;1 ){</span>
<span class='curline'><a href='../S/185.html#L60573'>pBt</a>              60573 libdb/sqlite3.c        (PTRMAP_PAGENO(pBt, i)!=i || !pBt-&gt;autoVacuum) ){</span>
<span class='curline'><a href='../S/185.html#L60577'>pBt</a>              60577 libdb/sqlite3.c        (PTRMAP_PAGENO(pBt, i)==i &amp;&amp; pBt-&gt;autoVacuum) ){</span>
<span class='curline'><a href='../S/185.html#L60587'>pBt</a>              60587 libdb/sqlite3.c   if( NEVER(nRef != sqlite3PagerRefcount(pBt-&gt;pPager)) ){</span>
<span class='curline'><a href='../S/185.html#L60590'>pBt</a>              60590 libdb/sqlite3.c       nRef, sqlite3PagerRefcount(pBt-&gt;pPager)</span>
<span class='curline'><a href='../S/185.html#L60617'>pBt</a>              60617 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L60618'>pBt</a>              60618 libdb/sqlite3.c   return sqlite3PagerFilename(p-&gt;pBt-&gt;pPager, 1);</span>
<span class='curline'><a href='../S/185.html#L60630'>pBt</a>              60630 libdb/sqlite3.c   assert( p-&gt;pBt-&gt;pPager!=0 );</span>
<span class='curline'><a href='../S/185.html#L60631'>pBt</a>              60631 libdb/sqlite3.c   return sqlite3PagerJournalname(p-&gt;pBt-&gt;pPager);</span>
<span class='curline'><a href='../S/185.html#L60654'>pBt</a>              60654 libdb/sqlite3.c     BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L60656'>pBt</a>              60656 libdb/sqlite3.c     if( pBt-&gt;inTransaction!=TRANS_NONE ){</span>
<span class='curline'><a href='../S/185.html#L60659'>pBt</a>              60659 libdb/sqlite3.c       rc = sqlite3PagerCheckpoint(pBt-&gt;pPager, eMode, pnLog, pnCkpt);</span>
<span class='curline'><a href='../S/185.html#L60703'>pBt</a>              60703 libdb/sqlite3.c   BtShared *pBt = p-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L60705'>pBt</a>              60705 libdb/sqlite3.c   if( !pBt-&gt;pSchema &amp;&amp; nBytes ){</span>
<span class='curline'><a href='../S/185.html#L60706'>pBt</a>              60706 libdb/sqlite3.c     pBt-&gt;pSchema = sqlite3DbMallocZero(0, nBytes);</span>
<span class='curline'><a href='../S/185.html#L60707'>pBt</a>              60707 libdb/sqlite3.c     pBt-&gt;xFreeSchema = xFree;</span>
<span class='curline'><a href='../S/185.html#L60710'>pBt</a>              60710 libdb/sqlite3.c   return pBt-&gt;pSchema;</span>
<span class='curline'><a href='../S/185.html#L60788'>pBt</a>              60788 libdb/sqlite3.c   VVA_ONLY(rc =) saveAllCursors(pCsr-&gt;pBt, pCsr-&gt;pgnoRoot, pCsr);</span>
<span class='curline'><a href='../S/185.html#L60801'>pBt</a>              60801 libdb/sqlite3.c   assert( (pCsr-&gt;pBt-&gt;btsFlags &amp; BTS_READ_ONLY)==0</span>
<span class='curline'><a href='../S/185.html#L60802'>pBt</a>              60802 libdb/sqlite3.c               &amp;&amp; pCsr-&gt;pBt-&gt;inTransaction==TRANS_WRITE );</span>
<span class='curline'><a href='../S/185.html#L60824'>pBt</a>              60824 libdb/sqlite3.c   BtShared *pBt = pBtree-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L60832'>pBt</a>              60832 libdb/sqlite3.c   pBt-&gt;btsFlags &amp;= ~BTS_NO_WAL;</span>
<span class='curline'><a href='../S/185.html#L60833'>pBt</a>              60833 libdb/sqlite3.c   if( iVersion==1 ) pBt-&gt;btsFlags |= BTS_NO_WAL;</span>
<span class='curline'><a href='../S/185.html#L60837'>pBt</a>              60837 libdb/sqlite3.c     u8 *aData = pBt-&gt;pPage1-&gt;aData;</span>
<span class='curline'><a href='../S/185.html#L60841'>pBt</a>              60841 libdb/sqlite3.c         rc = sqlite3PagerWrite(pBt-&gt;pPage1-&gt;pDbPage);</span>
<span class='curline'><a href='../S/185.html#L60850'>pBt</a>              60850 libdb/sqlite3.c   pBt-&gt;btsFlags &amp;= ~BTS_NO_WAL;</span>
<span class='curline'><a href='../S/185.html#L60867'>pBt</a>              60867 libdb/sqlite3.c   return (p-&gt;pBt-&gt;btsFlags &amp; BTS_READ_ONLY)!=0;</span>
<span class='curline'><a href='../S/185.html#L60981'>pBt</a>              60981 libdb/sqlite3.c   return pDb-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L61103'>pBt</a>              61103 libdb/sqlite3.c   assert( iSrcPg!=PENDING_BYTE_PAGE(p-&gt;pSrc-&gt;pBt) );</span>
<span class='curline'><a href='../S/185.html#L61140'>pBt</a>              61140 libdb/sqlite3.c     if( iDest==PENDING_BYTE_PAGE(p-&gt;pDest-&gt;pBt) ) continue;</span>
<span class='curline'><a href='../S/185.html#L61223'>pBt</a>              61223 libdb/sqlite3.c     if( p-&gt;pDestDb &amp;&amp; p-&gt;pSrc-&gt;pBt-&gt;inTransaction==TRANS_WRITE ){</span>
<span class='curline'><a href='../S/185.html#L61262'>pBt</a>              61262 libdb/sqlite3.c       if( iSrcPg!=PENDING_BYTE_PAGE(p-&gt;pSrc-&gt;pBt) ){</span>
<span class='curline'><a href='../S/185.html#L61323'>pBt</a>              61323 libdb/sqlite3.c           if( nDestTruncate==(int)PENDING_BYTE_PAGE(p-&gt;pDest-&gt;pBt) ){</span>
<span class='curline'><a href='../S/185.html#L61351'>pBt</a>              61351 libdb/sqlite3.c                 nDestTruncate==(int)(PENDING_BYTE_PAGE(p-&gt;pDest-&gt;pBt)-1)</span>
<span class='curline'><a href='../S/185.html#L61363'>pBt</a>              61363 libdb/sqlite3.c             if( iPg!=PENDING_BYTE_PAGE(p-&gt;pDest-&gt;pBt) ){</span>
<span class='curline'><a href='../S/185.html#L61521'>pBt</a>              61521 libdb/sqlite3.c     assert( sqlite3_mutex_held(p-&gt;pSrc-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L61554'>pBt</a>              61554 libdb/sqlite3.c     assert( sqlite3_mutex_held(p-&gt;pSrc-&gt;pBt-&gt;mutex) );</span>
<span class='curline'><a href='../S/185.html#L61606'>pBt</a>              61606 libdb/sqlite3.c     pTo-&gt;pBt-&gt;btsFlags &amp;= ~BTS_PAGESIZE_FIXED;</span>
<span class='curline'><a href='../S/185.html#L64325'>pBt</a>              64325 libdb/sqlite3.c   if( i!=1 &amp;&amp; sqlite3BtreeSharable(p-&gt;db-&gt;aDb[i].pBt) ){</span>
<span class='curline'><a href='../S/185.html#L64362'>pBt</a>              64362 libdb/sqlite3.c     if( i!=1 &amp;&amp; DbMaskTest(p-&gt;lockMask,i) &amp;&amp; ALWAYS(aDb[i].pBt!=0) ){</span>
<span class='curline'><a href='../S/185.html#L64363'>pBt</a>              64363 libdb/sqlite3.c       sqlite3BtreeEnter(aDb[i].pBt);</span>
<span class='curline'><a href='../S/185.html#L64383'>pBt</a>              64383 libdb/sqlite3.c     if( i!=1 &amp;&amp; DbMaskTest(p-&gt;lockMask,i) &amp;&amp; ALWAYS(aDb[i].pBt!=0) ){</span>
<span class='curline'><a href='../S/185.html#L64384'>pBt</a>              64384 libdb/sqlite3.c       sqlite3BtreeLeave(aDb[i].pBt);</span>
<span class='curline'><a href='../S/185.html#L64934'>pBt</a>              64934 libdb/sqlite3.c   if( pCx-&gt;pBt ){</span>
<span class='curline'><a href='../S/185.html#L64935'>pBt</a>              64935 libdb/sqlite3.c     sqlite3BtreeClose(pCx-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L65125'>pBt</a>              65125 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65126'>pBt</a>              65126 libdb/sqlite3.c     if( sqlite3BtreeIsInTrans(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L65129'>pBt</a>              65129 libdb/sqlite3.c       sqlite3BtreeEnter(pBt);</span>
<span class='curline'><a href='../S/185.html#L65130'>pBt</a>              65130 libdb/sqlite3.c       rc = sqlite3PagerExclusiveLock(sqlite3BtreePager(pBt));</span>
<span class='curline'><a href='../S/185.html#L65131'>pBt</a>              65131 libdb/sqlite3.c       sqlite3BtreeLeave(pBt);</span>
<span class='curline'><a href='../S/185.html#L65155'>pBt</a>              65155 libdb/sqlite3.c   if( 0==sqlite3Strlen30(sqlite3BtreeGetFilename(db-&gt;aDb[0].pBt))</span>
<span class='curline'><a href='../S/185.html#L65159'>pBt</a>              65159 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65160'>pBt</a>              65160 libdb/sqlite3.c       if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L65161'>pBt</a>              65161 libdb/sqlite3.c         rc = sqlite3BtreeCommitPhaseOne(pBt, 0);</span>
<span class='curline'><a href='../S/185.html#L65171'>pBt</a>              65171 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65172'>pBt</a>              65172 libdb/sqlite3.c       if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L65173'>pBt</a>              65173 libdb/sqlite3.c         rc = sqlite3BtreeCommitPhaseTwo(pBt, 0);</span>
<span class='curline'><a href='../S/185.html#L65190'>pBt</a>              65190 libdb/sqlite3.c     char const *zMainFile = sqlite3BtreeGetFilename(db-&gt;aDb[0].pBt);</span>
<span class='curline'><a href='../S/185.html#L65241'>pBt</a>              65241 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65242'>pBt</a>              65242 libdb/sqlite3.c       if( sqlite3BtreeIsInTrans(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L65243'>pBt</a>              65243 libdb/sqlite3.c         char const *zFile = sqlite3BtreeGetJournalname(pBt);</span>
<span class='curline'><a href='../S/185.html#L65248'>pBt</a>              65248 libdb/sqlite3.c         if( !needSync &amp;&amp; !sqlite3BtreeSyncDisabled(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L65286'>pBt</a>              65286 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65287'>pBt</a>              65287 libdb/sqlite3.c       if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L65288'>pBt</a>              65288 libdb/sqlite3.c         rc = sqlite3BtreeCommitPhaseOne(pBt, zMaster);</span>
<span class='curline'><a href='../S/185.html#L65319'>pBt</a>              65319 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65320'>pBt</a>              65320 libdb/sqlite3.c       if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L65321'>pBt</a>              65321 libdb/sqlite3.c         sqlite3BtreeCommitPhaseTwo(pBt, 1);</span>
<span class='curline'><a href='../S/185.html#L65395'>pBt</a>              65395 libdb/sqlite3.c       Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L65396'>pBt</a>              65396 libdb/sqlite3.c       if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L65398'>pBt</a>              65398 libdb/sqlite3.c           rc2 = sqlite3BtreeSavepoint(pBt, SAVEPOINT_ROLLBACK, iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L65401'>pBt</a>              65401 libdb/sqlite3.c           rc2 = sqlite3BtreeSavepoint(pBt, SAVEPOINT_RELEASE, iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L67675'>pBt</a>              67675 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L67676'>pBt</a>              67676 libdb/sqlite3.c     if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L67677'>pBt</a>              67677 libdb/sqlite3.c       int nEntry = sqlite3PagerWalCallback(sqlite3BtreePager(pBt));</span>
<span class='curline'><a href='../S/185.html#L71834'>pBt</a>              71834 libdb/sqlite3.c             sqlite3BtreeTripAllCursors(db-&gt;aDb[ii].pBt, SQLITE_ABORT);</span>
<span class='curline'><a href='../S/185.html#L71838'>pBt</a>              71838 libdb/sqlite3.c           rc = sqlite3BtreeSavepoint(db-&gt;aDb[ii].pBt, p1, iSavepoint);</span>
<span class='curline'><a href='../S/185.html#L71995'>pBt</a>              71995 libdb/sqlite3.c   Btree *pBt;</span>
<span class='curline'><a href='../S/185.html#L72007'>pBt</a>              72007 libdb/sqlite3.c   pBt = db-&gt;aDb[pOp-&gt;p1].pBt;</span>
<span class='curline'><a href='../S/185.html#L72009'>pBt</a>              72009 libdb/sqlite3.c   if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L72010'>pBt</a>              72010 libdb/sqlite3.c     rc = sqlite3BtreeBeginTrans(pBt, pOp-&gt;p2);</span>
<span class='curline'><a href='../S/185.html#L72023'>pBt</a>              72023 libdb/sqlite3.c       assert( sqlite3BtreeIsInTrans(pBt) );</span>
<span class='curline'><a href='../S/185.html#L72032'>pBt</a>              72032 libdb/sqlite3.c         rc = sqlite3BtreeBeginStmt(pBt, p-&gt;iStatement);</span>
<span class='curline'><a href='../S/185.html#L72043'>pBt</a>              72043 libdb/sqlite3.c     sqlite3BtreeGetMeta(pBt, BTREE_SCHEMA_VERSION, (u32 *)&amp;iMeta);</span>
<span class='curline'><a href='../S/185.html#L72096'>pBt</a>              72096 libdb/sqlite3.c   assert( db-&gt;aDb[iDb].pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L72099'>pBt</a>              72099 libdb/sqlite3.c   sqlite3BtreeGetMeta(db-&gt;aDb[iDb].pBt, iCookie, (u32 *)&amp;iMeta);</span>
<span class='curline'><a href='../S/185.html#L72121'>pBt</a>              72121 libdb/sqlite3.c   assert( pDb-&gt;pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L72126'>pBt</a>              72126 libdb/sqlite3.c   rc = sqlite3BtreeUpdateMeta(pDb-&gt;pBt, pOp-&gt;p2, (int)pIn3-&gt;u.i);</span>
<span class='curline'><a href='../S/185.html#L72251'>pBt</a>              72251 libdb/sqlite3.c   pX = pDb-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L72351'>pBt</a>              72351 libdb/sqlite3.c   rc = sqlite3BtreeOpen(db-&gt;pVfs, 0, db, &amp;pCx-&gt;pBt, </span>
<span class='curline'><a href='../S/185.html#L72354'>pBt</a>              72354 libdb/sqlite3.c     rc = sqlite3BtreeBeginTrans(pCx-&gt;pBt, 1);</span>
<span class='curline'><a href='../S/185.html#L72365'>pBt</a>              72365 libdb/sqlite3.c       rc = sqlite3BtreeCreateTable(pCx-&gt;pBt, &amp;pgno, BTREE_BLOBKEY | pOp-&gt;p5); </span>
<span class='curline'><a href='../S/185.html#L72371'>pBt</a>              72371 libdb/sqlite3.c         rc = sqlite3BtreeCursor(pCx-&gt;pBt, pgno, 1, pKeyInfo, pCx-&gt;pCursor);</span>
<span class='curline'><a href='../S/185.html#L72375'>pBt</a>              72375 libdb/sqlite3.c       rc = sqlite3BtreeCursor(pCx-&gt;pBt, MASTER_ROOT, 1, 0, pCx-&gt;pCursor);</span>
<span class='curline'><a href='../S/185.html#L73926'>pBt</a>              73926 libdb/sqlite3.c     rc = sqlite3BtreeDropTable(db-&gt;aDb[iDb].pBt, pOp-&gt;p1, &amp;iMoved);</span>
<span class='curline'><a href='../S/185.html#L73966'>pBt</a>              73966 libdb/sqlite3.c       db-&gt;aDb[pOp-&gt;p2].pBt, pOp-&gt;p1, (pOp-&gt;p3 ? &amp;nChange : 0)</span>
<span class='curline'><a href='../S/185.html#L74037'>pBt</a>              74037 libdb/sqlite3.c   assert( pDb-&gt;pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L74044'>pBt</a>              74044 libdb/sqlite3.c   rc = sqlite3BtreeCreateTable(pDb-&gt;pBt, &amp;pgno, flags);</span>
<span class='curline'><a href='../S/185.html#L74069'>pBt</a>              74069 libdb/sqlite3.c     assert( iDb==1 || sqlite3BtreeHoldsMutex(db-&gt;aDb[iDb].pBt) );</span>
<span class='curline'><a href='../S/185.html#L74203'>pBt</a>              74203 libdb/sqlite3.c   z = sqlite3BtreeIntegrityCheck(db-&gt;aDb[pOp-&gt;p5].pBt, aRoot, nRoot,</span>
<span class='curline'><a href='../S/185.html#L74731'>pBt</a>              74731 libdb/sqlite3.c   Btree *pBt;                     /* Btree to change journal mode of */</span>
<span class='curline'><a href='../S/185.html#L74751'>pBt</a>              74751 libdb/sqlite3.c   pBt = db-&gt;aDb[pOp-&gt;p1].pBt;</span>
<span class='curline'><a href='../S/185.html#L74752'>pBt</a>              74752 libdb/sqlite3.c   pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L74801'>pBt</a>              74801 libdb/sqlite3.c       assert( sqlite3BtreeIsInTrans(pBt)==0 );</span>
<span class='curline'><a href='../S/185.html#L74803'>pBt</a>              74803 libdb/sqlite3.c         rc = sqlite3BtreeSetVersion(pBt, (eNew==PAGER_JOURNALMODE_WAL ? 2 : 1));</span>
<span class='curline'><a href='../S/185.html#L74846'>pBt</a>              74846 libdb/sqlite3.c   Btree *pBt;</span>
<span class='curline'><a href='../S/185.html#L74851'>pBt</a>              74851 libdb/sqlite3.c   pBt = db-&gt;aDb[pOp-&gt;p1].pBt;</span>
<span class='curline'><a href='../S/185.html#L74852'>pBt</a>              74852 libdb/sqlite3.c   rc = sqlite3BtreeIncrVacuum(pBt);</span>
<span class='curline'><a href='../S/185.html#L74904'>pBt</a>              74904 libdb/sqlite3.c     rc = sqlite3BtreeLockTable(db-&gt;aDb[p1].pBt, pOp-&gt;p2, isWriteLock);</span>
<span class='curline'><a href='../S/185.html#L75275'>pBt</a>              75275 libdb/sqlite3.c   pOut-&gt;u.i = sqlite3BtreeLastPage(db-&gt;aDb[pOp-&gt;p1].pBt);</span>
<span class='curline'><a href='../S/185.html#L75292'>pBt</a>              75292 libdb/sqlite3.c   Btree *pBt;</span>
<span class='curline'><a href='../S/185.html#L75294'>pBt</a>              75294 libdb/sqlite3.c   pBt = db-&gt;aDb[pOp-&gt;p1].pBt;</span>
<span class='curline'><a href='../S/185.html#L75297'>pBt</a>              75297 libdb/sqlite3.c     newMax = sqlite3BtreeLastPage(pBt);</span>
<span class='curline'><a href='../S/185.html#L75300'>pBt</a>              75300 libdb/sqlite3.c   pOut-&gt;u.i = sqlite3BtreeMaxPageCount(pBt, newMax);</span>
<span class='curline'><a href='../S/185.html#L76763'>pBt</a>              76763 libdb/sqlite3.c   assert( pCsr-&gt;pKeyInfo &amp;&amp; pCsr-&gt;pBt==0 );</span>
<span class='curline'><a href='../S/185.html#L76776'>pBt</a>              76776 libdb/sqlite3.c     pSorter-&gt;pgsz = pgsz = sqlite3BtreeGetPageSize(db-&gt;aDb[0].pBt);</span>
<span class='curline'><a href='../S/185.html#L87607'>pBt</a>              87607 libdb/sqlite3.c   assert( db-&gt;aDb[iDb].pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L87799'>pBt</a>              87799 libdb/sqlite3.c   rc = sqlite3BtreeOpen(pVfs, zPath, db, &amp;aNew-&gt;pBt, 0, flags);</span>
<span class='curline'><a href='../S/185.html#L87807'>pBt</a>              87807 libdb/sqlite3.c     aNew-&gt;pSchema = sqlite3SchemaGet(db, aNew-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L87815'>pBt</a>              87815 libdb/sqlite3.c     pPager = sqlite3BtreePager(aNew-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L87817'>pBt</a>              87817 libdb/sqlite3.c     sqlite3BtreeSecureDelete(aNew-&gt;pBt,</span>
<span class='curline'><a href='../S/185.html#L87818'>pBt</a>              87818 libdb/sqlite3.c                              sqlite3BtreeSecureDelete(db-&gt;aDb[0].pBt,-1) );</span>
<span class='curline'><a href='../S/185.html#L87820'>pBt</a>              87820 libdb/sqlite3.c     sqlite3BtreeSetPagerFlags(aNew-&gt;pBt, 3 | (db-&gt;flags &amp; PAGER_FLAGS_MASK));</span>
<span class='curline'><a href='../S/185.html#L87854'>pBt</a>              87854 libdb/sqlite3.c         if( nKey&gt;0 || sqlite3BtreeGetReserve(db-&gt;aDb[0].pBt)&gt;0 ){</span>
<span class='curline'><a href='../S/185.html#L87884'>pBt</a>              87884 libdb/sqlite3.c     if( db-&gt;aDb[iDb].pBt ){</span>
<span class='curline'><a href='../S/185.html#L87885'>pBt</a>              87885 libdb/sqlite3.c       sqlite3BtreeClose(db-&gt;aDb[iDb].pBt);</span>
<span class='curline'><a href='../S/185.html#L87886'>pBt</a>              87886 libdb/sqlite3.c       db-&gt;aDb[iDb].pBt = 0;</span>
<span class='curline'><a href='../S/185.html#L87936'>pBt</a>              87936 libdb/sqlite3.c     if( pDb-&gt;pBt==0 ) continue;</span>
<span class='curline'><a href='../S/185.html#L87953'>pBt</a>              87953 libdb/sqlite3.c   if( sqlite3BtreeIsInReadTrans(pDb-&gt;pBt) || sqlite3BtreeIsInBackup(pDb-&gt;pBt) ){</span>
<span class='curline'><a href='../S/185.html#L87958'>pBt</a>              87958 libdb/sqlite3.c   sqlite3BtreeClose(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L87959'>pBt</a>              87959 libdb/sqlite3.c   pDb-&gt;pBt = 0;</span>
<span class='curline'><a href='../S/185.html#L88993'>pBt</a>              88993 libdb/sqlite3.c     if( pDb-&gt;pBt==0 ){</span>
<span class='curline'><a href='../S/185.html#L89862'>pBt</a>              89862 libdb/sqlite3.c    &amp;&amp; !sqlite3BtreeIsReadonly(db-&gt;aDb[db-&gt;init.iDb].pBt)</span>
<span class='curline'><a href='../S/185.html#L92363'>pBt</a>              92363 libdb/sqlite3.c   if( db-&gt;aDb[1].pBt==0 &amp;&amp; !pParse-&gt;explain ){</span>
<span class='curline'><a href='../S/185.html#L92365'>pBt</a>              92365 libdb/sqlite3.c     Btree *pBt;</span>
<span class='curline'><a href='../S/185.html#L92373'>pBt</a>              92373 libdb/sqlite3.c     rc = sqlite3BtreeOpen(db-&gt;pVfs, 0, db, &amp;pBt, 0, flags);</span>
<span class='curline'><a href='../S/185.html#L92380'>pBt</a>              92380 libdb/sqlite3.c     db-&gt;aDb[1].pBt = pBt;</span>
<span class='curline'><a href='../S/185.html#L92382'>pBt</a>              92382 libdb/sqlite3.c     if( SQLITE_NOMEM==sqlite3BtreeSetPageSize(pBt, db-&gt;nextPagesize, -1, 0) ){</span>
<span class='curline'><a href='../S/185.html#L92401'>pBt</a>              92401 libdb/sqlite3.c   assert( db-&gt;aDb[iDb].pBt!=0 || iDb==1 );</span>
<span class='curline'><a href='../S/185.html#L92422'>pBt</a>              92422 libdb/sqlite3.c     if( pDb-&gt;pBt &amp;&amp; (!zDb || 0==sqlite3StrICmp(zDb, pDb-&gt;zName)) ){</span>
<span class='curline'><a href='../S/185.html#L93261'>pBt</a>              93261 libdb/sqlite3.c SQLITE_PRIVATE Schema *sqlite3SchemaGet(sqlite3 *db, Btree *pBt){</span>
<span class='curline'><a href='../S/185.html#L93263'>pBt</a>              93263 libdb/sqlite3.c   if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L93264'>pBt</a>              93264 libdb/sqlite3.c     p = (Schema *)sqlite3BtreeSchema(pBt, sizeof(Schema), sqlite3SchemaClear);</span>
<span class='curline'><a href='../S/185.html#L101309'>pBt</a>              101309 libdb/sqlite3.c   if( db-&gt;aDb[1].pBt!=0 ){</span>
<span class='curline'><a href='../S/185.html#L101310'>pBt</a>              101310 libdb/sqlite3.c     if( !db-&gt;autoCommit || sqlite3BtreeIsInReadTrans(db-&gt;aDb[1].pBt) ){</span>
<span class='curline'><a href='../S/185.html#L101315'>pBt</a>              101315 libdb/sqlite3.c     sqlite3BtreeClose(db-&gt;aDb[1].pBt);</span>
<span class='curline'><a href='../S/185.html#L101316'>pBt</a>              101316 libdb/sqlite3.c     db-&gt;aDb[1].pBt = 0;</span>
<span class='curline'><a href='../S/185.html#L101374'>pBt</a>              101374 libdb/sqlite3.c       if( pDb-&gt;pBt ){</span>
<span class='curline'><a href='../S/185.html#L101375'>pBt</a>              101375 libdb/sqlite3.c         sqlite3BtreeSetPagerFlags(pDb-&gt;pBt,</span>
<span class='curline'><a href='../S/185.html#L101596'>pBt</a>              101596 libdb/sqlite3.c       sqlite3BtreeSetCacheSize(pDb-&gt;pBt, pDb-&gt;pSchema-&gt;cache_size);</span>
<span class='curline'><a href='../S/185.html#L101613'>pBt</a>              101613 libdb/sqlite3.c     Btree *pBt = pDb-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L101614'>pBt</a>              101614 libdb/sqlite3.c     assert( pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L101616'>pBt</a>              101616 libdb/sqlite3.c       int size = ALWAYS(pBt) ? sqlite3BtreeGetPageSize(pBt) : 0;</span>
<span class='curline'><a href='../S/185.html#L101623'>pBt</a>              101623 libdb/sqlite3.c       if( SQLITE_NOMEM==sqlite3BtreeSetPageSize(pBt, db-&gt;nextPagesize,-1,0) ){</span>
<span class='curline'><a href='../S/185.html#L101639'>pBt</a>              101639 libdb/sqlite3.c     Btree *pBt = pDb-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L101641'>pBt</a>              101641 libdb/sqlite3.c     assert( pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L101648'>pBt</a>              101648 libdb/sqlite3.c         sqlite3BtreeSecureDelete(db-&gt;aDb[ii].pBt, b);</span>
<span class='curline'><a href='../S/185.html#L101651'>pBt</a>              101651 libdb/sqlite3.c     b = sqlite3BtreeSecureDelete(pBt, b);</span>
<span class='curline'><a href='../S/185.html#L101717'>pBt</a>              101717 libdb/sqlite3.c           pPager = sqlite3BtreePager(db-&gt;aDb[ii].pBt);</span>
<span class='curline'><a href='../S/185.html#L101722'>pBt</a>              101722 libdb/sqlite3.c       pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L101772'>pBt</a>              101772 libdb/sqlite3.c       if( db-&gt;aDb[ii].pBt &amp;&amp; (ii==iDb || pId2-&gt;n==0) ){</span>
<span class='curline'><a href='../S/185.html#L101788'>pBt</a>              101788 libdb/sqlite3.c     Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L101810'>pBt</a>              101810 libdb/sqlite3.c     Btree *pBt = pDb-&gt;pBt;</span>
<span class='curline'><a href='../S/185.html#L101811'>pBt</a>              101811 libdb/sqlite3.c     assert( pBt!=0 );</span>
<span class='curline'><a href='../S/185.html#L101813'>pBt</a>              101813 libdb/sqlite3.c       returnSingleInt(pParse, "auto_vacuum", sqlite3BtreeGetAutoVacuum(pBt));</span>
<span class='curline'><a href='../S/185.html#L101823'>pBt</a>              101823 libdb/sqlite3.c       rc = sqlite3BtreeSetAutoVacuum(pBt, eAuto);</span>
<span class='curline'><a href='../S/185.html#L101894'>pBt</a>              101894 libdb/sqlite3.c       sqlite3BtreeSetCacheSize(pDb-&gt;pBt, pDb-&gt;pSchema-&gt;cache_size);</span>
<span class='curline'><a href='../S/185.html#L101923'>pBt</a>              101923 libdb/sqlite3.c         if( db-&gt;aDb[ii].pBt &amp;&amp; (ii==iDb || pId2-&gt;n==0) ){</span>
<span class='curline'><a href='../S/185.html#L101924'>pBt</a>              101924 libdb/sqlite3.c           sqlite3BtreeSetMmapLimit(db-&gt;aDb[ii].pBt, sz);</span>
<span class='curline'><a href='../S/185.html#L102065'>pBt</a>              102065 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L102079'>pBt</a>              102079 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L102308'>pBt</a>              102308 libdb/sqlite3.c       if( db-&gt;aDb[i].pBt==0 ) continue;</span>
<span class='curline'><a href='../S/185.html#L102313'>pBt</a>              102313 libdb/sqlite3.c            sqlite3BtreeGetFilename(db-&gt;aDb[i].pBt), 0);</span>
<span class='curline'><a href='../S/185.html#L103056'>pBt</a>              103056 libdb/sqlite3.c       Btree *pBt;</span>
<span class='curline'><a href='../S/185.html#L103061'>pBt</a>              103061 libdb/sqlite3.c       pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L103062'>pBt</a>              103062 libdb/sqlite3.c       if( pBt==0 || sqlite3BtreePager(pBt)==0 ){</span>
<span class='curline'><a href='../S/185.html#L103305'>pBt</a>              103305 libdb/sqlite3.c   assert( iDb==1 || sqlite3BtreeHoldsMutex(db-&gt;aDb[iDb].pBt) );</span>
<span class='curline'><a href='../S/185.html#L103340'>pBt</a>              103340 libdb/sqlite3.c   if( pDb-&gt;pBt==0 ){</span>
<span class='curline'><a href='../S/185.html#L103350'>pBt</a>              103350 libdb/sqlite3.c   sqlite3BtreeEnter(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L103351'>pBt</a>              103351 libdb/sqlite3.c   if( !sqlite3BtreeIsInReadTrans(pDb-&gt;pBt) ){</span>
<span class='curline'><a href='../S/185.html#L103352'>pBt</a>              103352 libdb/sqlite3.c     rc = sqlite3BtreeBeginTrans(pDb-&gt;pBt, 0);</span>
<span class='curline'><a href='../S/185.html#L103378'>pBt</a>              103378 libdb/sqlite3.c     sqlite3BtreeGetMeta(pDb-&gt;pBt, i+1, (u32 *)&amp;meta[i]);</span>
<span class='curline'><a href='../S/185.html#L103420'>pBt</a>              103420 libdb/sqlite3.c     sqlite3BtreeSetCacheSize(pDb-&gt;pBt, pDb-&gt;pSchema-&gt;cache_size);</span>
<span class='curline'><a href='../S/185.html#L103498'>pBt</a>              103498 libdb/sqlite3.c     sqlite3BtreeCommit(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L103500'>pBt</a>              103500 libdb/sqlite3.c   sqlite3BtreeLeave(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L103591'>pBt</a>              103591 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[iDb].pBt;     /* Btree database to read cookie from */</span>
<span class='curline'><a href='../S/185.html#L103592'>pBt</a>              103592 libdb/sqlite3.c     if( pBt==0 ) continue;</span>
<span class='curline'><a href='../S/185.html#L103597'>pBt</a>              103597 libdb/sqlite3.c     if( !sqlite3BtreeIsInReadTrans(pBt) ){</span>
<span class='curline'><a href='../S/185.html#L103598'>pBt</a>              103598 libdb/sqlite3.c       rc = sqlite3BtreeBeginTrans(pBt, 0);</span>
<span class='curline'><a href='../S/185.html#L103609'>pBt</a>              103609 libdb/sqlite3.c     sqlite3BtreeGetMeta(pBt, BTREE_SCHEMA_VERSION, (u32 *)&amp;cookie);</span>
<span class='curline'><a href='../S/185.html#L103618'>pBt</a>              103618 libdb/sqlite3.c       sqlite3BtreeCommit(pBt);</span>
<span class='curline'><a href='../S/185.html#L103718'>pBt</a>              103718 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L103719'>pBt</a>              103719 libdb/sqlite3.c     if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L103720'>pBt</a>              103720 libdb/sqlite3.c       assert( sqlite3BtreeHoldsMutex(pBt) );</span>
<span class='curline'><a href='../S/185.html#L103721'>pBt</a>              103721 libdb/sqlite3.c       rc = sqlite3BtreeSchemaLocked(pBt);</span>
<span class='curline'><a href='../S/185.html#L111779'>pBt</a>              111779 libdb/sqlite3.c   pMain = db-&gt;aDb[0].pBt;</span>
<span class='curline'><a href='../S/185.html#L111808'>pBt</a>              111808 libdb/sqlite3.c   pTemp = db-&gt;aDb[db-&gt;nDb-1].pBt;</span>
<span class='curline'><a href='../S/185.html#L111986'>pBt</a>              111986 libdb/sqlite3.c     sqlite3BtreeClose(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L111987'>pBt</a>              111987 libdb/sqlite3.c     pDb-&gt;pBt = 0;</span>
<span class='curline'><a href='../S/185.html#L125524'>pBt</a>              125524 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L125525'>pBt</a>              125525 libdb/sqlite3.c     if( pBt ){</span>
<span class='curline'><a href='../S/185.html#L125526'>pBt</a>              125526 libdb/sqlite3.c       Pager *pPager = sqlite3BtreePager(pBt);</span>
<span class='curline'><a href='../S/185.html#L125735'>pBt</a>              125735 libdb/sqlite3.c     Btree *pBt = db-&gt;aDb[j].pBt;</span>
<span class='curline'><a href='../S/185.html#L125736'>pBt</a>              125736 libdb/sqlite3.c     if( pBt &amp;&amp; sqlite3BtreeIsInBackup(pBt) ) return 1;</span>
<span class='curline'><a href='../S/185.html#L125843'>pBt</a>              125843 libdb/sqlite3.c     if( pDb-&gt;pBt ){</span>
<span class='curline'><a href='../S/185.html#L125844'>pBt</a>              125844 libdb/sqlite3.c       sqlite3BtreeClose(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L125845'>pBt</a>              125845 libdb/sqlite3.c       pDb-&gt;pBt = 0;</span>
<span class='curline'><a href='../S/185.html#L125949'>pBt</a>              125949 libdb/sqlite3.c     Btree *p = db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L126728'>pBt</a>              126728 libdb/sqlite3.c       rc = sqlite3BtreeCheckpoint(db-&gt;aDb[i].pBt, eMode, pnLog, pnCkpt);</span>
<span class='curline'><a href='../S/185.html#L126892'>pBt</a>              126892 libdb/sqlite3.c     if( pDb-&gt;pBt==0 ) continue;</span>
<span class='curline'><a href='../S/185.html#L126893'>pBt</a>              126893 libdb/sqlite3.c     sqlite3BtreeEnter(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L126903'>pBt</a>              126903 libdb/sqlite3.c     sqlite3BtreeLeave(pDb-&gt;pBt);</span>
<span class='curline'><a href='../S/185.html#L127479'>pBt</a>              127479 libdb/sqlite3.c   rc = sqlite3BtreeOpen(db-&gt;pVfs, zOpen, db, &amp;db-&gt;aDb[0].pBt, 0,</span>
<span class='curline'><a href='../S/185.html#L127488'>pBt</a>              127488 libdb/sqlite3.c   db-&gt;aDb[0].pSchema = sqlite3SchemaGet(db, db-&gt;aDb[0].pBt);</span>
<span class='curline'><a href='../S/185.html#L127561'>pBt</a>              127561 libdb/sqlite3.c   sqlite3PagerLockingMode(sqlite3BtreePager(db-&gt;aDb[0].pBt),</span>
<span class='curline'><a href='../S/185.html#L128183'>pBt</a>              128183 libdb/sqlite3.c       sqlite3BtreeSetPageSize(db-&gt;aDb[0].pBt, 0, x, 0);</span>
<span class='curline'><a href='../S/185.html#L128352'>pBt</a>              128352 libdb/sqlite3.c     if( db-&gt;aDb[i].pBt</span>
<span class='curline'><a href='../S/185.html#L128355'>pBt</a>              128355 libdb/sqlite3.c       return db-&gt;aDb[i].pBt;</span>
<span class='curline'><a href='../S/185.html#L128366'>pBt</a>              128366 libdb/sqlite3.c   Btree *pBt = sqlite3DbNameToBtree(db, zDbName);</span>
<span class='curline'><a href='../S/185.html#L128367'>pBt</a>              128367 libdb/sqlite3.c   return pBt ? sqlite3BtreeGetFilename(pBt) : 0;</span>
<span class='curline'><a href='../S/185.html#L128375'>pBt</a>              128375 libdb/sqlite3.c   Btree *pBt = sqlite3DbNameToBtree(db, zDbName);</span>
<span class='curline'><a href='../S/185.html#L128376'>pBt</a>              128376 libdb/sqlite3.c   return pBt ? sqlite3BtreeIsReadonly(pBt) : -1;</span>
</pre>
</body>
</html>
